import{j as e,a as Re}from"./query-CQB1N7mz.js";import{r as l}from"./vendor-D5cPNHfC.js";import{aa as re,m as $e,o as Fe,ab as P,ac as Ue,q as Pe,g as Oe,ad as I,c as fe,b as Be,e as He,ae as We,af as ze,Z as se,ag as Ge,ah as De,ai as Te}from"./index-P8Mr3XGt.js";import"./supabase-Br6iVc9W.js";const je="notification_prefs",ke={os_assigned:{inApp:!0,email:!1,whatsapp:!1},os_completed:{inApp:!0,email:!1,whatsapp:!1},os_overdue:{inApp:!0,email:!0,whatsapp:!1},deadline_warning:{inApp:!0,email:!1,whatsapp:!1},comment_added:{inApp:!0,email:!1,whatsapp:!1},event_reminder:{inApp:!0,email:!0,whatsapp:!1}};function qe(){try{const n=JSON.parse(localStorage.getItem(je)||"{}");return{...ke,...n}}catch{return ke}}function Ve(n){localStorage.setItem(je,JSON.stringify(n));const a=JSON.parse(localStorage.getItem("settings_profile")||"{}");a.id&&re.from("user_profiles").update({notification_prefs:n}).eq("id",a.id).then(()=>{})}const Ke={os_assigned:"O.S. atribuida a mim",os_completed:"O.S. concluida",os_overdue:"O.S. atrasada",deadline_warning:"Alerta de prazo",comment_added:"Novo comentario",event_reminder:"Lembrete de evento"};function Qe(){const[n,a]=l.useState({}),[b,h]=l.useState(!1);l.useEffect(()=>{a(qe())},[]);const v=(m,w)=>{var f;const x={...n,[m]:{...n[m],[w]:!((f=n[m])!=null&&f[w])}};a(x),Ve(x),h(!0),setTimeout(()=>h(!1),1500)},j=[{key:"inApp",label:"No app",icon:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"},{key:"email",label:"Email",icon:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},{key:"whatsapp",label:"WhatsApp",icon:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100",children:"Preferencias de Notificacao"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:"Escolha como receber cada tipo de alerta"})]}),b&&e.jsxs("span",{className:"text-xs text-emerald-600 dark:text-emerald-400 font-medium flex items-center gap-1",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Salvo"]})]}),e.jsxs("div",{className:"grid grid-cols-[1fr_repeat(3,64px)] gap-2 items-center px-3",children:[e.jsx("span",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase",children:"Tipo"}),j.map(m=>e.jsx("span",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase text-center",children:m.label},m.key))]}),e.jsx("div",{className:"space-y-1",children:Object.entries(Ke).map(([m,w])=>e.jsxs("div",{className:"grid grid-cols-[1fr_repeat(3,64px)] gap-2 items-center px-3 py-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-200",children:w}),j.map(x=>{var B;const f=((B=n[m])==null?void 0:B[x.key])??!1;return e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:()=>v(m,x.key),className:`w-8 h-8 rounded-lg flex items-center justify-center transition-colors ${f?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"bg-slate-100 dark:bg-slate-700 text-slate-300 dark:text-slate-500"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:x.icon})})})},x.key)})]},m))}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/10 border border-blue-100 dark:border-blue-800 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-300 flex items-start gap-2",children:[e.jsx("svg",{className:"w-4 h-4 shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("span",{children:[e.jsx("strong",{children:"WhatsApp:"})," Abre o wa.me com a mensagem pre-formatada.",e.jsx("br",{}),e.jsx("strong",{children:"Email:"})," Usa o servico de email configurado no Supabase. Se nao configurado, abre o cliente de email padrao."]})]})})]})}function Je(n){const a=(n||"").replace(/\D/g,"").slice(0,11);return a.length<=3?a:a.length<=6?`${a.slice(0,3)}.${a.slice(3)}`:a.length<=9?`${a.slice(0,3)}.${a.slice(3,6)}.${a.slice(6)}`:`${a.slice(0,3)}.${a.slice(3,6)}.${a.slice(6,9)}-${a.slice(9)}`}function ve(n){const a=parseFloat(n);return isNaN(a)?"R$ 0,00":a.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}function Xe(n,a){const b=parseFloat(n),h=parseFloat(a);return isNaN(b)||isNaN(h)||h===0?0:b/h}const O=[{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-300",border:"border-blue-200 dark:border-blue-800",dot:"bg-blue-500"},{bg:"bg-emerald-100 dark:bg-emerald-900/30",text:"text-emerald-700 dark:text-emerald-300",border:"border-emerald-200 dark:border-emerald-800",dot:"bg-emerald-500"},{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-700 dark:text-amber-300",border:"border-amber-200 dark:border-amber-800",dot:"bg-amber-500"},{bg:"bg-rose-100 dark:bg-rose-900/30",text:"text-rose-700 dark:text-rose-300",border:"border-rose-200 dark:border-rose-800",dot:"bg-rose-500"},{bg:"bg-cyan-100 dark:bg-cyan-900/30",text:"text-cyan-700 dark:text-cyan-300",border:"border-cyan-200 dark:border-cyan-800",dot:"bg-cyan-500"},{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-700 dark:text-purple-300",border:"border-purple-200 dark:border-purple-800",dot:"bg-purple-500"}],q=["Gestor","Diretor","Coordenador","Supervisor","Operador","Auxiliar","Analista","Estagiario"];function st(){const n=Re(),[a,b]=l.useState({}),[h,v]=l.useState([]),[j,m]=l.useState("profile"),[w,x]=l.useState(!1),[f,B]=l.useState(!0),le=l.useRef(null),{data:Ye=[],isLoading:Ne}=$e(),{data:g=[],isLoading:_}=Fe(),ye=f||Ne||_,[H,V]=l.useState(""),[K,C]=l.useState(""),[oe,ne]=l.useState(P[0]),[de,Q]=l.useState("08:00"),[ie,J]=l.useState("18:00"),[ce,X]=l.useState(""),[xe,Y]=l.useState("176"),[W,Z]=l.useState(""),[z,ee]=l.useState(""),[M,te]=l.useState(!1),[A,ae]=l.useState(!1),[we,R]=l.useState(!1),[o,c]=l.useState(null),[Ce,G]=l.useState(!1),[N,S]=l.useState(""),[D,L]=l.useState(0),[$,y]=l.useState(null),[F,T]=l.useState(null),[ue,U]=l.useState(!1),me=l.useRef(null),E=Ue(a),[be,Me]=l.useState({});l.useEffect(()=>{(async()=>{const[t,s]=await Promise.all([Pe(),Oe()]);b(t),v(s),B(!1)})()},[]),l.useEffect(()=>{if(_||g.length===0)return;const t=g.filter(s=>s.authUserId).map(s=>s.authUserId);t.length!==0&&(async()=>{const{data:s}=await re.from("user_profiles").select("id, avatar").in("id",t);if(s){const r={};s.forEach(i=>{i.avatar&&(r[i.id]=i.avatar)}),Me(r)}})()},[_,g]),l.useEffect(()=>{if(_||f||!a.id&&!a.email)return;const t=g.find(r=>r.authUserId&&a.id&&r.authUserId===a.id||r.email&&a.email&&r.email.toLowerCase().trim()===a.email.toLowerCase().trim());if(!t)return;const s={};if(!a.name&&t.name&&(s.name=t.name),!a.role&&t.role&&(s.role=t.role),!a.salaryMonth&&t.salaryMonth&&(s.salaryMonth=t.salaryMonth),!a.hoursMonth&&t.hoursMonth&&(s.hoursMonth=t.hoursMonth),Object.keys(s).length>0){const r={...a,...s};b(r),I(r)}},[_,f,a.id,a.email]);const he=async()=>{await I(a),x(!0),setTimeout(()=>x(!1),2e3)},k=(t,s)=>{b(r=>({...r,[t]:s}))},Se=t=>{var i;const s=(i=t.target.files)==null?void 0:i[0];if(!s)return;if(s.size>1*1024*1024){alert("Imagem muito grande! Maximo: 1MB.");return}const r=new FileReader;r.onload=async u=>{const p={...a,avatar:u.target.result};b(p),await I(p),x(!0),setTimeout(()=>x(!1),2e3)},r.readAsDataURL(s)},Le=async()=>{const t={...a,avatar:null};b(t),await I(t),x(!0),setTimeout(()=>x(!1),2e3)},d=g.find(t=>t.authUserId&&a.id&&t.authUserId===a.id||t.email&&a.email&&t.email.toLowerCase().trim()===a.email.toLowerCase().trim()),pe=a.salaryMonth||(d==null?void 0:d.salaryMonth)||0,Ee=a.hoursMonth||(d==null?void 0:d.hoursMonth)||176,Ie=Xe(pe,Ee),ge=h.find(t=>t.id===a.companyId);ge&&O[(ge.colorIndex||0)%O.length];const _e=[{id:"profile",label:"Meu Perfil",icon:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},{id:"team",label:"Equipe",icon:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"},{id:"notifications",label:"Notificacoes",icon:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"}];return ye?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:"Configuracoes"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"Gerencie seu perfil e preferencias"})]}),e.jsx("div",{className:"flex gap-1 mb-6 bg-slate-100 dark:bg-slate-800/50 p-1 rounded-xl",children:_e.map(t=>e.jsxs("button",{onClick:()=>m(t.id),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-lg text-sm font-medium transition-all ${j===t.id?"bg-white dark:bg-slate-800 text-slate-800 dark:text-slate-100 shadow-sm":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200"}`,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:t.icon})}),e.jsx("span",{className:"hidden sm:inline",children:t.label})]},t.id))}),j==="profile"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 p-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100 mb-4",children:"Foto"}),e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{onClick:()=>{var t;return(t=le.current)==null?void 0:t.click()},className:"w-20 h-20 rounded-xl bg-slate-100 dark:bg-slate-700 border-2 border-dashed border-slate-300 dark:border-slate-600 flex items-center justify-center cursor-pointer hover:border-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all overflow-hidden",children:a.avatar?e.jsx("img",{src:a.avatar,alt:"Avatar",className:"w-full h-full object-cover"}):e.jsx("svg",{className:"w-8 h-8 text-slate-400 dark:text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),a.avatar&&e.jsx("button",{onClick:Le,className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600 opacity-0 group-hover:opacity-100 transition-opacity",children:"X"}),e.jsx("input",{ref:le,type:"file",accept:"image/*",onChange:Se,className:"hidden"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-200 font-medium",children:a.name||(d==null?void 0:d.name)||"Sem nome"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:a.role||(d==null?void 0:d.role)||"Sem cargo"}),e.jsx("p",{className:"text-[11px] text-slate-400 dark:text-slate-500 mt-1",children:"Clique na foto para alterar"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 p-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100 mb-4",children:"Dados Pessoais"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 dark:text-slate-400 mb-1",children:"Nome completo"}),e.jsx("input",{type:"text",value:a.name||(d==null?void 0:d.name)||"",onChange:t=>k("name",t.target.value),className:"w-full px-3 py-2 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Seu nome completo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 dark:text-slate-400 mb-1",children:"Cargo"}),e.jsx("input",{type:"text",value:a.role||(d==null?void 0:d.role)||"",onChange:t=>k("role",t.target.value),className:"w-full px-3 py-2 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ex: Gestor, Operador"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 dark:text-slate-400 mb-1",children:"CPF"}),e.jsx("input",{type:"text",value:Je(a.cpf),onChange:t=>k("cpf",t.target.value.replace(/\D/g,"").slice(0,11)),className:"w-full px-3 py-2 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"000.000.000-00",maxLength:14})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 dark:text-slate-400 mb-1",children:"E-mail"}),e.jsx("input",{type:"email",value:a.email||"",onChange:t=>k("email",t.target.value),className:"w-full px-3 py-2 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"email@exemplo.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 dark:text-slate-400 mb-1",children:"Telefone"}),e.jsx("input",{type:"text",value:a.phone||"",onChange:t=>k("phone",t.target.value),className:"w-full px-3 py-2 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"(00) 00000-0000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 dark:text-slate-400 mb-1",children:"Data de inicio"}),e.jsx("input",{type:"date",value:a.startDate||"",onChange:t=>k("startDate",t.target.value),className:"w-full px-3 py-2 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{onClick:he,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:"Salvar Dados"})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 p-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100 mb-4",children:"Financeiro"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-emerald-50 dark:bg-emerald-900/20 rounded-xl",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-100 dark:bg-emerald-900/40 rounded-lg flex items-center justify-center shrink-0",children:e.jsx("svg",{className:"w-5 h-5 text-emerald-600 dark:text-emerald-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] text-emerald-600 dark:text-emerald-400 font-medium",children:"Salario Mensal"}),e.jsx("p",{className:"text-lg font-bold text-slate-800 dark:text-slate-100",children:ve(pe)})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/40 rounded-lg flex items-center justify-center shrink-0",children:e.jsx("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] text-blue-600 dark:text-blue-400 font-medium",children:"Valor / Hora"}),e.jsx("p",{className:"text-lg font-bold text-slate-800 dark:text-slate-100",children:ve(Ie)})]})]})]}),E&&e.jsxs("div",{className:"pt-4 border-t border-slate-100 dark:border-slate-700",children:[e.jsx("p",{className:"text-[11px] text-slate-400 dark:text-slate-500 mb-3",children:"Editar valores (apenas gestores)"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 dark:text-slate-400 mb-1",children:"Salario Mensal"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-xs text-slate-400 dark:text-slate-500",children:"R$"}),e.jsx("input",{type:"number",value:a.salaryMonth||"",onChange:t=>k("salaryMonth",t.target.value),className:"w-full pl-8 pr-3 py-2 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"3000",min:"0",step:"100"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 dark:text-slate-400 mb-1",children:"Horas/Mes"}),e.jsx("input",{type:"number",value:a.hoursMonth||"",onChange:t=>k("hoursMonth",t.target.value),className:"w-full px-3 py-2 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"176",min:"1"})]})]}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx("button",{onClick:he,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:"Salvar"})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100",children:"Empresas"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-xs text-slate-400 dark:text-slate-500",children:[h.length," empresa",h.length!==1?"s":""]}),e.jsxs("button",{onClick:()=>{U(!ue),T(null),S(""),L(0),y(null)},className:"flex items-center gap-1.5 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-xs font-medium",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Nova Empresa"]})]})]}),(ue||F)&&e.jsxs("div",{className:"flex flex-wrap items-end gap-3 mb-4 pb-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex-1 min-w-[180px]",children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 dark:text-slate-400 mb-1",children:"Nome"}),e.jsx("input",{type:"text",value:N,onChange:t=>S(t.target.value),className:"w-full px-3 py-2 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nome da empresa",onKeyDown:t=>{t.key==="Enter"&&N.trim()&&(async()=>{const s=await fe({name:N.trim(),colorIndex:D,image:$});s&&(v(r=>[...r,s]),S(""),L(0),y(null),U(!1))})()}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 dark:text-slate-400 mb-1",children:"Cor"}),e.jsx("div",{className:"flex gap-1.5",children:O.map((t,s)=>e.jsx("button",{onClick:()=>L(s),className:`w-7 h-7 rounded-full ${t.dot} transition-all ${D===s?"ring-2 ring-offset-1 ring-slate-400 dark:ring-offset-slate-800 scale-110":"opacity-60 hover:opacity-100"}`},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-500 dark:text-slate-400 mb-1",children:"Logo"}),e.jsxs("div",{className:"flex items-center gap-2",children:[$?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:$,alt:"",className:"w-10 h-10 rounded-lg object-contain bg-white dark:bg-slate-700 p-1 border border-slate-200 dark:border-slate-600"}),e.jsx("button",{onClick:()=>y(null),className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white rounded-full flex items-center justify-center text-[8px]",children:"x"})]}):e.jsx("button",{onClick:()=>{var t;return(t=me.current)==null?void 0:t.click()},className:"w-9 h-9 rounded-lg border-2 border-dashed border-slate-300 dark:border-slate-600 flex items-center justify-center text-slate-400 hover:border-blue-400 hover:text-blue-400 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("input",{ref:me,type:"file",accept:"image/*",className:"hidden",onChange:t=>{var i;const s=(i=t.target.files)==null?void 0:i[0];if(!s)return;if(s.size>500*1024){alert("Imagem muito grande! Max 500KB.");return}const r=new FileReader;r.onload=u=>y(u.target.result),r.readAsDataURL(s)}})]})]}),e.jsx("button",{onClick:async()=>{if(N.trim()){if(F){const t=await Be(F.id,{name:N.trim(),colorIndex:D,image:$});t&&v(s=>s.map(r=>r.id===t.id?t:r)),T(null)}else{const t=await fe({name:N.trim(),colorIndex:D,image:$});t&&v(s=>[...s,t])}S(""),L(0),y(null),U(!1)}},disabled:!N.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium whitespace-nowrap disabled:opacity-50",children:F?"Salvar":"Criar"}),F&&e.jsx("button",{onClick:()=>{T(null),S(""),L(0),y(null),U(!1)},className:"px-3 py-2 text-xs text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:"Cancelar"})]}),h.length===0?e.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500 text-center py-6",children:"Nenhuma empresa cadastrada"}):e.jsx("div",{className:"space-y-2",children:h.map(t=>{var i,u;const s=O[(t.colorIndex||0)%O.length],r=a.companyId===t.id;return e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border transition-colors group ${r?`${s.border} ${s.bg}`:"border-slate-100 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t.image?e.jsx("img",{src:t.image,alt:"",className:"w-10 h-10 rounded-lg object-contain bg-white dark:bg-slate-700 p-1"}):e.jsx("div",{className:`w-10 h-10 rounded-lg ${s.bg} ${s.text} flex items-center justify-center text-sm font-bold`,children:(u=(i=t.name)==null?void 0:i.charAt(0))==null?void 0:u.toUpperCase()}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:t.name}),r&&e.jsx("span",{className:"ml-2 text-[10px] font-semibold text-blue-600 dark:text-blue-400 bg-blue-100 dark:bg-blue-900/30 px-1.5 py-0.5 rounded-full",children:"Sua empresa"})]})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[!r&&e.jsx("button",{onClick:async()=>{const p={...a,companyId:t.id};b(p),await I(p)},className:"px-2 py-1 text-[10px] font-medium text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",children:"Selecionar"}),e.jsx("button",{onClick:()=>{T(t),S(t.name),L(t.colorIndex||0),y(t.image||null),U(!1)},className:"p-1.5 text-slate-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:"Editar",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:async()=>{if(confirm(`Remover "${t.name}"?`)&&(await He(t.id),v(p=>p.filter(Ae=>Ae.id!==t.id)),a.companyId===t.id)){const p={...a,companyId:""};b(p),await I(p)}},className:"p-1.5 text-slate-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Remover",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},t.id)})})]})]}),j==="team"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 dark:border-slate-700 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100",children:"Funcionarios Cadastrados"}),e.jsxs("span",{className:"text-xs text-slate-400 dark:text-slate-500",children:[g.filter(t=>!(t.authUserId&&a.id&&t.authUserId===a.id||t.email&&a.email&&t.email.toLowerCase().trim()===a.email.toLowerCase().trim())).length+1," membros"]})]}),E&&e.jsxs("button",{onClick:()=>R(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Novo Funcionario"]})]}),we&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>!A&&R(!1)}),e.jsxs("div",{className:"relative bg-white dark:bg-slate-800 rounded-2xl shadow-2xl border border-slate-200 dark:border-slate-700 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800 dark:text-slate-100",children:"Novo Funcionario"}),e.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500 mt-0.5",children:"Crie o login e configure o acesso"})]}),e.jsx("button",{onClick:()=>!A&&R(!1),className:"p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"px-6 py-5 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300 mb-1.5",children:"Nome completo"}),e.jsx("input",{type:"text",value:H,onChange:t=>V(t.target.value),className:"w-full px-3 py-2.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ex: Robert Silva"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300 mb-1.5",children:"Email (login)"}),e.jsx("input",{type:"email",value:W,onChange:t=>Z(t.target.value),className:"w-full px-3 py-2.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"email@empresa.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300 mb-1.5",children:"Senha"}),e.jsx("input",{type:"password",value:z,onChange:t=>ee(t.target.value),className:"w-full px-3 py-2.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Min. 6 caracteres"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300 mb-1.5",children:"Cargo"}),Ce?e.jsxs("div",{className:"flex gap-1",children:[e.jsx("input",{type:"text",value:K,onChange:t=>C(t.target.value),className:"w-full px-3 py-2.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Digite o cargo",autoFocus:!0}),e.jsx("button",{onClick:()=>{G(!1),C("")},className:"px-2 text-xs text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:"X"})]}):e.jsxs("select",{value:K,onChange:t=>{t.target.value==="_custom"?(G(!0),C("")):C(t.target.value)},className:"w-full px-3 py-2.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-700 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione..."}),q.map(t=>e.jsx("option",{value:t,children:t},t)),e.jsx("option",{value:"_custom",children:"Outro (digitar)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300 mb-1.5",children:"Nivel de Acesso"}),e.jsxs("button",{type:"button",onClick:()=>te(!M),className:`w-full flex items-center justify-center gap-2 px-3 py-2.5 rounded-lg border text-sm font-medium transition-all ${M?"bg-amber-50 dark:bg-amber-900/30 border-amber-300 dark:border-amber-600 text-amber-700 dark:text-amber-300":"bg-white dark:bg-slate-700 border-slate-200 dark:border-slate-600 text-slate-500 dark:text-slate-400"}`,children:[e.jsx("span",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center shrink-0 ${M?"border-amber-500 bg-amber-500":"border-slate-300 dark:border-slate-500"}`,children:M&&e.jsx("span",{className:"text-white text-[10px]",children:"✓"})}),M?"Gestor (acesso completo)":"Colaborador (acesso limitado)"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300 mb-1.5",children:"Horario de Trabalho"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"time",value:de,onChange:t=>Q(t.target.value),className:"flex-1 px-3 py-2.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500",children:"ate"}),e.jsx("input",{type:"time",value:ie,onChange:t=>J(t.target.value),className:"flex-1 px-3 py-2.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),E&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300 mb-1.5",children:"Salario Mensal / Horas"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-xs text-slate-400 dark:text-slate-500",children:"R$"}),e.jsx("input",{type:"number",value:ce,onChange:t=>X(t.target.value),className:"w-full pl-8 pr-3 py-2.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"3000",min:"0",step:"100"})]}),e.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500",children:"/"}),e.jsxs("div",{className:"relative w-24",children:[e.jsx("input",{type:"number",value:xe,onChange:t=>Y(t.target.value),className:"w-full px-3 py-2.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-700 text-center focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"176",min:"1"}),e.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-[10px] text-slate-400 dark:text-slate-500",children:"h/mes"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300 mb-1.5",children:"Cor do perfil"}),e.jsx("div",{className:"flex gap-2",children:P.slice(0,8).map(t=>e.jsx("button",{onClick:()=>ne(t),className:`w-8 h-8 rounded-full border-2 transition-all ${oe===t?"border-slate-800 dark:border-slate-200 scale-110 shadow-md":"border-transparent hover:scale-105"}`,style:{backgroundColor:t}},t))})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 px-6 py-4 border-t border-slate-100 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 rounded-b-2xl",children:[e.jsx("button",{onClick:()=>{R(!1),V(""),C(""),Z(""),ee(""),te(!1),G(!1),Q("08:00"),J("18:00"),X(""),Y("176")},disabled:A,className:"px-4 py-2.5 text-sm font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors disabled:opacity-50",children:"Cancelar"}),e.jsx("button",{disabled:A,onClick:async()=>{if(!H.trim()){alert("Nome e obrigatorio.");return}if(!W.trim()){alert("Email e obrigatorio para criar a conta.");return}if(!z||z.length<6){alert("Senha deve ter no minimo 6 caracteres.");return}ae(!0);try{const t=M?"manager":"collaborator",s=await We(W.trim(),z,H.trim(),t);if(!s.success){alert("Erro ao criar conta: "+s.error),ae(!1);return}await ze({name:H.trim(),role:K.trim(),color:oe,workStart:de,workEnd:ie,salaryMonth:parseFloat(ce)||0,hoursMonth:parseFloat(xe)||176,email:W.trim(),authUserId:s.userId})?(await n.invalidateQueries({queryKey:se.teamMembers}),R(!1),V(""),C(""),Z(""),ee(""),te(!1),G(!1),Q("08:00"),J("18:00"),X(""),Y("176"),ne(P[(g.length+1)%P.length])):alert("Conta criada mas houve erro ao salvar na equipe. Tente novamente.")}catch(t){alert("Erro inesperado: "+t.message)}finally{ae(!1)}},className:"px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:A?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Criando conta..."]}):"Criar Funcionario"})]})]})]}),e.jsxs("div",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:[(()=>{const t=g.find(u=>u.authUserId&&a.id&&u.authUserId===a.id||u.email&&a.email&&u.email.toLowerCase().trim()===a.email.toLowerCase().trim()),s=a.name||(t==null?void 0:t.name)||"Sem nome",r=a.role||(t==null?void 0:t.role)||"",i=(t==null?void 0:t.color)||"#3b82f6";return e.jsxs("div",{className:"px-6 py-3 flex items-center justify-between bg-blue-50/50 dark:bg-blue-900/10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a.avatar?e.jsx("img",{src:a.avatar,alt:"",className:"w-9 h-9 rounded-full object-cover shrink-0"}):e.jsx("div",{className:"w-9 h-9 rounded-full flex items-center justify-center text-white font-medium text-sm shrink-0",style:{background:`linear-gradient(135deg, ${i}, ${i}cc)`},children:s.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[s,e.jsx("span",{className:"text-[10px] font-semibold text-blue-600 dark:text-blue-400 bg-blue-100 dark:bg-blue-900/30 px-1.5 py-0.5 rounded-full",children:"Voce"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r&&e.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500",children:r}),t&&e.jsxs("span",{className:"text-[10px] text-slate-300 dark:text-slate-500 bg-slate-50 dark:bg-slate-700/50 px-1.5 py-0.5 rounded",children:[t.workStart||"08:00"," - ",t.workEnd||"18:00"]}),E&&t&&t.salaryMonth>0&&e.jsxs("span",{className:"text-[10px] text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-900/20 px-1.5 py-0.5 rounded font-medium",children:["R$ ",(parseFloat(t.salaryMonth)/(parseFloat(t.hoursMonth)||176)).toFixed(2),"/h"]})]})]})]}),e.jsx("button",{onClick:()=>m("profile"),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium",children:"Editar Perfil"})]})})(),g.filter(t=>!(t.authUserId&&a.id&&t.authUserId===a.id||t.email&&a.email&&t.email.toLowerCase().trim()===a.email.toLowerCase().trim())).map(t=>e.jsxs("div",{className:"px-6 py-3 flex items-center justify-between hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t.authUserId&&be[t.authUserId]?e.jsx("img",{src:be[t.authUserId],alt:"",className:"w-9 h-9 rounded-full object-cover shrink-0"}):e.jsx("div",{className:"w-9 h-9 rounded-full flex items-center justify-center text-white font-medium text-sm shrink-0",style:{backgroundColor:t.color},children:t.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-slate-800 dark:text-slate-100",children:t.name}),t.email&&e.jsx("div",{className:"text-[11px] text-slate-400 dark:text-slate-500",children:t.email}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.role&&e.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500",children:t.role}),e.jsxs("span",{className:"text-[10px] text-slate-300 dark:text-slate-500 bg-slate-50 dark:bg-slate-700/50 px-1.5 py-0.5 rounded",children:[t.workStart||"08:00"," - ",t.workEnd||"18:00"]}),E&&t.salaryMonth>0&&e.jsxs("span",{className:"text-[10px] text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-900/20 px-1.5 py-0.5 rounded font-medium",children:["R$ ",(parseFloat(t.salaryMonth)/(parseFloat(t.hoursMonth)||176)).toFixed(2),"/h"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:async()=>{let s=!1;if(t.authUserId){const{data:r}=await re.from("profiles").select("role").eq("id",t.authUserId).single();s=(r==null?void 0:r.role)==="manager"||(r==null?void 0:r.role)==="admin"}c({...t,_isGestor:s,_customCargo:t.role&&!q.includes(t.role)})},className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:"Editar",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:async()=>{confirm(`Remover ${t.name} da equipe?`)&&(await Ge(t.id),n.invalidateQueries({queryKey:se.teamMembers}))},className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Remover",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},t.id))]}),o&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>c(null)}),e.jsxs("div",{className:"relative bg-white dark:bg-slate-800 rounded-2xl shadow-2xl border border-slate-200 dark:border-slate-700 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-800 dark:text-slate-100",children:"Editar Funcionario"}),e.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500 mt-0.5",children:o.email||"Sem email"})]}),e.jsx("button",{onClick:()=>c(null),className:"p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"px-6 py-5 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300 mb-1.5",children:"Nome completo"}),e.jsx("input",{type:"text",value:o.name,onChange:t=>c(s=>({...s,name:t.target.value})),className:"w-full px-3 py-2.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300 mb-1.5",children:"Cargo"}),o._customCargo?e.jsxs("div",{className:"flex gap-1",children:[e.jsx("input",{type:"text",value:o.role,onChange:t=>c(s=>({...s,role:t.target.value})),className:"w-full px-3 py-2.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Digite o cargo",autoFocus:!0}),e.jsx("button",{onClick:()=>c(t=>({...t,_customCargo:!1,role:""})),className:"px-2 text-xs text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",children:"X"})]}):e.jsxs("select",{value:q.includes(o.role)?o.role:"",onChange:t=>{t.target.value==="_custom"?c(s=>({...s,_customCargo:!0,role:""})):c(s=>({...s,role:t.target.value}))},className:"w-full px-3 py-2.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-700 bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Selecione..."}),q.map(t=>e.jsx("option",{value:t,children:t},t)),e.jsx("option",{value:"_custom",children:"Outro (digitar)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300 mb-1.5",children:"Nivel de Acesso"}),e.jsxs("button",{type:"button",onClick:()=>c(t=>({...t,_isGestor:!t._isGestor})),className:`w-full flex items-center justify-center gap-2 px-3 py-2.5 rounded-lg border text-sm font-medium transition-all ${o._isGestor?"bg-amber-50 dark:bg-amber-900/30 border-amber-300 dark:border-amber-600 text-amber-700 dark:text-amber-300":"bg-white dark:bg-slate-700 border-slate-200 dark:border-slate-600 text-slate-500 dark:text-slate-400"}`,children:[e.jsx("span",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center shrink-0 ${o._isGestor?"border-amber-500 bg-amber-500":"border-slate-300 dark:border-slate-500"}`,children:o._isGestor&&e.jsx("span",{className:"text-white text-[10px]",children:"✓"})}),o._isGestor?"Gestor (acesso completo)":"Colaborador (acesso limitado)"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300 mb-1.5",children:"Horario de Trabalho"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"time",value:o.workStart||"08:00",onChange:t=>c(s=>({...s,workStart:t.target.value})),className:"flex-1 px-3 py-2.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500",children:"ate"}),e.jsx("input",{type:"time",value:o.workEnd||"18:00",onChange:t=>c(s=>({...s,workEnd:t.target.value})),className:"flex-1 px-3 py-2.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),E&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300 mb-1.5",children:"Salario Mensal / Horas"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-xs text-slate-400 dark:text-slate-500",children:"R$"}),e.jsx("input",{type:"number",value:o.salaryMonth||"",onChange:t=>c(s=>({...s,salaryMonth:t.target.value})),className:"w-full pl-8 pr-3 py-2.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"3000",min:"0",step:"100"})]}),e.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500",children:"/"}),e.jsxs("div",{className:"relative w-24",children:[e.jsx("input",{type:"number",value:o.hoursMonth||"",onChange:t=>c(s=>({...s,hoursMonth:t.target.value})),className:"w-full px-3 py-2.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-700 dark:text-slate-200 dark:bg-slate-700 text-center focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"176",min:"1"}),e.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-[10px] text-slate-400 dark:text-slate-500",children:"h/mes"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300 mb-1.5",children:"Cor do perfil"}),e.jsx("div",{className:"flex gap-2",children:P.slice(0,8).map(t=>e.jsx("button",{onClick:()=>c(s=>({...s,color:t})),className:`w-8 h-8 rounded-full border-2 transition-all ${o.color===t?"border-slate-800 dark:border-slate-200 scale-110 shadow-md":"border-transparent hover:scale-105"}`,style:{backgroundColor:t}},t))})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 px-6 py-4 border-t border-slate-100 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 rounded-b-2xl",children:[e.jsx("button",{onClick:()=>c(null),className:"px-4 py-2.5 text-sm font-medium text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:async()=>{var s,r;if(!((s=o.name)!=null&&s.trim())){alert("Nome e obrigatorio.");return}const t=await De(o.id,{name:o.name.trim(),role:((r=o.role)==null?void 0:r.trim())||"",color:o.color,workStart:o.workStart,workEnd:o.workEnd,salaryMonth:parseFloat(o.salaryMonth)||0,hoursMonth:parseFloat(o.hoursMonth)||176});if(o.authUserId){const i=o._isGestor?"manager":"collaborator",u=await Te(o.authUserId,i);u.success||console.warn("Nao foi possivel atualizar nivel de acesso:",u.error)}t&&n.invalidateQueries({queryKey:se.teamMembers}),c(null)},className:"px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:"Salvar Alteracoes"})]})]})]})]})}),j==="notifications"&&e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 p-6",children:e.jsx(Qe,{})}),w&&e.jsxs("div",{className:"fixed bottom-6 left-1/2 transform -translate-x-1/2 bg-slate-800 dark:bg-slate-700 text-white px-4 py-3 rounded-lg shadow-lg flex items-center gap-2 z-50 animate-fade-in",children:[e.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsx("span",{children:"Salvo com sucesso!"})]})]})}export{st as SettingsPage,st as default};
