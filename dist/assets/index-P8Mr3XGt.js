const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoginPage-C4re7wra.js","assets/query-CQB1N7mz.js","assets/vendor-D5cPNHfC.js","assets/supabase-Br6iVc9W.js","assets/Dashboard-BVB1cphW.js","assets/fynessTemplate-CM7nxNkA.js","assets/Editor-DJCf8Zpw.js","assets/jspdf.es.min-COHhpf8m.js","assets/bpmn-arwAWWbH.js","assets/DashboardPage-e3Pccgkn.js","assets/RoutinePage-0kBPn-MT.js","assets/AgendaPage-BVkwkGnF.js","assets/FinancialPage-x939kl2R.js","assets/SettingsPage-BL0lOf2O.js","assets/ReportPage-Cn02wf3m.js","assets/xlsx-DrgRuPKf.js","assets/EapPage-DbvRqxL-.js"])))=>i.map(i=>d[i]);
var xc=Object.defineProperty;var kc=(e,t,n)=>t in e?xc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Wo=(e,t,n)=>kc(e,typeof t!="symbol"?t+"":t,n);import{j as y,u as qt,a as jt,b as Ht,Q as Sc,c as Ec}from"./query-CQB1N7mz.js";import{a as Tc,r as ee,c as as,g as Oc,u as va,N as xr,O as oi,b as ba,d as Ac,R as jc,e as rt,f as Ic,B as Dc}from"./vendor-D5cPNHfC.js";import{c as ai}from"./supabase-Br6iVc9W.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function n(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(s){if(s.ep)return;s.ep=!0;const c=n(s);fetch(s.href,c)}})();var oa={},ss=Tc;oa.createRoot=ss.createRoot,oa.hydrateRoot=ss.hydrateRoot;const Nc="https://ydiwxlrkrmygpdfacpkt.supabase.co",Pc="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkaXd4bHJrcm15Z3BkZmFjcGt0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAwNzAwMTIsImV4cCI6MjA4NTY0NjAxMn0.uMqOpfKiRSpyaG0Da47KZWI5rOm7_Negsd5VU8J8RiI",he=ai(Nc,Pc),si=ee.createContext(null);let Cc=0;function Mc({children:e}){const[t,n]=ee.useState([]),o=ee.useCallback((c,d="info")=>{const h=++Cc;n(g=>[...g,{id:h,message:c,type:d}]),setTimeout(()=>{n(g=>g.filter(v=>v.id!==h))},4e3)},[]),s=ee.useCallback(c=>{n(d=>d.filter(h=>h.id!==c))},[]);return y.jsxs(si.Provider,{value:{addToast:o},children:[e,t.length>0&&y.jsx("div",{className:"fixed bottom-4 right-4 z-[9999] flex flex-col gap-2 max-w-sm",children:t.map(c=>y.jsx(zc,{toast:c,onClose:()=>s(c.id)},c.id))})]})}const is={success:"bg-emerald-50 dark:bg-emerald-900/30 border-emerald-200 dark:border-emerald-700 text-emerald-800 dark:text-emerald-200",error:"bg-red-50 dark:bg-red-900/30 border-red-200 dark:border-red-700 text-red-800 dark:text-red-200",warning:"bg-amber-50 dark:bg-amber-900/30 border-amber-200 dark:border-amber-700 text-amber-800 dark:text-amber-200",info:"bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-700 text-blue-800 dark:text-blue-200"},cs={success:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",error:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z",warning:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z",info:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"};function zc({toast:e,onClose:t}){return y.jsxs("div",{className:`flex items-start gap-3 px-4 py-3 rounded-lg border shadow-lg animate-slide-in ${is[e.type]||is.info}`,children:[y.jsx("svg",{className:"w-5 h-5 shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:cs[e.type]||cs.info})}),y.jsx("p",{className:"text-sm flex-1",children:e.message}),y.jsx("button",{onClick:t,className:"shrink-0 opacity-60 hover:opacity-100 transition-opacity",children:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}function Rc(){const e=ee.useContext(si);return e||{addToast:()=>{}}}let aa=null;function us(e){aa=e}function Gn(e,t="info"){aa&&aa(e,t)}function z(e,t,n){function o(h,g){if(h._zod||Object.defineProperty(h,"_zod",{value:{def:g,constr:d,traits:new Set},enumerable:!1}),h._zod.traits.has(e))return;h._zod.traits.add(e),t(h,g);const v=d.prototype,I=Object.keys(v);for(let P=0;P<I.length;P++){const $=I[P];$ in h||(h[$]=v[$].bind(h))}}const s=(n==null?void 0:n.Parent)??Object;class c extends s{}Object.defineProperty(c,"name",{value:e});function d(h){var g;const v=n!=null&&n.Parent?new c:this;o(v,h),(g=v._zod).deferred??(g.deferred=[]);for(const I of v._zod.deferred)I();return v}return Object.defineProperty(d,"init",{value:o}),Object.defineProperty(d,Symbol.hasInstance,{value:h=>{var g,v;return n!=null&&n.Parent&&h instanceof n.Parent?!0:(v=(g=h==null?void 0:h._zod)==null?void 0:g.traits)==null?void 0:v.has(e)}}),Object.defineProperty(d,"name",{value:e}),d}class er extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class ii extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const ci={};function Mn(e){return ci}function ui(e){const t=Object.values(e).filter(o=>typeof o=="number");return Object.entries(e).filter(([o,s])=>t.indexOf(+o)===-1).map(([o,s])=>s)}function sa(e,t){return typeof t=="bigint"?t.toString():t}function _a(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function wa(e){return e==null}function xa(e){const t=e.startsWith("^")?1:0,n=e.endsWith("$")?e.length-1:e.length;return e.slice(t,n)}function Lc(e,t){const n=(e.toString().split(".")[1]||"").length,o=t.toString();let s=(o.split(".")[1]||"").length;if(s===0&&/\d?e-\d?/.test(o)){const g=o.match(/\d?e-(\d?)/);g!=null&&g[1]&&(s=Number.parseInt(g[1]))}const c=n>s?n:s,d=Number.parseInt(e.toFixed(c).replace(".","")),h=Number.parseInt(t.toFixed(c).replace(".",""));return d%h/10**c}const ls=Symbol("evaluating");function Se(e,t,n){let o;Object.defineProperty(e,t,{get(){if(o!==ls)return o===void 0&&(o=ls,o=n()),o},set(s){Object.defineProperty(e,t,{value:s})},configurable:!0})}function Ln(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0})}function yn(...e){const t={};for(const n of e){const o=Object.getOwnPropertyDescriptors(n);Object.assign(t,o)}return Object.defineProperties({},t)}function ds(e){return JSON.stringify(e)}function $c(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const li="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function io(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const Fc=_a(()=>{var e;if(typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)!=null&&e.includes("Cloudflare")))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function Or(e){if(io(e)===!1)return!1;const t=e.constructor;if(t===void 0||typeof t!="function")return!0;const n=t.prototype;return!(io(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function di(e){return Or(e)?{...e}:Array.isArray(e)?[...e]:e}const Zc=new Set(["string","number","symbol"]);function tr(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function vn(e,t,n){const o=new e._zod.constr(t??e._zod.def);return(!t||n!=null&&n.parent)&&(o._zod.parent=e),o}function ue(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if((t==null?void 0:t.message)!==void 0){if((t==null?void 0:t.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function Kc(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const Uc={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function Bc(e,t){const n=e._zod.def,o=n.checks;if(o&&o.length>0)throw new Error(".pick() cannot be used on object schemas containing refinements");const c=yn(e._zod.def,{get shape(){const d={};for(const h in t){if(!(h in n.shape))throw new Error(`Unrecognized key: "${h}"`);t[h]&&(d[h]=n.shape[h])}return Ln(this,"shape",d),d},checks:[]});return vn(e,c)}function qc(e,t){const n=e._zod.def,o=n.checks;if(o&&o.length>0)throw new Error(".omit() cannot be used on object schemas containing refinements");const c=yn(e._zod.def,{get shape(){const d={...e._zod.def.shape};for(const h in t){if(!(h in n.shape))throw new Error(`Unrecognized key: "${h}"`);t[h]&&delete d[h]}return Ln(this,"shape",d),d},checks:[]});return vn(e,c)}function Hc(e,t){if(!Or(t))throw new Error("Invalid input to extend: expected a plain object");const n=e._zod.def.checks;if(n&&n.length>0){const c=e._zod.def.shape;for(const d in t)if(Object.getOwnPropertyDescriptor(c,d)!==void 0)throw new Error("Cannot overwrite keys on object schemas containing refinements. Use `.safeExtend()` instead.")}const s=yn(e._zod.def,{get shape(){const c={...e._zod.def.shape,...t};return Ln(this,"shape",c),c}});return vn(e,s)}function Wc(e,t){if(!Or(t))throw new Error("Invalid input to safeExtend: expected a plain object");const n=yn(e._zod.def,{get shape(){const o={...e._zod.def.shape,...t};return Ln(this,"shape",o),o}});return vn(e,n)}function Vc(e,t){const n=yn(e._zod.def,{get shape(){const o={...e._zod.def.shape,...t._zod.def.shape};return Ln(this,"shape",o),o},get catchall(){return t._zod.def.catchall},checks:[]});return vn(e,n)}function Jc(e,t,n){const s=t._zod.def.checks;if(s&&s.length>0)throw new Error(".partial() cannot be used on object schemas containing refinements");const d=yn(t._zod.def,{get shape(){const h=t._zod.def.shape,g={...h};if(n)for(const v in n){if(!(v in h))throw new Error(`Unrecognized key: "${v}"`);n[v]&&(g[v]=e?new e({type:"optional",innerType:h[v]}):h[v])}else for(const v in h)g[v]=e?new e({type:"optional",innerType:h[v]}):h[v];return Ln(this,"shape",g),g},checks:[]});return vn(t,d)}function Gc(e,t,n){const o=yn(t._zod.def,{get shape(){const s=t._zod.def.shape,c={...s};if(n)for(const d in n){if(!(d in c))throw new Error(`Unrecognized key: "${d}"`);n[d]&&(c[d]=new e({type:"nonoptional",innerType:s[d]}))}else for(const d in s)c[d]=new e({type:"nonoptional",innerType:s[d]});return Ln(this,"shape",c),c}});return vn(t,o)}function Xn(e,t=0){var n;if(e.aborted===!0)return!0;for(let o=t;o<e.issues.length;o++)if(((n=e.issues[o])==null?void 0:n.continue)!==!0)return!0;return!1}function fi(e,t){return t.map(n=>{var o;return(o=n).path??(o.path=[]),n.path.unshift(e),n})}function Xr(e){return typeof e=="string"?e:e==null?void 0:e.message}function zn(e,t,n){var s,c,d,h,g,v;const o={...e,path:e.path??[]};if(!e.message){const I=Xr((d=(c=(s=e.inst)==null?void 0:s._zod.def)==null?void 0:c.error)==null?void 0:d.call(c,e))??Xr((h=t==null?void 0:t.error)==null?void 0:h.call(t,e))??Xr((g=n.customError)==null?void 0:g.call(n,e))??Xr((v=n.localeError)==null?void 0:v.call(n,e))??"Invalid input";o.message=I}return delete o.inst,delete o.continue,t!=null&&t.reportInput||delete o.input,o}function ka(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function Ar(...e){const[t,n,o]=e;return typeof t=="string"?{message:t,code:"custom",input:n,inst:o}:{...t}}const pi=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,sa,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},hi=z("$ZodError",pi),mi=z("$ZodError",pi,{Parent:Error});function Yc(e,t=n=>n.message){const n={},o=[];for(const s of e.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(t(s))):o.push(t(s));return{formErrors:o,fieldErrors:n}}function Xc(e,t=n=>n.message){const n={_errors:[]},o=s=>{for(const c of s.issues)if(c.code==="invalid_union"&&c.errors.length)c.errors.map(d=>o({issues:d}));else if(c.code==="invalid_key")o({issues:c.issues});else if(c.code==="invalid_element")o({issues:c.issues});else if(c.path.length===0)n._errors.push(t(c));else{let d=n,h=0;for(;h<c.path.length;){const g=c.path[h];h===c.path.length-1?(d[g]=d[g]||{_errors:[]},d[g]._errors.push(t(c))):d[g]=d[g]||{_errors:[]},d=d[g],h++}}};return o(e),n}const Sa=e=>(t,n,o,s)=>{const c=o?Object.assign(o,{async:!1}):{async:!1},d=t._zod.run({value:n,issues:[]},c);if(d instanceof Promise)throw new er;if(d.issues.length){const h=new((s==null?void 0:s.Err)??e)(d.issues.map(g=>zn(g,c,Mn())));throw li(h,s==null?void 0:s.callee),h}return d.value},Ea=e=>async(t,n,o,s)=>{const c=o?Object.assign(o,{async:!0}):{async:!0};let d=t._zod.run({value:n,issues:[]},c);if(d instanceof Promise&&(d=await d),d.issues.length){const h=new((s==null?void 0:s.Err)??e)(d.issues.map(g=>zn(g,c,Mn())));throw li(h,s==null?void 0:s.callee),h}return d.value},mo=e=>(t,n,o)=>{const s=o?{...o,async:!1}:{async:!1},c=t._zod.run({value:n,issues:[]},s);if(c instanceof Promise)throw new er;return c.issues.length?{success:!1,error:new(e??hi)(c.issues.map(d=>zn(d,s,Mn())))}:{success:!0,data:c.value}},Qc=mo(mi),go=e=>async(t,n,o)=>{const s=o?Object.assign(o,{async:!0}):{async:!0};let c=t._zod.run({value:n,issues:[]},s);return c instanceof Promise&&(c=await c),c.issues.length?{success:!1,error:new e(c.issues.map(d=>zn(d,s,Mn())))}:{success:!0,data:c.value}},eu=go(mi),tu=e=>(t,n,o)=>{const s=o?Object.assign(o,{direction:"backward"}):{direction:"backward"};return Sa(e)(t,n,s)},nu=e=>(t,n,o)=>Sa(e)(t,n,o),ru=e=>async(t,n,o)=>{const s=o?Object.assign(o,{direction:"backward"}):{direction:"backward"};return Ea(e)(t,n,s)},ou=e=>async(t,n,o)=>Ea(e)(t,n,o),au=e=>(t,n,o)=>{const s=o?Object.assign(o,{direction:"backward"}):{direction:"backward"};return mo(e)(t,n,s)},su=e=>(t,n,o)=>mo(e)(t,n,o),iu=e=>async(t,n,o)=>{const s=o?Object.assign(o,{direction:"backward"}):{direction:"backward"};return go(e)(t,n,s)},cu=e=>async(t,n,o)=>go(e)(t,n,o),uu=/^[cC][^\s-]{8,}$/,lu=/^[0-9a-z]+$/,du=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,fu=/^[0-9a-vA-V]{20}$/,pu=/^[A-Za-z0-9]{27}$/,hu=/^[a-zA-Z0-9_-]{21}$/,mu=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,gu=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,fs=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,yu=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,vu="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function bu(){return new RegExp(vu,"u")}const _u=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,wu=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,xu=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,ku=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Su=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,gi=/^[A-Za-z0-9_-]*$/,Eu=/^\+[1-9]\d{6,14}$/,yi="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Tu=new RegExp(`^${yi}$`);function vi(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Ou(e){return new RegExp(`^${vi(e)}$`)}function Au(e){const t=vi({precision:e.precision}),n=["Z"];e.local&&n.push(""),e.offset&&n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const o=`${t}(?:${n.join("|")})`;return new RegExp(`^${yi}T(?:${o})$`)}const ju=e=>{const t=e?`[\\s\\S]{${(e==null?void 0:e.minimum)??0},${(e==null?void 0:e.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},Iu=/^-?\d+$/,Du=/^-?\d+(?:\.\d+)?$/,Nu=/^(?:true|false)$/i,Pu=/^[^A-Z]*$/,Cu=/^[^a-z]*$/,ht=z("$ZodCheck",(e,t)=>{var n;e._zod??(e._zod={}),e._zod.def=t,(n=e._zod).onattach??(n.onattach=[])}),bi={number:"number",bigint:"bigint",object:"date"},_i=z("$ZodCheckLessThan",(e,t)=>{ht.init(e,t);const n=bi[typeof t.value];e._zod.onattach.push(o=>{const s=o._zod.bag,c=(t.inclusive?s.maximum:s.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<c&&(t.inclusive?s.maximum=t.value:s.exclusiveMaximum=t.value)}),e._zod.check=o=>{(t.inclusive?o.value<=t.value:o.value<t.value)||o.issues.push({origin:n,code:"too_big",maximum:typeof t.value=="object"?t.value.getTime():t.value,input:o.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),wi=z("$ZodCheckGreaterThan",(e,t)=>{ht.init(e,t);const n=bi[typeof t.value];e._zod.onattach.push(o=>{const s=o._zod.bag,c=(t.inclusive?s.minimum:s.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>c&&(t.inclusive?s.minimum=t.value:s.exclusiveMinimum=t.value)}),e._zod.check=o=>{(t.inclusive?o.value>=t.value:o.value>t.value)||o.issues.push({origin:n,code:"too_small",minimum:typeof t.value=="object"?t.value.getTime():t.value,input:o.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),Mu=z("$ZodCheckMultipleOf",(e,t)=>{ht.init(e,t),e._zod.onattach.push(n=>{var o;(o=n._zod.bag).multipleOf??(o.multipleOf=t.value)}),e._zod.check=n=>{if(typeof n.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%t.value===BigInt(0):Lc(n.value,t.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:t.value,input:n.value,inst:e,continue:!t.abort})}}),zu=z("$ZodCheckNumberFormat",(e,t)=>{var d;ht.init(e,t),t.format=t.format||"float64";const n=(d=t.format)==null?void 0:d.includes("int"),o=n?"int":"number",[s,c]=Uc[t.format];e._zod.onattach.push(h=>{const g=h._zod.bag;g.format=t.format,g.minimum=s,g.maximum=c,n&&(g.pattern=Iu)}),e._zod.check=h=>{const g=h.value;if(n){if(!Number.isInteger(g)){h.issues.push({expected:o,format:t.format,code:"invalid_type",continue:!1,input:g,inst:e});return}if(!Number.isSafeInteger(g)){g>0?h.issues.push({input:g,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:o,inclusive:!0,continue:!t.abort}):h.issues.push({input:g,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:o,inclusive:!0,continue:!t.abort});return}}g<s&&h.issues.push({origin:"number",input:g,code:"too_small",minimum:s,inclusive:!0,inst:e,continue:!t.abort}),g>c&&h.issues.push({origin:"number",input:g,code:"too_big",maximum:c,inclusive:!0,inst:e,continue:!t.abort})}}),Ru=z("$ZodCheckMaxLength",(e,t)=>{var n;ht.init(e,t),(n=e._zod.def).when??(n.when=o=>{const s=o.value;return!wa(s)&&s.length!==void 0}),e._zod.onattach.push(o=>{const s=o._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<s&&(o._zod.bag.maximum=t.maximum)}),e._zod.check=o=>{const s=o.value;if(s.length<=t.maximum)return;const d=ka(s);o.issues.push({origin:d,code:"too_big",maximum:t.maximum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),Lu=z("$ZodCheckMinLength",(e,t)=>{var n;ht.init(e,t),(n=e._zod.def).when??(n.when=o=>{const s=o.value;return!wa(s)&&s.length!==void 0}),e._zod.onattach.push(o=>{const s=o._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>s&&(o._zod.bag.minimum=t.minimum)}),e._zod.check=o=>{const s=o.value;if(s.length>=t.minimum)return;const d=ka(s);o.issues.push({origin:d,code:"too_small",minimum:t.minimum,inclusive:!0,input:s,inst:e,continue:!t.abort})}}),$u=z("$ZodCheckLengthEquals",(e,t)=>{var n;ht.init(e,t),(n=e._zod.def).when??(n.when=o=>{const s=o.value;return!wa(s)&&s.length!==void 0}),e._zod.onattach.push(o=>{const s=o._zod.bag;s.minimum=t.length,s.maximum=t.length,s.length=t.length}),e._zod.check=o=>{const s=o.value,c=s.length;if(c===t.length)return;const d=ka(s),h=c>t.length;o.issues.push({origin:d,...h?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:o.value,inst:e,continue:!t.abort})}}),yo=z("$ZodCheckStringFormat",(e,t)=>{var n,o;ht.init(e,t),e._zod.onattach.push(s=>{const c=s._zod.bag;c.format=t.format,t.pattern&&(c.patterns??(c.patterns=new Set),c.patterns.add(t.pattern))}),t.pattern?(n=e._zod).check??(n.check=s=>{t.pattern.lastIndex=0,!t.pattern.test(s.value)&&s.issues.push({origin:"string",code:"invalid_format",format:t.format,input:s.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(o=e._zod).check??(o.check=()=>{})}),Fu=z("$ZodCheckRegex",(e,t)=>{yo.init(e,t),e._zod.check=n=>{t.pattern.lastIndex=0,!t.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),Zu=z("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=Pu),yo.init(e,t)}),Ku=z("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=Cu),yo.init(e,t)}),Uu=z("$ZodCheckIncludes",(e,t)=>{ht.init(e,t);const n=tr(t.includes),o=new RegExp(typeof t.position=="number"?`^.{${t.position}}${n}`:n);t.pattern=o,e._zod.onattach.push(s=>{const c=s._zod.bag;c.patterns??(c.patterns=new Set),c.patterns.add(o)}),e._zod.check=s=>{s.value.includes(t.includes,t.position)||s.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:s.value,inst:e,continue:!t.abort})}}),Bu=z("$ZodCheckStartsWith",(e,t)=>{ht.init(e,t);const n=new RegExp(`^${tr(t.prefix)}.*`);t.pattern??(t.pattern=n),e._zod.onattach.push(o=>{const s=o._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),e._zod.check=o=>{o.value.startsWith(t.prefix)||o.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:o.value,inst:e,continue:!t.abort})}}),qu=z("$ZodCheckEndsWith",(e,t)=>{ht.init(e,t);const n=new RegExp(`.*${tr(t.suffix)}$`);t.pattern??(t.pattern=n),e._zod.onattach.push(o=>{const s=o._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),e._zod.check=o=>{o.value.endsWith(t.suffix)||o.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:o.value,inst:e,continue:!t.abort})}}),Hu=z("$ZodCheckOverwrite",(e,t)=>{ht.init(e,t),e._zod.check=n=>{n.value=t.tx(n.value)}});class Wu{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const o=t.split(`
`).filter(d=>d),s=Math.min(...o.map(d=>d.length-d.trimStart().length)),c=o.map(d=>d.slice(s)).map(d=>" ".repeat(this.indent*2)+d);for(const d of c)this.content.push(d)}compile(){const t=Function,n=this==null?void 0:this.args,s=[...((this==null?void 0:this.content)??[""]).map(c=>`  ${c}`)];return new t(...n,s.join(`
`))}}const Vu={major:4,minor:3,patch:6},Re=z("$ZodType",(e,t)=>{var s;var n;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=Vu;const o=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&o.unshift(e);for(const c of o)for(const d of c._zod.onattach)d(e);if(o.length===0)(n=e._zod).deferred??(n.deferred=[]),(s=e._zod.deferred)==null||s.push(()=>{e._zod.run=e._zod.parse});else{const c=(h,g,v)=>{let I=Xn(h),P;for(const $ of g){if($._zod.def.when){if(!$._zod.def.when(h))continue}else if(I)continue;const C=h.issues.length,Y=$._zod.check(h);if(Y instanceof Promise&&(v==null?void 0:v.async)===!1)throw new er;if(P||Y instanceof Promise)P=(P??Promise.resolve()).then(async()=>{await Y,h.issues.length!==C&&(I||(I=Xn(h,C)))});else{if(h.issues.length===C)continue;I||(I=Xn(h,C))}}return P?P.then(()=>h):h},d=(h,g,v)=>{if(Xn(h))return h.aborted=!0,h;const I=c(g,o,v);if(I instanceof Promise){if(v.async===!1)throw new er;return I.then(P=>e._zod.parse(P,v))}return e._zod.parse(I,v)};e._zod.run=(h,g)=>{if(g.skipChecks)return e._zod.parse(h,g);if(g.direction==="backward"){const I=e._zod.parse({value:h.value,issues:[]},{...g,skipChecks:!0});return I instanceof Promise?I.then(P=>d(P,h,g)):d(I,h,g)}const v=e._zod.parse(h,g);if(v instanceof Promise){if(g.async===!1)throw new er;return v.then(I=>c(I,o,g))}return c(v,o,g)}}Se(e,"~standard",()=>({validate:c=>{var d;try{const h=Qc(e,c);return h.success?{value:h.data}:{issues:(d=h.error)==null?void 0:d.issues}}catch{return eu(e,c).then(g=>{var v;return g.success?{value:g.data}:{issues:(v=g.error)==null?void 0:v.issues}})}},vendor:"zod",version:1}))}),Ta=z("$ZodString",(e,t)=>{var n;Re.init(e,t),e._zod.pattern=[...((n=e==null?void 0:e._zod.bag)==null?void 0:n.patterns)??[]].pop()??ju(e._zod.bag),e._zod.parse=(o,s)=>{if(t.coerce)try{o.value=String(o.value)}catch{}return typeof o.value=="string"||o.issues.push({expected:"string",code:"invalid_type",input:o.value,inst:e}),o}}),Ce=z("$ZodStringFormat",(e,t)=>{yo.init(e,t),Ta.init(e,t)}),Ju=z("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=gu),Ce.init(e,t)}),Gu=z("$ZodUUID",(e,t)=>{if(t.version){const o={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(o===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=fs(o))}else t.pattern??(t.pattern=fs());Ce.init(e,t)}),Yu=z("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=yu),Ce.init(e,t)}),Xu=z("$ZodURL",(e,t)=>{Ce.init(e,t),e._zod.check=n=>{try{const o=n.value.trim(),s=new URL(o);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(s.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:n.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(s.protocol.endsWith(":")?s.protocol.slice(0,-1):s.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:n.value,inst:e,continue:!t.abort})),t.normalize?n.value=s.href:n.value=o;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:e,continue:!t.abort})}}}),Qu=z("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=bu()),Ce.init(e,t)}),el=z("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=hu),Ce.init(e,t)}),tl=z("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=uu),Ce.init(e,t)}),nl=z("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=lu),Ce.init(e,t)}),rl=z("$ZodULID",(e,t)=>{t.pattern??(t.pattern=du),Ce.init(e,t)}),ol=z("$ZodXID",(e,t)=>{t.pattern??(t.pattern=fu),Ce.init(e,t)}),al=z("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=pu),Ce.init(e,t)}),sl=z("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=Au(t)),Ce.init(e,t)}),il=z("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=Tu),Ce.init(e,t)}),cl=z("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=Ou(t)),Ce.init(e,t)}),ul=z("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=mu),Ce.init(e,t)}),ll=z("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=_u),Ce.init(e,t),e._zod.bag.format="ipv4"}),dl=z("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=wu),Ce.init(e,t),e._zod.bag.format="ipv6",e._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:e,continue:!t.abort})}}}),fl=z("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=xu),Ce.init(e,t)}),pl=z("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=ku),Ce.init(e,t),e._zod.check=n=>{const o=n.value.split("/");try{if(o.length!==2)throw new Error;const[s,c]=o;if(!c)throw new Error;const d=Number(c);if(`${d}`!==c)throw new Error;if(d<0||d>128)throw new Error;new URL(`http://[${s}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:e,continue:!t.abort})}}});function xi(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const hl=z("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=Su),Ce.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=n=>{xi(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:e,continue:!t.abort})}});function ml(e){if(!gi.test(e))return!1;const t=e.replace(/[-_]/g,o=>o==="-"?"+":"/"),n=t.padEnd(Math.ceil(t.length/4)*4,"=");return xi(n)}const gl=z("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=gi),Ce.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=n=>{ml(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:e,continue:!t.abort})}}),yl=z("$ZodE164",(e,t)=>{t.pattern??(t.pattern=Eu),Ce.init(e,t)});function vl(e,t=null){try{const n=e.split(".");if(n.length!==3)return!1;const[o]=n;if(!o)return!1;const s=JSON.parse(atob(o));return!("typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||t&&(!("alg"in s)||s.alg!==t))}catch{return!1}}const bl=z("$ZodJWT",(e,t)=>{Ce.init(e,t),e._zod.check=n=>{vl(n.value,t.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:e,continue:!t.abort})}}),ki=z("$ZodNumber",(e,t)=>{Re.init(e,t),e._zod.pattern=e._zod.bag.pattern??Du,e._zod.parse=(n,o)=>{if(t.coerce)try{n.value=Number(n.value)}catch{}const s=n.value;if(typeof s=="number"&&!Number.isNaN(s)&&Number.isFinite(s))return n;const c=typeof s=="number"?Number.isNaN(s)?"NaN":Number.isFinite(s)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:s,inst:e,...c?{received:c}:{}}),n}}),_l=z("$ZodNumberFormat",(e,t)=>{zu.init(e,t),ki.init(e,t)}),wl=z("$ZodBoolean",(e,t)=>{Re.init(e,t),e._zod.pattern=Nu,e._zod.parse=(n,o)=>{if(t.coerce)try{n.value=!!n.value}catch{}const s=n.value;return typeof s=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:s,inst:e}),n}}),xl=z("$ZodAny",(e,t)=>{Re.init(e,t),e._zod.parse=n=>n}),kl=z("$ZodUnknown",(e,t)=>{Re.init(e,t),e._zod.parse=n=>n}),Sl=z("$ZodNever",(e,t)=>{Re.init(e,t),e._zod.parse=(n,o)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:e}),n)});function ps(e,t,n){e.issues.length&&t.issues.push(...fi(n,e.issues)),t.value[n]=e.value}const El=z("$ZodArray",(e,t)=>{Re.init(e,t),e._zod.parse=(n,o)=>{const s=n.value;if(!Array.isArray(s))return n.issues.push({expected:"array",code:"invalid_type",input:s,inst:e}),n;n.value=Array(s.length);const c=[];for(let d=0;d<s.length;d++){const h=s[d],g=t.element._zod.run({value:h,issues:[]},o);g instanceof Promise?c.push(g.then(v=>ps(v,n,d))):ps(g,n,d)}return c.length?Promise.all(c).then(()=>n):n}});function co(e,t,n,o,s){if(e.issues.length){if(s&&!(n in o))return;t.issues.push(...fi(n,e.issues))}e.value===void 0?n in o&&(t.value[n]=void 0):t.value[n]=e.value}function Si(e){var o,s,c,d;const t=Object.keys(e.shape);for(const h of t)if(!((d=(c=(s=(o=e.shape)==null?void 0:o[h])==null?void 0:s._zod)==null?void 0:c.traits)!=null&&d.has("$ZodType")))throw new Error(`Invalid element at key "${h}": expected a Zod schema`);const n=Kc(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(n)}}function Ei(e,t,n,o,s,c){const d=[],h=s.keySet,g=s.catchall._zod,v=g.def.type,I=g.optout==="optional";for(const P in t){if(h.has(P))continue;if(v==="never"){d.push(P);continue}const $=g.run({value:t[P],issues:[]},o);$ instanceof Promise?e.push($.then(C=>co(C,n,P,t,I))):co($,n,P,t,I)}return d.length&&n.issues.push({code:"unrecognized_keys",keys:d,input:t,inst:c}),e.length?Promise.all(e).then(()=>n):n}const Tl=z("$ZodObject",(e,t)=>{Re.init(e,t);const n=Object.getOwnPropertyDescriptor(t,"shape");if(!(n!=null&&n.get)){const h=t.shape;Object.defineProperty(t,"shape",{get:()=>{const g={...h};return Object.defineProperty(t,"shape",{value:g}),g}})}const o=_a(()=>Si(t));Se(e._zod,"propValues",()=>{const h=t.shape,g={};for(const v in h){const I=h[v]._zod;if(I.values){g[v]??(g[v]=new Set);for(const P of I.values)g[v].add(P)}}return g});const s=io,c=t.catchall;let d;e._zod.parse=(h,g)=>{d??(d=o.value);const v=h.value;if(!s(v))return h.issues.push({expected:"object",code:"invalid_type",input:v,inst:e}),h;h.value={};const I=[],P=d.shape;for(const $ of d.keys){const C=P[$],Y=C._zod.optout==="optional",re=C._zod.run({value:v[$],issues:[]},g);re instanceof Promise?I.push(re.then(D=>co(D,h,$,v,Y))):co(re,h,$,v,Y)}return c?Ei(I,v,h,g,o.value,e):I.length?Promise.all(I).then(()=>h):h}}),Ol=z("$ZodObjectJIT",(e,t)=>{Tl.init(e,t);const n=e._zod.parse,o=_a(()=>Si(t)),s=$=>{var W;const C=new Wu(["shape","payload","ctx"]),Y=o.value,re=R=>{const q=ds(R);return`shape[${q}]._zod.run({ value: input[${q}], issues: [] }, ctx)`};C.write("const input = payload.value;");const D=Object.create(null);let Z=0;for(const R of Y.keys)D[R]=`key_${Z++}`;C.write("const newResult = {};");for(const R of Y.keys){const q=D[R],ae=ds(R),ce=$[R],me=((W=ce==null?void 0:ce._zod)==null?void 0:W.optout)==="optional";C.write(`const ${q} = ${re(R)};`),me?C.write(`
        if (${q}.issues.length) {
          if (${ae} in input) {
            payload.issues = payload.issues.concat(${q}.issues.map(iss => ({
              ...iss,
              path: iss.path ? [${ae}, ...iss.path] : [${ae}]
            })));
          }
        }
        
        if (${q}.value === undefined) {
          if (${ae} in input) {
            newResult[${ae}] = undefined;
          }
        } else {
          newResult[${ae}] = ${q}.value;
        }
        
      `):C.write(`
        if (${q}.issues.length) {
          payload.issues = payload.issues.concat(${q}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${ae}, ...iss.path] : [${ae}]
          })));
        }
        
        if (${q}.value === undefined) {
          if (${ae} in input) {
            newResult[${ae}] = undefined;
          }
        } else {
          newResult[${ae}] = ${q}.value;
        }
        
      `)}C.write("payload.value = newResult;"),C.write("return payload;");const L=C.compile();return(R,q)=>L($,R,q)};let c;const d=io,h=!ci.jitless,v=h&&Fc.value,I=t.catchall;let P;e._zod.parse=($,C)=>{P??(P=o.value);const Y=$.value;return d(Y)?h&&v&&(C==null?void 0:C.async)===!1&&C.jitless!==!0?(c||(c=s(t.shape)),$=c($,C),I?Ei([],Y,$,C,P,e):$):n($,C):($.issues.push({expected:"object",code:"invalid_type",input:Y,inst:e}),$)}});function hs(e,t,n,o){for(const c of e)if(c.issues.length===0)return t.value=c.value,t;const s=e.filter(c=>!Xn(c));return s.length===1?(t.value=s[0].value,s[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:n,errors:e.map(c=>c.issues.map(d=>zn(d,o,Mn())))}),t)}const Al=z("$ZodUnion",(e,t)=>{Re.init(e,t),Se(e._zod,"optin",()=>t.options.some(s=>s._zod.optin==="optional")?"optional":void 0),Se(e._zod,"optout",()=>t.options.some(s=>s._zod.optout==="optional")?"optional":void 0),Se(e._zod,"values",()=>{if(t.options.every(s=>s._zod.values))return new Set(t.options.flatMap(s=>Array.from(s._zod.values)))}),Se(e._zod,"pattern",()=>{if(t.options.every(s=>s._zod.pattern)){const s=t.options.map(c=>c._zod.pattern);return new RegExp(`^(${s.map(c=>xa(c.source)).join("|")})$`)}});const n=t.options.length===1,o=t.options[0]._zod.run;e._zod.parse=(s,c)=>{if(n)return o(s,c);let d=!1;const h=[];for(const g of t.options){const v=g._zod.run({value:s.value,issues:[]},c);if(v instanceof Promise)h.push(v),d=!0;else{if(v.issues.length===0)return v;h.push(v)}}return d?Promise.all(h).then(g=>hs(g,s,e,c)):hs(h,s,e,c)}}),jl=z("$ZodIntersection",(e,t)=>{Re.init(e,t),e._zod.parse=(n,o)=>{const s=n.value,c=t.left._zod.run({value:s,issues:[]},o),d=t.right._zod.run({value:s,issues:[]},o);return c instanceof Promise||d instanceof Promise?Promise.all([c,d]).then(([g,v])=>ms(n,g,v)):ms(n,c,d)}});function ia(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(Or(e)&&Or(t)){const n=Object.keys(t),o=Object.keys(e).filter(c=>n.indexOf(c)!==-1),s={...e,...t};for(const c of o){const d=ia(e[c],t[c]);if(!d.valid)return{valid:!1,mergeErrorPath:[c,...d.mergeErrorPath]};s[c]=d.data}return{valid:!0,data:s}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let o=0;o<e.length;o++){const s=e[o],c=t[o],d=ia(s,c);if(!d.valid)return{valid:!1,mergeErrorPath:[o,...d.mergeErrorPath]};n.push(d.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function ms(e,t,n){const o=new Map;let s;for(const h of t.issues)if(h.code==="unrecognized_keys"){s??(s=h);for(const g of h.keys)o.has(g)||o.set(g,{}),o.get(g).l=!0}else e.issues.push(h);for(const h of n.issues)if(h.code==="unrecognized_keys")for(const g of h.keys)o.has(g)||o.set(g,{}),o.get(g).r=!0;else e.issues.push(h);const c=[...o].filter(([,h])=>h.l&&h.r).map(([h])=>h);if(c.length&&s&&e.issues.push({...s,keys:c}),Xn(e))return e;const d=ia(t.value,n.value);if(!d.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(d.mergeErrorPath)}`);return e.value=d.data,e}const Il=z("$ZodEnum",(e,t)=>{Re.init(e,t);const n=ui(t.entries),o=new Set(n);e._zod.values=o,e._zod.pattern=new RegExp(`^(${n.filter(s=>Zc.has(typeof s)).map(s=>typeof s=="string"?tr(s):s.toString()).join("|")})$`),e._zod.parse=(s,c)=>{const d=s.value;return o.has(d)||s.issues.push({code:"invalid_value",values:n,input:d,inst:e}),s}}),Dl=z("$ZodLiteral",(e,t)=>{if(Re.init(e,t),t.values.length===0)throw new Error("Cannot create literal schema with no valid values");const n=new Set(t.values);e._zod.values=n,e._zod.pattern=new RegExp(`^(${t.values.map(o=>typeof o=="string"?tr(o):o?tr(o.toString()):String(o)).join("|")})$`),e._zod.parse=(o,s)=>{const c=o.value;return n.has(c)||o.issues.push({code:"invalid_value",values:t.values,input:c,inst:e}),o}}),Nl=z("$ZodTransform",(e,t)=>{Re.init(e,t),e._zod.parse=(n,o)=>{if(o.direction==="backward")throw new ii(e.constructor.name);const s=t.transform(n.value,n);if(o.async)return(s instanceof Promise?s:Promise.resolve(s)).then(d=>(n.value=d,n));if(s instanceof Promise)throw new er;return n.value=s,n}});function gs(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const Ti=z("$ZodOptional",(e,t)=>{Re.init(e,t),e._zod.optin="optional",e._zod.optout="optional",Se(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),Se(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${xa(n.source)})?$`):void 0}),e._zod.parse=(n,o)=>{if(t.innerType._zod.optin==="optional"){const s=t.innerType._zod.run(n,o);return s instanceof Promise?s.then(c=>gs(c,n.value)):gs(s,n.value)}return n.value===void 0?n:t.innerType._zod.run(n,o)}}),Pl=z("$ZodExactOptional",(e,t)=>{Ti.init(e,t),Se(e._zod,"values",()=>t.innerType._zod.values),Se(e._zod,"pattern",()=>t.innerType._zod.pattern),e._zod.parse=(n,o)=>t.innerType._zod.run(n,o)}),Cl=z("$ZodNullable",(e,t)=>{Re.init(e,t),Se(e._zod,"optin",()=>t.innerType._zod.optin),Se(e._zod,"optout",()=>t.innerType._zod.optout),Se(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${xa(n.source)}|null)$`):void 0}),Se(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(n,o)=>n.value===null?n:t.innerType._zod.run(n,o)}),Ml=z("$ZodDefault",(e,t)=>{Re.init(e,t),e._zod.optin="optional",Se(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,o)=>{if(o.direction==="backward")return t.innerType._zod.run(n,o);if(n.value===void 0)return n.value=t.defaultValue,n;const s=t.innerType._zod.run(n,o);return s instanceof Promise?s.then(c=>ys(c,t)):ys(s,t)}});function ys(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const zl=z("$ZodPrefault",(e,t)=>{Re.init(e,t),e._zod.optin="optional",Se(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,o)=>(o.direction==="backward"||n.value===void 0&&(n.value=t.defaultValue),t.innerType._zod.run(n,o))}),Rl=z("$ZodNonOptional",(e,t)=>{Re.init(e,t),Se(e._zod,"values",()=>{const n=t.innerType._zod.values;return n?new Set([...n].filter(o=>o!==void 0)):void 0}),e._zod.parse=(n,o)=>{const s=t.innerType._zod.run(n,o);return s instanceof Promise?s.then(c=>vs(c,e)):vs(s,e)}});function vs(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const Ll=z("$ZodCatch",(e,t)=>{Re.init(e,t),Se(e._zod,"optin",()=>t.innerType._zod.optin),Se(e._zod,"optout",()=>t.innerType._zod.optout),Se(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,o)=>{if(o.direction==="backward")return t.innerType._zod.run(n,o);const s=t.innerType._zod.run(n,o);return s instanceof Promise?s.then(c=>(n.value=c.value,c.issues.length&&(n.value=t.catchValue({...n,error:{issues:c.issues.map(d=>zn(d,o,Mn()))},input:n.value}),n.issues=[]),n)):(n.value=s.value,s.issues.length&&(n.value=t.catchValue({...n,error:{issues:s.issues.map(c=>zn(c,o,Mn()))},input:n.value}),n.issues=[]),n)}}),$l=z("$ZodPipe",(e,t)=>{Re.init(e,t),Se(e._zod,"values",()=>t.in._zod.values),Se(e._zod,"optin",()=>t.in._zod.optin),Se(e._zod,"optout",()=>t.out._zod.optout),Se(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(n,o)=>{if(o.direction==="backward"){const c=t.out._zod.run(n,o);return c instanceof Promise?c.then(d=>Qr(d,t.in,o)):Qr(c,t.in,o)}const s=t.in._zod.run(n,o);return s instanceof Promise?s.then(c=>Qr(c,t.out,o)):Qr(s,t.out,o)}});function Qr(e,t,n){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},n)}const Fl=z("$ZodReadonly",(e,t)=>{Re.init(e,t),Se(e._zod,"propValues",()=>t.innerType._zod.propValues),Se(e._zod,"values",()=>t.innerType._zod.values),Se(e._zod,"optin",()=>{var n,o;return(o=(n=t.innerType)==null?void 0:n._zod)==null?void 0:o.optin}),Se(e._zod,"optout",()=>{var n,o;return(o=(n=t.innerType)==null?void 0:n._zod)==null?void 0:o.optout}),e._zod.parse=(n,o)=>{if(o.direction==="backward")return t.innerType._zod.run(n,o);const s=t.innerType._zod.run(n,o);return s instanceof Promise?s.then(bs):bs(s)}});function bs(e){return e.value=Object.freeze(e.value),e}const Zl=z("$ZodCustom",(e,t)=>{ht.init(e,t),Re.init(e,t),e._zod.parse=(n,o)=>n,e._zod.check=n=>{const o=n.value,s=t.fn(o);if(s instanceof Promise)return s.then(c=>_s(c,n,o,e));_s(s,n,o,e)}});function _s(e,t,n,o){if(!e){const s={code:"custom",input:n,inst:o,path:[...o._zod.def.path??[]],continue:!o._zod.def.abort};o._zod.def.params&&(s.params=o._zod.def.params),t.issues.push(Ar(s))}}var ws;class Kl{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...n){const o=n[0];return this._map.set(t,o),o&&typeof o=="object"&&"id"in o&&this._idmap.set(o.id,t),this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const n=this._map.get(t);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(t),this}get(t){const n=t._zod.parent;if(n){const o={...this.get(n)??{}};delete o.id;const s={...o,...this._map.get(t)};return Object.keys(s).length?s:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function Ul(){return new Kl}(ws=globalThis).__zod_globalRegistry??(ws.__zod_globalRegistry=Ul());const kr=globalThis.__zod_globalRegistry;function Bl(e,t){return new e({type:"string",...ue(t)})}function ql(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...ue(t)})}function xs(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...ue(t)})}function Hl(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...ue(t)})}function Wl(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...ue(t)})}function Vl(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...ue(t)})}function Jl(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...ue(t)})}function Gl(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...ue(t)})}function Yl(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...ue(t)})}function Xl(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...ue(t)})}function Ql(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...ue(t)})}function ed(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...ue(t)})}function td(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...ue(t)})}function nd(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...ue(t)})}function rd(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...ue(t)})}function od(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...ue(t)})}function ad(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...ue(t)})}function sd(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...ue(t)})}function id(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...ue(t)})}function cd(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...ue(t)})}function ud(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...ue(t)})}function ld(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...ue(t)})}function dd(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...ue(t)})}function fd(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...ue(t)})}function pd(e,t){return new e({type:"string",format:"date",check:"string_format",...ue(t)})}function hd(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...ue(t)})}function md(e,t){return new e({type:"string",format:"duration",check:"string_format",...ue(t)})}function gd(e,t){return new e({type:"number",checks:[],...ue(t)})}function yd(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...ue(t)})}function vd(e,t){return new e({type:"boolean",...ue(t)})}function bd(e){return new e({type:"any"})}function _d(e){return new e({type:"unknown"})}function wd(e,t){return new e({type:"never",...ue(t)})}function ks(e,t){return new _i({check:"less_than",...ue(t),value:e,inclusive:!1})}function Vo(e,t){return new _i({check:"less_than",...ue(t),value:e,inclusive:!0})}function Ss(e,t){return new wi({check:"greater_than",...ue(t),value:e,inclusive:!1})}function Jo(e,t){return new wi({check:"greater_than",...ue(t),value:e,inclusive:!0})}function Es(e,t){return new Mu({check:"multiple_of",...ue(t),value:e})}function Oi(e,t){return new Ru({check:"max_length",...ue(t),maximum:e})}function uo(e,t){return new Lu({check:"min_length",...ue(t),minimum:e})}function Ai(e,t){return new $u({check:"length_equals",...ue(t),length:e})}function xd(e,t){return new Fu({check:"string_format",format:"regex",...ue(t),pattern:e})}function kd(e){return new Zu({check:"string_format",format:"lowercase",...ue(e)})}function Sd(e){return new Ku({check:"string_format",format:"uppercase",...ue(e)})}function Ed(e,t){return new Uu({check:"string_format",format:"includes",...ue(t),includes:e})}function Td(e,t){return new Bu({check:"string_format",format:"starts_with",...ue(t),prefix:e})}function Od(e,t){return new qu({check:"string_format",format:"ends_with",...ue(t),suffix:e})}function rr(e){return new Hu({check:"overwrite",tx:e})}function Ad(e){return rr(t=>t.normalize(e))}function jd(){return rr(e=>e.trim())}function Id(){return rr(e=>e.toLowerCase())}function Dd(){return rr(e=>e.toUpperCase())}function Nd(){return rr(e=>$c(e))}function Pd(e,t,n){return new e({type:"array",element:t,...ue(n)})}function Cd(e,t,n){return new e({type:"custom",check:"custom",fn:t,...ue(n)})}function Md(e){const t=zd(n=>(n.addIssue=o=>{if(typeof o=="string")n.issues.push(Ar(o,n.value,t._zod.def));else{const s=o;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=n.value),s.inst??(s.inst=t),s.continue??(s.continue=!t._zod.def.abort),n.issues.push(Ar(s))}},e(n.value,n)));return t}function zd(e,t){const n=new ht({check:"custom",...ue(t)});return n._zod.check=e,n}function ji(e){let t=(e==null?void 0:e.target)??"draft-2020-12";return t==="draft-4"&&(t="draft-04"),t==="draft-7"&&(t="draft-07"),{processors:e.processors??{},metadataRegistry:(e==null?void 0:e.metadata)??kr,target:t,unrepresentable:(e==null?void 0:e.unrepresentable)??"throw",override:(e==null?void 0:e.override)??(()=>{}),io:(e==null?void 0:e.io)??"output",counter:0,seen:new Map,cycles:(e==null?void 0:e.cycles)??"ref",reused:(e==null?void 0:e.reused)??"inline",external:(e==null?void 0:e.external)??void 0}}function et(e,t,n={path:[],schemaPath:[]}){var I,P;var o;const s=e._zod.def,c=t.seen.get(e);if(c)return c.count++,n.schemaPath.includes(e)&&(c.cycle=n.path),c.schema;const d={schema:{},count:1,cycle:void 0,path:n.path};t.seen.set(e,d);const h=(P=(I=e._zod).toJSONSchema)==null?void 0:P.call(I);if(h)d.schema=h;else{const $={...n,schemaPath:[...n.schemaPath,e],path:n.path};if(e._zod.processJSONSchema)e._zod.processJSONSchema(t,d.schema,$);else{const Y=d.schema,re=t.processors[s.type];if(!re)throw new Error(`[toJSONSchema]: Non-representable type encountered: ${s.type}`);re(e,t,Y,$)}const C=e._zod.parent;C&&(d.ref||(d.ref=C),et(C,t,$),t.seen.get(C).isParent=!0)}const g=t.metadataRegistry.get(e);return g&&Object.assign(d.schema,g),t.io==="input"&&ct(e)&&(delete d.schema.examples,delete d.schema.default),t.io==="input"&&d.schema._prefault&&((o=d.schema).default??(o.default=d.schema._prefault)),delete d.schema._prefault,t.seen.get(e).schema}function Ii(e,t){var d,h,g,v;const n=e.seen.get(t);if(!n)throw new Error("Unprocessed schema. This is a bug in Zod.");const o=new Map;for(const I of e.seen.entries()){const P=(d=e.metadataRegistry.get(I[0]))==null?void 0:d.id;if(P){const $=o.get(P);if($&&$!==I[0])throw new Error(`Duplicate schema id "${P}" detected during JSON Schema conversion. Two different schemas cannot share the same id when converted together.`);o.set(P,I[0])}}const s=I=>{var re;const P=e.target==="draft-2020-12"?"$defs":"definitions";if(e.external){const D=(re=e.external.registry.get(I[0]))==null?void 0:re.id,Z=e.external.uri??(W=>W);if(D)return{ref:Z(D)};const L=I[1].defId??I[1].schema.id??`schema${e.counter++}`;return I[1].defId=L,{defId:L,ref:`${Z("__shared")}#/${P}/${L}`}}if(I[1]===n)return{ref:"#"};const C=`#/${P}/`,Y=I[1].schema.id??`__schema${e.counter++}`;return{defId:Y,ref:C+Y}},c=I=>{if(I[1].schema.$ref)return;const P=I[1],{ref:$,defId:C}=s(I);P.def={...P.schema},C&&(P.defId=C);const Y=P.schema;for(const re in Y)delete Y[re];Y.$ref=$};if(e.cycles==="throw")for(const I of e.seen.entries()){const P=I[1];if(P.cycle)throw new Error(`Cycle detected: #/${(h=P.cycle)==null?void 0:h.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const I of e.seen.entries()){const P=I[1];if(t===I[0]){c(I);continue}if(e.external){const C=(g=e.external.registry.get(I[0]))==null?void 0:g.id;if(t!==I[0]&&C){c(I);continue}}if((v=e.metadataRegistry.get(I[0]))==null?void 0:v.id){c(I);continue}if(P.cycle){c(I);continue}if(P.count>1&&e.reused==="ref"){c(I);continue}}}function Di(e,t){var d,h,g;const n=e.seen.get(t);if(!n)throw new Error("Unprocessed schema. This is a bug in Zod.");const o=v=>{const I=e.seen.get(v);if(I.ref===null)return;const P=I.def??I.schema,$={...P},C=I.ref;if(I.ref=null,C){o(C);const re=e.seen.get(C),D=re.schema;if(D.$ref&&(e.target==="draft-07"||e.target==="draft-04"||e.target==="openapi-3.0")?(P.allOf=P.allOf??[],P.allOf.push(D)):Object.assign(P,D),Object.assign(P,$),v._zod.parent===C)for(const L in P)L==="$ref"||L==="allOf"||L in $||delete P[L];if(D.$ref&&re.def)for(const L in P)L==="$ref"||L==="allOf"||L in re.def&&JSON.stringify(P[L])===JSON.stringify(re.def[L])&&delete P[L]}const Y=v._zod.parent;if(Y&&Y!==C){o(Y);const re=e.seen.get(Y);if(re!=null&&re.schema.$ref&&(P.$ref=re.schema.$ref,re.def))for(const D in P)D==="$ref"||D==="allOf"||D in re.def&&JSON.stringify(P[D])===JSON.stringify(re.def[D])&&delete P[D]}e.override({zodSchema:v,jsonSchema:P,path:I.path??[]})};for(const v of[...e.seen.entries()].reverse())o(v[0]);const s={};if(e.target==="draft-2020-12"?s.$schema="https://json-schema.org/draft/2020-12/schema":e.target==="draft-07"?s.$schema="http://json-schema.org/draft-07/schema#":e.target==="draft-04"?s.$schema="http://json-schema.org/draft-04/schema#":e.target,(d=e.external)!=null&&d.uri){const v=(h=e.external.registry.get(t))==null?void 0:h.id;if(!v)throw new Error("Schema is missing an `id` property");s.$id=e.external.uri(v)}Object.assign(s,n.def??n.schema);const c=((g=e.external)==null?void 0:g.defs)??{};for(const v of e.seen.entries()){const I=v[1];I.def&&I.defId&&(c[I.defId]=I.def)}e.external||Object.keys(c).length>0&&(e.target==="draft-2020-12"?s.$defs=c:s.definitions=c);try{const v=JSON.parse(JSON.stringify(s));return Object.defineProperty(v,"~standard",{value:{...t["~standard"],jsonSchema:{input:lo(t,"input",e.processors),output:lo(t,"output",e.processors)}},enumerable:!1,writable:!1}),v}catch{throw new Error("Error converting schema to JSON.")}}function ct(e,t){const n=t??{seen:new Set};if(n.seen.has(e))return!1;n.seen.add(e);const o=e._zod.def;if(o.type==="transform")return!0;if(o.type==="array")return ct(o.element,n);if(o.type==="set")return ct(o.valueType,n);if(o.type==="lazy")return ct(o.getter(),n);if(o.type==="promise"||o.type==="optional"||o.type==="nonoptional"||o.type==="nullable"||o.type==="readonly"||o.type==="default"||o.type==="prefault")return ct(o.innerType,n);if(o.type==="intersection")return ct(o.left,n)||ct(o.right,n);if(o.type==="record"||o.type==="map")return ct(o.keyType,n)||ct(o.valueType,n);if(o.type==="pipe")return ct(o.in,n)||ct(o.out,n);if(o.type==="object"){for(const s in o.shape)if(ct(o.shape[s],n))return!0;return!1}if(o.type==="union"){for(const s of o.options)if(ct(s,n))return!0;return!1}if(o.type==="tuple"){for(const s of o.items)if(ct(s,n))return!0;return!!(o.rest&&ct(o.rest,n))}return!1}const Rd=(e,t={})=>n=>{const o=ji({...n,processors:t});return et(e,o),Ii(o,e),Di(o,e)},lo=(e,t,n={})=>o=>{const{libraryOptions:s,target:c}=o??{},d=ji({...s??{},target:c,io:t,processors:n});return et(e,d),Ii(d,e),Di(d,e)},Ld={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},$d=(e,t,n,o)=>{const s=n;s.type="string";const{minimum:c,maximum:d,format:h,patterns:g,contentEncoding:v}=e._zod.bag;if(typeof c=="number"&&(s.minLength=c),typeof d=="number"&&(s.maxLength=d),h&&(s.format=Ld[h]??h,s.format===""&&delete s.format,h==="time"&&delete s.format),v&&(s.contentEncoding=v),g&&g.size>0){const I=[...g];I.length===1?s.pattern=I[0].source:I.length>1&&(s.allOf=[...I.map(P=>({...t.target==="draft-07"||t.target==="draft-04"||t.target==="openapi-3.0"?{type:"string"}:{},pattern:P.source}))])}},Fd=(e,t,n,o)=>{const s=n,{minimum:c,maximum:d,format:h,multipleOf:g,exclusiveMaximum:v,exclusiveMinimum:I}=e._zod.bag;typeof h=="string"&&h.includes("int")?s.type="integer":s.type="number",typeof I=="number"&&(t.target==="draft-04"||t.target==="openapi-3.0"?(s.minimum=I,s.exclusiveMinimum=!0):s.exclusiveMinimum=I),typeof c=="number"&&(s.minimum=c,typeof I=="number"&&t.target!=="draft-04"&&(I>=c?delete s.minimum:delete s.exclusiveMinimum)),typeof v=="number"&&(t.target==="draft-04"||t.target==="openapi-3.0"?(s.maximum=v,s.exclusiveMaximum=!0):s.exclusiveMaximum=v),typeof d=="number"&&(s.maximum=d,typeof v=="number"&&t.target!=="draft-04"&&(v<=d?delete s.maximum:delete s.exclusiveMaximum)),typeof g=="number"&&(s.multipleOf=g)},Zd=(e,t,n,o)=>{n.type="boolean"},Kd=(e,t,n,o)=>{n.not={}},Ud=(e,t,n,o)=>{},Bd=(e,t,n,o)=>{},qd=(e,t,n,o)=>{const s=e._zod.def,c=ui(s.entries);c.every(d=>typeof d=="number")&&(n.type="number"),c.every(d=>typeof d=="string")&&(n.type="string"),n.enum=c},Hd=(e,t,n,o)=>{const s=e._zod.def,c=[];for(const d of s.values)if(d===void 0){if(t.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof d=="bigint"){if(t.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");c.push(Number(d))}else c.push(d);if(c.length!==0)if(c.length===1){const d=c[0];n.type=d===null?"null":typeof d,t.target==="draft-04"||t.target==="openapi-3.0"?n.enum=[d]:n.const=d}else c.every(d=>typeof d=="number")&&(n.type="number"),c.every(d=>typeof d=="string")&&(n.type="string"),c.every(d=>typeof d=="boolean")&&(n.type="boolean"),c.every(d=>d===null)&&(n.type="null"),n.enum=c},Wd=(e,t,n,o)=>{if(t.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema")},Vd=(e,t,n,o)=>{if(t.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema")},Jd=(e,t,n,o)=>{const s=n,c=e._zod.def,{minimum:d,maximum:h}=e._zod.bag;typeof d=="number"&&(s.minItems=d),typeof h=="number"&&(s.maxItems=h),s.type="array",s.items=et(c.element,t,{...o,path:[...o.path,"items"]})},Gd=(e,t,n,o)=>{var v;const s=n,c=e._zod.def;s.type="object",s.properties={};const d=c.shape;for(const I in d)s.properties[I]=et(d[I],t,{...o,path:[...o.path,"properties",I]});const h=new Set(Object.keys(d)),g=new Set([...h].filter(I=>{const P=c.shape[I]._zod;return t.io==="input"?P.optin===void 0:P.optout===void 0}));g.size>0&&(s.required=Array.from(g)),((v=c.catchall)==null?void 0:v._zod.def.type)==="never"?s.additionalProperties=!1:c.catchall?c.catchall&&(s.additionalProperties=et(c.catchall,t,{...o,path:[...o.path,"additionalProperties"]})):t.io==="output"&&(s.additionalProperties=!1)},Yd=(e,t,n,o)=>{const s=e._zod.def,c=s.inclusive===!1,d=s.options.map((h,g)=>et(h,t,{...o,path:[...o.path,c?"oneOf":"anyOf",g]}));c?n.oneOf=d:n.anyOf=d},Xd=(e,t,n,o)=>{const s=e._zod.def,c=et(s.left,t,{...o,path:[...o.path,"allOf",0]}),d=et(s.right,t,{...o,path:[...o.path,"allOf",1]}),h=v=>"allOf"in v&&Object.keys(v).length===1,g=[...h(c)?c.allOf:[c],...h(d)?d.allOf:[d]];n.allOf=g},Qd=(e,t,n,o)=>{const s=e._zod.def,c=et(s.innerType,t,o),d=t.seen.get(e);t.target==="openapi-3.0"?(d.ref=s.innerType,n.nullable=!0):n.anyOf=[c,{type:"null"}]},ef=(e,t,n,o)=>{const s=e._zod.def;et(s.innerType,t,o);const c=t.seen.get(e);c.ref=s.innerType},tf=(e,t,n,o)=>{const s=e._zod.def;et(s.innerType,t,o);const c=t.seen.get(e);c.ref=s.innerType,n.default=JSON.parse(JSON.stringify(s.defaultValue))},nf=(e,t,n,o)=>{const s=e._zod.def;et(s.innerType,t,o);const c=t.seen.get(e);c.ref=s.innerType,t.io==="input"&&(n._prefault=JSON.parse(JSON.stringify(s.defaultValue)))},rf=(e,t,n,o)=>{const s=e._zod.def;et(s.innerType,t,o);const c=t.seen.get(e);c.ref=s.innerType;let d;try{d=s.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}n.default=d},of=(e,t,n,o)=>{const s=e._zod.def,c=t.io==="input"?s.in._zod.def.type==="transform"?s.out:s.in:s.out;et(c,t,o);const d=t.seen.get(e);d.ref=c},af=(e,t,n,o)=>{const s=e._zod.def;et(s.innerType,t,o);const c=t.seen.get(e);c.ref=s.innerType,n.readOnly=!0},Ni=(e,t,n,o)=>{const s=e._zod.def;et(s.innerType,t,o);const c=t.seen.get(e);c.ref=s.innerType},sf=z("ZodISODateTime",(e,t)=>{sl.init(e,t),$e.init(e,t)});function cf(e){return fd(sf,e)}const uf=z("ZodISODate",(e,t)=>{il.init(e,t),$e.init(e,t)});function lf(e){return pd(uf,e)}const df=z("ZodISOTime",(e,t)=>{cl.init(e,t),$e.init(e,t)});function ff(e){return hd(df,e)}const pf=z("ZodISODuration",(e,t)=>{ul.init(e,t),$e.init(e,t)});function hf(e){return md(pf,e)}const Pi=(e,t)=>{hi.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:n=>Xc(e,n)},flatten:{value:n=>Yc(e,n)},addIssue:{value:n=>{e.issues.push(n),e.message=JSON.stringify(e.issues,sa,2)}},addIssues:{value:n=>{e.issues.push(...n),e.message=JSON.stringify(e.issues,sa,2)}},isEmpty:{get(){return e.issues.length===0}}})},Ci=z("ZodError",Pi),It=z("ZodError",Pi,{Parent:Error}),mf=Sa(It),gf=Ea(It),yf=mo(It),vf=go(It),bf=tu(It),_f=nu(It),wf=ru(It),xf=ou(It),kf=au(It),Sf=su(It),Ef=iu(It),Tf=cu(It),Le=z("ZodType",(e,t)=>(Re.init(e,t),Object.assign(e["~standard"],{jsonSchema:{input:lo(e,"input"),output:lo(e,"output")}}),e.toJSONSchema=Rd(e,{}),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...n)=>e.clone(yn(t,{checks:[...t.checks??[],...n.map(o=>typeof o=="function"?{_zod:{check:o,def:{check:"custom"},onattach:[]}}:o)]}),{parent:!0}),e.with=e.check,e.clone=(n,o)=>vn(e,n,o),e.brand=()=>e,e.register=(n,o)=>(n.add(e,o),e),e.parse=(n,o)=>mf(e,n,o,{callee:e.parse}),e.safeParse=(n,o)=>yf(e,n,o),e.parseAsync=async(n,o)=>gf(e,n,o,{callee:e.parseAsync}),e.safeParseAsync=async(n,o)=>vf(e,n,o),e.spa=e.safeParseAsync,e.encode=(n,o)=>bf(e,n,o),e.decode=(n,o)=>_f(e,n,o),e.encodeAsync=async(n,o)=>wf(e,n,o),e.decodeAsync=async(n,o)=>xf(e,n,o),e.safeEncode=(n,o)=>kf(e,n,o),e.safeDecode=(n,o)=>Sf(e,n,o),e.safeEncodeAsync=async(n,o)=>Ef(e,n,o),e.safeDecodeAsync=async(n,o)=>Tf(e,n,o),e.refine=(n,o)=>e.check(bp(n,o)),e.superRefine=n=>e.check(_p(n)),e.overwrite=n=>e.check(rr(n)),e.optional=()=>js(e),e.exactOptional=()=>sp(e),e.nullable=()=>Is(e),e.nullish=()=>js(Is(e)),e.nonoptional=n=>fp(e,n),e.array=()=>nn(e),e.or=n=>Oa([e,n]),e.and=n=>tp(e,n),e.transform=n=>Ds(e,op(n)),e.default=n=>up(e,n),e.prefault=n=>dp(e,n),e.catch=n=>hp(e,n),e.pipe=n=>Ds(e,n),e.readonly=()=>yp(e),e.describe=n=>{const o=e.clone();return kr.add(o,{description:n}),o},Object.defineProperty(e,"description",{get(){var n;return(n=kr.get(e))==null?void 0:n.description},configurable:!0}),e.meta=(...n)=>{if(n.length===0)return kr.get(e);const o=e.clone();return kr.add(o,n[0]),o},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e.apply=n=>n(e),e)),Mi=z("_ZodString",(e,t)=>{Ta.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(o,s,c)=>$d(e,o,s);const n=e._zod.bag;e.format=n.format??null,e.minLength=n.minimum??null,e.maxLength=n.maximum??null,e.regex=(...o)=>e.check(xd(...o)),e.includes=(...o)=>e.check(Ed(...o)),e.startsWith=(...o)=>e.check(Td(...o)),e.endsWith=(...o)=>e.check(Od(...o)),e.min=(...o)=>e.check(uo(...o)),e.max=(...o)=>e.check(Oi(...o)),e.length=(...o)=>e.check(Ai(...o)),e.nonempty=(...o)=>e.check(uo(1,...o)),e.lowercase=o=>e.check(kd(o)),e.uppercase=o=>e.check(Sd(o)),e.trim=()=>e.check(jd()),e.normalize=(...o)=>e.check(Ad(...o)),e.toLowerCase=()=>e.check(Id()),e.toUpperCase=()=>e.check(Dd()),e.slugify=()=>e.check(Nd())}),Of=z("ZodString",(e,t)=>{Ta.init(e,t),Mi.init(e,t),e.email=n=>e.check(ql(Af,n)),e.url=n=>e.check(Gl(jf,n)),e.jwt=n=>e.check(dd(Bf,n)),e.emoji=n=>e.check(Yl(If,n)),e.guid=n=>e.check(xs(Ts,n)),e.uuid=n=>e.check(Hl(eo,n)),e.uuidv4=n=>e.check(Wl(eo,n)),e.uuidv6=n=>e.check(Vl(eo,n)),e.uuidv7=n=>e.check(Jl(eo,n)),e.nanoid=n=>e.check(Xl(Df,n)),e.guid=n=>e.check(xs(Ts,n)),e.cuid=n=>e.check(Ql(Nf,n)),e.cuid2=n=>e.check(ed(Pf,n)),e.ulid=n=>e.check(td(Cf,n)),e.base64=n=>e.check(cd(Zf,n)),e.base64url=n=>e.check(ud(Kf,n)),e.xid=n=>e.check(nd(Mf,n)),e.ksuid=n=>e.check(rd(zf,n)),e.ipv4=n=>e.check(od(Rf,n)),e.ipv6=n=>e.check(ad(Lf,n)),e.cidrv4=n=>e.check(sd($f,n)),e.cidrv6=n=>e.check(id(Ff,n)),e.e164=n=>e.check(ld(Uf,n)),e.datetime=n=>e.check(cf(n)),e.date=n=>e.check(lf(n)),e.time=n=>e.check(ff(n)),e.duration=n=>e.check(hf(n))});function de(e){return Bl(Of,e)}const $e=z("ZodStringFormat",(e,t)=>{Ce.init(e,t),Mi.init(e,t)}),Af=z("ZodEmail",(e,t)=>{Yu.init(e,t),$e.init(e,t)}),Ts=z("ZodGUID",(e,t)=>{Ju.init(e,t),$e.init(e,t)}),eo=z("ZodUUID",(e,t)=>{Gu.init(e,t),$e.init(e,t)}),jf=z("ZodURL",(e,t)=>{Xu.init(e,t),$e.init(e,t)}),If=z("ZodEmoji",(e,t)=>{Qu.init(e,t),$e.init(e,t)}),Df=z("ZodNanoID",(e,t)=>{el.init(e,t),$e.init(e,t)}),Nf=z("ZodCUID",(e,t)=>{tl.init(e,t),$e.init(e,t)}),Pf=z("ZodCUID2",(e,t)=>{nl.init(e,t),$e.init(e,t)}),Cf=z("ZodULID",(e,t)=>{rl.init(e,t),$e.init(e,t)}),Mf=z("ZodXID",(e,t)=>{ol.init(e,t),$e.init(e,t)}),zf=z("ZodKSUID",(e,t)=>{al.init(e,t),$e.init(e,t)}),Rf=z("ZodIPv4",(e,t)=>{ll.init(e,t),$e.init(e,t)}),Lf=z("ZodIPv6",(e,t)=>{dl.init(e,t),$e.init(e,t)}),$f=z("ZodCIDRv4",(e,t)=>{fl.init(e,t),$e.init(e,t)}),Ff=z("ZodCIDRv6",(e,t)=>{pl.init(e,t),$e.init(e,t)}),Zf=z("ZodBase64",(e,t)=>{hl.init(e,t),$e.init(e,t)}),Kf=z("ZodBase64URL",(e,t)=>{gl.init(e,t),$e.init(e,t)}),Uf=z("ZodE164",(e,t)=>{yl.init(e,t),$e.init(e,t)}),Bf=z("ZodJWT",(e,t)=>{bl.init(e,t),$e.init(e,t)}),zi=z("ZodNumber",(e,t)=>{ki.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(o,s,c)=>Fd(e,o,s),e.gt=(o,s)=>e.check(Ss(o,s)),e.gte=(o,s)=>e.check(Jo(o,s)),e.min=(o,s)=>e.check(Jo(o,s)),e.lt=(o,s)=>e.check(ks(o,s)),e.lte=(o,s)=>e.check(Vo(o,s)),e.max=(o,s)=>e.check(Vo(o,s)),e.int=o=>e.check(Os(o)),e.safe=o=>e.check(Os(o)),e.positive=o=>e.check(Ss(0,o)),e.nonnegative=o=>e.check(Jo(0,o)),e.negative=o=>e.check(ks(0,o)),e.nonpositive=o=>e.check(Vo(0,o)),e.multipleOf=(o,s)=>e.check(Es(o,s)),e.step=(o,s)=>e.check(Es(o,s)),e.finite=()=>e;const n=e._zod.bag;e.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),e.isFinite=!0,e.format=n.format??null});function Qe(e){return gd(zi,e)}const qf=z("ZodNumberFormat",(e,t)=>{_l.init(e,t),zi.init(e,t)});function Os(e){return yd(qf,e)}const Hf=z("ZodBoolean",(e,t)=>{wl.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>Zd(e,n,o)});function Ri(e){return vd(Hf,e)}const Wf=z("ZodAny",(e,t)=>{xl.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>Ud()});function fo(){return bd(Wf)}const Vf=z("ZodUnknown",(e,t)=>{kl.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>Bd()});function As(){return _d(Vf)}const Jf=z("ZodNever",(e,t)=>{Sl.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>Kd(e,n,o)});function Gf(e){return wd(Jf,e)}const Yf=z("ZodArray",(e,t)=>{El.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>Jd(e,n,o,s),e.element=t.element,e.min=(n,o)=>e.check(uo(n,o)),e.nonempty=n=>e.check(uo(1,n)),e.max=(n,o)=>e.check(Oi(n,o)),e.length=(n,o)=>e.check(Ai(n,o)),e.unwrap=()=>e.element});function nn(e,t){return Pd(Yf,e,t)}const Xf=z("ZodObject",(e,t)=>{Ol.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>Gd(e,n,o,s),Se(e,"shape",()=>t.shape),e.keyof=()=>rn(Object.keys(e._zod.def.shape)),e.catchall=n=>e.clone({...e._zod.def,catchall:n}),e.passthrough=()=>e.clone({...e._zod.def,catchall:As()}),e.loose=()=>e.clone({...e._zod.def,catchall:As()}),e.strict=()=>e.clone({...e._zod.def,catchall:Gf()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=n=>Hc(e,n),e.safeExtend=n=>Wc(e,n),e.merge=n=>Vc(e,n),e.pick=n=>Bc(e,n),e.omit=n=>qc(e,n),e.partial=(...n)=>Jc($i,e,n[0]),e.required=(...n)=>Gc(Fi,e,n[0])});function Ot(e,t){const n={type:"object",shape:e??{},...ue(t)};return new Xf(n)}const Qf=z("ZodUnion",(e,t)=>{Al.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>Yd(e,n,o,s),e.options=t.options});function Oa(e,t){return new Qf({type:"union",options:e,...ue(t)})}const ep=z("ZodIntersection",(e,t)=>{jl.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>Xd(e,n,o,s)});function tp(e,t){return new ep({type:"intersection",left:e,right:t})}const ca=z("ZodEnum",(e,t)=>{Il.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(o,s,c)=>qd(e,o,s),e.enum=t.entries,e.options=Object.values(t.entries);const n=new Set(Object.keys(t.entries));e.extract=(o,s)=>{const c={};for(const d of o)if(n.has(d))c[d]=t.entries[d];else throw new Error(`Key ${d} not found in enum`);return new ca({...t,checks:[],...ue(s),entries:c})},e.exclude=(o,s)=>{const c={...t.entries};for(const d of o)if(n.has(d))delete c[d];else throw new Error(`Key ${d} not found in enum`);return new ca({...t,checks:[],...ue(s),entries:c})}});function rn(e,t){const n=Array.isArray(e)?Object.fromEntries(e.map(o=>[o,o])):e;return new ca({type:"enum",entries:n,...ue(t)})}const np=z("ZodLiteral",(e,t)=>{Dl.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>Hd(e,n,o),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function Li(e,t){return new np({type:"literal",values:Array.isArray(e)?e:[e],...ue(t)})}const rp=z("ZodTransform",(e,t)=>{Nl.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>Vd(e,n),e._zod.parse=(n,o)=>{if(o.direction==="backward")throw new ii(e.constructor.name);n.addIssue=c=>{if(typeof c=="string")n.issues.push(Ar(c,n.value,t));else{const d=c;d.fatal&&(d.continue=!1),d.code??(d.code="custom"),d.input??(d.input=n.value),d.inst??(d.inst=e),n.issues.push(Ar(d))}};const s=t.transform(n.value,n);return s instanceof Promise?s.then(c=>(n.value=c,n)):(n.value=s,n)}});function op(e){return new rp({type:"transform",transform:e})}const $i=z("ZodOptional",(e,t)=>{Ti.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>Ni(e,n,o,s),e.unwrap=()=>e._zod.def.innerType});function js(e){return new $i({type:"optional",innerType:e})}const ap=z("ZodExactOptional",(e,t)=>{Pl.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>Ni(e,n,o,s),e.unwrap=()=>e._zod.def.innerType});function sp(e){return new ap({type:"optional",innerType:e})}const ip=z("ZodNullable",(e,t)=>{Cl.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>Qd(e,n,o,s),e.unwrap=()=>e._zod.def.innerType});function Is(e){return new ip({type:"nullable",innerType:e})}const cp=z("ZodDefault",(e,t)=>{Ml.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>tf(e,n,o,s),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function up(e,t){return new cp({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():di(t)}})}const lp=z("ZodPrefault",(e,t)=>{zl.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>nf(e,n,o,s),e.unwrap=()=>e._zod.def.innerType});function dp(e,t){return new lp({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():di(t)}})}const Fi=z("ZodNonOptional",(e,t)=>{Rl.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>ef(e,n,o,s),e.unwrap=()=>e._zod.def.innerType});function fp(e,t){return new Fi({type:"nonoptional",innerType:e,...ue(t)})}const pp=z("ZodCatch",(e,t)=>{Ll.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>rf(e,n,o,s),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function hp(e,t){return new pp({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const mp=z("ZodPipe",(e,t)=>{$l.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>of(e,n,o,s),e.in=t.in,e.out=t.out});function Ds(e,t){return new mp({type:"pipe",in:e,out:t})}const gp=z("ZodReadonly",(e,t)=>{Fl.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>af(e,n,o,s),e.unwrap=()=>e._zod.def.innerType});function yp(e){return new gp({type:"readonly",innerType:e})}const vp=z("ZodCustom",(e,t)=>{Zl.init(e,t),Le.init(e,t),e._zod.processJSONSchema=(n,o,s)=>Wd(e,n)});function bp(e,t={}){return Cd(vp,e,t)}function _p(e){return Md(e)}/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */const{entries:Zi,setPrototypeOf:Ns,isFrozen:wp,getPrototypeOf:xp,getOwnPropertyDescriptor:kp}=Object;let{freeze:ut,seal:At,create:ua}=Object,{apply:la,construct:da}=typeof Reflect<"u"&&Reflect;ut||(ut=function(t){return t});At||(At=function(t){return t});la||(la=function(t,n){for(var o=arguments.length,s=new Array(o>2?o-2:0),c=2;c<o;c++)s[c-2]=arguments[c];return t.apply(n,s)});da||(da=function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];return new t(...o)});const to=lt(Array.prototype.forEach),Sp=lt(Array.prototype.lastIndexOf),Ps=lt(Array.prototype.pop),yr=lt(Array.prototype.push),Ep=lt(Array.prototype.splice),ro=lt(String.prototype.toLowerCase),Go=lt(String.prototype.toString),Yo=lt(String.prototype.match),vr=lt(String.prototype.replace),Tp=lt(String.prototype.indexOf),Op=lt(String.prototype.trim),Lt=lt(Object.prototype.hasOwnProperty),it=lt(RegExp.prototype.test),br=Ap(TypeError);function lt(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,o=new Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];return la(e,t,o)}}function Ap(e){return function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return da(e,n)}}function pe(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ro;Ns&&Ns(e,null);let o=t.length;for(;o--;){let s=t[o];if(typeof s=="string"){const c=n(s);c!==s&&(wp(t)||(t[o]=c),s=c)}e[s]=!0}return e}function jp(e){for(let t=0;t<e.length;t++)Lt(e,t)||(e[t]=null);return e}function Bt(e){const t=ua(null);for(const[n,o]of Zi(e))Lt(e,n)&&(Array.isArray(o)?t[n]=jp(o):o&&typeof o=="object"&&o.constructor===Object?t[n]=Bt(o):t[n]=o);return t}function _r(e,t){for(;e!==null;){const o=kp(e,t);if(o){if(o.get)return lt(o.get);if(typeof o.value=="function")return lt(o.value)}e=xp(e)}function n(){return null}return n}const Cs=ut(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Xo=ut(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Qo=ut(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Ip=ut(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ea=ut(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Dp=ut(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ms=ut(["#text"]),zs=ut(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ta=ut(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Rs=ut(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),no=ut(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Np=At(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Pp=At(/<%[\w\W]*|[\w\W]*%>/gm),Cp=At(/\$\{[\w\W]*/gm),Mp=At(/^data-[\-\w.\u00B7-\uFFFF]+$/),zp=At(/^aria-[\-\w]+$/),Ki=At(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Rp=At(/^(?:\w+script|data):/i),Lp=At(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ui=At(/^html$/i),$p=At(/^[a-z][.\w]*(-[.\w]+)+$/i);var Ls=Object.freeze({__proto__:null,ARIA_ATTR:zp,ATTR_WHITESPACE:Lp,CUSTOM_ELEMENT:$p,DATA_ATTR:Mp,DOCTYPE_NAME:Ui,ERB_EXPR:Pp,IS_ALLOWED_URI:Ki,IS_SCRIPT_OR_DATA:Rp,MUSTACHE_EXPR:Np,TMPLIT_EXPR:Cp});const wr={element:1,text:3,progressingInstruction:7,comment:8,document:9},Fp=function(){return typeof window>"u"?null:window},Zp=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let o=null;const s="data-tt-policy-suffix";n&&n.hasAttribute(s)&&(o=n.getAttribute(s));const c="dompurify"+(o?"#"+o:"");try{return t.createPolicy(c,{createHTML(d){return d},createScriptURL(d){return d}})}catch{return console.warn("TrustedTypes policy "+c+" could not be created."),null}},$s=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Bi(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fp();const t=ie=>Bi(ie);if(t.version="3.3.1",t.removed=[],!e||!e.document||e.document.nodeType!==wr.document||!e.Element)return t.isSupported=!1,t;let{document:n}=e;const o=n,s=o.currentScript,{DocumentFragment:c,HTMLTemplateElement:d,Node:h,Element:g,NodeFilter:v,NamedNodeMap:I=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:P,DOMParser:$,trustedTypes:C}=e,Y=g.prototype,re=_r(Y,"cloneNode"),D=_r(Y,"remove"),Z=_r(Y,"nextSibling"),L=_r(Y,"childNodes"),W=_r(Y,"parentNode");if(typeof d=="function"){const ie=n.createElement("template");ie.content&&ie.content.ownerDocument&&(n=ie.content.ownerDocument)}let R,q="";const{implementation:ae,createNodeIterator:ce,createDocumentFragment:me,getElementsByTagName:Ee}=n,{importNode:Te}=o;let ye=$s();t.isSupported=typeof Zi=="function"&&typeof W=="function"&&ae&&ae.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:We,ERB_EXPR:Ye,TMPLIT_EXPR:bn,DATA_ATTR:_n,ARIA_ATTR:Jt,IS_SCRIPT_OR_DATA:$n,ATTR_WHITESPACE:mt,CUSTOM_ELEMENT:Dt}=Ls;let{IS_ALLOWED_URI:dt}=Ls,De=null;const ft=pe({},[...Cs,...Xo,...Qo,...ea,...Ms]);let Ze=null;const $t=pe({},[...zs,...ta,...Rs,...no]);let Oe=Object.seal(ua(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),_t=null,ot=null;const gt=Object.seal(ua(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Fn=!0,se=!0,wt=!1,ve=!0,at=!1,on=!0,Xe=!1,wn=!1,X=!1,be=!1,yt=!1,Nt=!1,st=!0,or=!1;const xn="user-content-";let Zn=!0,Pt=!1,qe={},Ve=null;const kn=pe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let an=null;const Kn=pe({},["audio","video","img","source","image","track"]);let sn=null;const Ft=pe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Gt="http://www.w3.org/1998/Math/MathML",cn="http://www.w3.org/2000/svg",Je="http://www.w3.org/1999/xhtml";let oe=Je,Yt=!1,Ct=null;const Un=pe({},[Gt,cn,Je],Go);let G=pe({},["mi","mo","mn","ms","mtext"]),un=pe({},["annotation-xml"]);const Pr=pe({},["title","style","font","a","script"]);let Xt=null;const Cr=["application/xhtml+xml","text/html"],ar="text/html";let Ke=null,ln=null;const dn=n.createElement("form"),Qt=function(_){return _ instanceof RegExp||_ instanceof Function},Sn=function(){let _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ln&&ln===_)){if((!_||typeof _!="object")&&(_={}),_=Bt(_),Xt=Cr.indexOf(_.PARSER_MEDIA_TYPE)===-1?ar:_.PARSER_MEDIA_TYPE,Ke=Xt==="application/xhtml+xml"?Go:ro,De=Lt(_,"ALLOWED_TAGS")?pe({},_.ALLOWED_TAGS,Ke):ft,Ze=Lt(_,"ALLOWED_ATTR")?pe({},_.ALLOWED_ATTR,Ke):$t,Ct=Lt(_,"ALLOWED_NAMESPACES")?pe({},_.ALLOWED_NAMESPACES,Go):Un,sn=Lt(_,"ADD_URI_SAFE_ATTR")?pe(Bt(Ft),_.ADD_URI_SAFE_ATTR,Ke):Ft,an=Lt(_,"ADD_DATA_URI_TAGS")?pe(Bt(Kn),_.ADD_DATA_URI_TAGS,Ke):Kn,Ve=Lt(_,"FORBID_CONTENTS")?pe({},_.FORBID_CONTENTS,Ke):kn,_t=Lt(_,"FORBID_TAGS")?pe({},_.FORBID_TAGS,Ke):Bt({}),ot=Lt(_,"FORBID_ATTR")?pe({},_.FORBID_ATTR,Ke):Bt({}),qe=Lt(_,"USE_PROFILES")?_.USE_PROFILES:!1,Fn=_.ALLOW_ARIA_ATTR!==!1,se=_.ALLOW_DATA_ATTR!==!1,wt=_.ALLOW_UNKNOWN_PROTOCOLS||!1,ve=_.ALLOW_SELF_CLOSE_IN_ATTR!==!1,at=_.SAFE_FOR_TEMPLATES||!1,on=_.SAFE_FOR_XML!==!1,Xe=_.WHOLE_DOCUMENT||!1,be=_.RETURN_DOM||!1,yt=_.RETURN_DOM_FRAGMENT||!1,Nt=_.RETURN_TRUSTED_TYPE||!1,X=_.FORCE_BODY||!1,st=_.SANITIZE_DOM!==!1,or=_.SANITIZE_NAMED_PROPS||!1,Zn=_.KEEP_CONTENT!==!1,Pt=_.IN_PLACE||!1,dt=_.ALLOWED_URI_REGEXP||Ki,oe=_.NAMESPACE||Je,G=_.MATHML_TEXT_INTEGRATION_POINTS||G,un=_.HTML_INTEGRATION_POINTS||un,Oe=_.CUSTOM_ELEMENT_HANDLING||{},_.CUSTOM_ELEMENT_HANDLING&&Qt(_.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Oe.tagNameCheck=_.CUSTOM_ELEMENT_HANDLING.tagNameCheck),_.CUSTOM_ELEMENT_HANDLING&&Qt(_.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Oe.attributeNameCheck=_.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),_.CUSTOM_ELEMENT_HANDLING&&typeof _.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Oe.allowCustomizedBuiltInElements=_.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),at&&(se=!1),yt&&(be=!0),qe&&(De=pe({},Ms),Ze=[],qe.html===!0&&(pe(De,Cs),pe(Ze,zs)),qe.svg===!0&&(pe(De,Xo),pe(Ze,ta),pe(Ze,no)),qe.svgFilters===!0&&(pe(De,Qo),pe(Ze,ta),pe(Ze,no)),qe.mathMl===!0&&(pe(De,ea),pe(Ze,Rs),pe(Ze,no))),_.ADD_TAGS&&(typeof _.ADD_TAGS=="function"?gt.tagCheck=_.ADD_TAGS:(De===ft&&(De=Bt(De)),pe(De,_.ADD_TAGS,Ke))),_.ADD_ATTR&&(typeof _.ADD_ATTR=="function"?gt.attributeCheck=_.ADD_ATTR:(Ze===$t&&(Ze=Bt(Ze)),pe(Ze,_.ADD_ATTR,Ke))),_.ADD_URI_SAFE_ATTR&&pe(sn,_.ADD_URI_SAFE_ATTR,Ke),_.FORBID_CONTENTS&&(Ve===kn&&(Ve=Bt(Ve)),pe(Ve,_.FORBID_CONTENTS,Ke)),_.ADD_FORBID_CONTENTS&&(Ve===kn&&(Ve=Bt(Ve)),pe(Ve,_.ADD_FORBID_CONTENTS,Ke)),Zn&&(De["#text"]=!0),Xe&&pe(De,["html","head","body"]),De.table&&(pe(De,["tbody"]),delete _t.tbody),_.TRUSTED_TYPES_POLICY){if(typeof _.TRUSTED_TYPES_POLICY.createHTML!="function")throw br('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof _.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw br('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');R=_.TRUSTED_TYPES_POLICY,q=R.createHTML("")}else R===void 0&&(R=Zp(C,s)),R!==null&&typeof q=="string"&&(q=R.createHTML(""));ut&&ut(_),ln=_}},En=pe({},[...Xo,...Qo,...Ip]),Ae=pe({},[...ea,...Dp]),He=function(_){let U=W(_);(!U||!U.tagName)&&(U={namespaceURI:oe,tagName:"template"});const H=ro(_.tagName),we=ro(U.tagName);return Ct[_.namespaceURI]?_.namespaceURI===cn?U.namespaceURI===Je?H==="svg":U.namespaceURI===Gt?H==="svg"&&(we==="annotation-xml"||G[we]):!!En[H]:_.namespaceURI===Gt?U.namespaceURI===Je?H==="math":U.namespaceURI===cn?H==="math"&&un[we]:!!Ae[H]:_.namespaceURI===Je?U.namespaceURI===cn&&!un[we]||U.namespaceURI===Gt&&!G[we]?!1:!Ae[H]&&(Pr[H]||!En[H]):!!(Xt==="application/xhtml+xml"&&Ct[_.namespaceURI]):!1},xt=function(_){yr(t.removed,{element:_});try{W(_).removeChild(_)}catch{D(_)}},kt=function(_,U){try{yr(t.removed,{attribute:U.getAttributeNode(_),from:U})}catch{yr(t.removed,{attribute:null,from:U})}if(U.removeAttribute(_),_==="is")if(be||yt)try{xt(U)}catch{}else try{U.setAttribute(_,"")}catch{}},Tn=function(_){let U=null,H=null;if(X)_="<remove></remove>"+_;else{const Me=Yo(_,/^[\r\n\t ]+/);H=Me&&Me[0]}Xt==="application/xhtml+xml"&&oe===Je&&(_='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+_+"</body></html>");const we=R?R.createHTML(_):_;if(oe===Je)try{U=new $().parseFromString(we,Xt)}catch{}if(!U||!U.documentElement){U=ae.createDocument(oe,"template",null);try{U.documentElement.innerHTML=Yt?q:we}catch{}}const je=U.body||U.documentElement;return _&&H&&je.insertBefore(n.createTextNode(H),je.childNodes[0]||null),oe===Je?Ee.call(U,Xe?"html":"body")[0]:Xe?U.documentElement:je},On=function(_){return ce.call(_.ownerDocument||_,_,v.SHOW_ELEMENT|v.SHOW_COMMENT|v.SHOW_TEXT|v.SHOW_PROCESSING_INSTRUCTION|v.SHOW_CDATA_SECTION,null)},sr=function(_){return _ instanceof P&&(typeof _.nodeName!="string"||typeof _.textContent!="string"||typeof _.removeChild!="function"||!(_.attributes instanceof I)||typeof _.removeAttribute!="function"||typeof _.setAttribute!="function"||typeof _.namespaceURI!="string"||typeof _.insertBefore!="function"||typeof _.hasChildNodes!="function")},Mt=function(_){return typeof h=="function"&&_ instanceof h};function tt(ie,_,U){to(ie,H=>{H.call(t,_,U,ln)})}const zt=function(_){let U=null;if(tt(ye.beforeSanitizeElements,_,null),sr(_))return xt(_),!0;const H=Ke(_.nodeName);if(tt(ye.uponSanitizeElement,_,{tagName:H,allowedTags:De}),on&&_.hasChildNodes()&&!Mt(_.firstElementChild)&&it(/<[/\w!]/g,_.innerHTML)&&it(/<[/\w!]/g,_.textContent)||_.nodeType===wr.progressingInstruction||on&&_.nodeType===wr.comment&&it(/<[/\w]/g,_.data))return xt(_),!0;if(!(gt.tagCheck instanceof Function&&gt.tagCheck(H))&&(!De[H]||_t[H])){if(!_t[H]&&Mr(H)&&(Oe.tagNameCheck instanceof RegExp&&it(Oe.tagNameCheck,H)||Oe.tagNameCheck instanceof Function&&Oe.tagNameCheck(H)))return!1;if(Zn&&!Ve[H]){const we=W(_)||_.parentNode,je=L(_)||_.childNodes;if(je&&we){const Me=je.length;for(let Ue=Me-1;Ue>=0;--Ue){const pt=re(je[Ue],!0);pt.__removalCount=(_.__removalCount||0)+1,we.insertBefore(pt,Z(_))}}}return xt(_),!0}return _ instanceof g&&!He(_)||(H==="noscript"||H==="noembed"||H==="noframes")&&it(/<\/no(script|embed|frames)/i,_.innerHTML)?(xt(_),!0):(at&&_.nodeType===wr.text&&(U=_.textContent,to([We,Ye,bn],we=>{U=vr(U,we," ")}),_.textContent!==U&&(yr(t.removed,{element:_.cloneNode()}),_.textContent=U)),tt(ye.afterSanitizeElements,_,null),!1)},An=function(_,U,H){if(st&&(U==="id"||U==="name")&&(H in n||H in dn))return!1;if(!(se&&!ot[U]&&it(_n,U))){if(!(Fn&&it(Jt,U))){if(!(gt.attributeCheck instanceof Function&&gt.attributeCheck(U,_))){if(!Ze[U]||ot[U]){if(!(Mr(_)&&(Oe.tagNameCheck instanceof RegExp&&it(Oe.tagNameCheck,_)||Oe.tagNameCheck instanceof Function&&Oe.tagNameCheck(_))&&(Oe.attributeNameCheck instanceof RegExp&&it(Oe.attributeNameCheck,U)||Oe.attributeNameCheck instanceof Function&&Oe.attributeNameCheck(U,_))||U==="is"&&Oe.allowCustomizedBuiltInElements&&(Oe.tagNameCheck instanceof RegExp&&it(Oe.tagNameCheck,H)||Oe.tagNameCheck instanceof Function&&Oe.tagNameCheck(H))))return!1}else if(!sn[U]){if(!it(dt,vr(H,mt,""))){if(!((U==="src"||U==="xlink:href"||U==="href")&&_!=="script"&&Tp(H,"data:")===0&&an[_])){if(!(wt&&!it($n,vr(H,mt,"")))){if(H)return!1}}}}}}}return!0},Mr=function(_){return _!=="annotation-xml"&&Yo(_,Dt)},Rt=function(_){tt(ye.beforeSanitizeAttributes,_,null);const{attributes:U}=_;if(!U||sr(_))return;const H={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ze,forceKeepAttr:void 0};let we=U.length;for(;we--;){const je=U[we],{name:Me,namespaceURI:Ue,value:pt}=je,Zt=Ke(Me),jn=pt;let Ne=Me==="value"?jn:Op(jn);if(H.attrName=Zt,H.attrValue=Ne,H.keepAttr=!0,H.forceKeepAttr=void 0,tt(ye.uponSanitizeAttribute,_,H),Ne=H.attrValue,or&&(Zt==="id"||Zt==="name")&&(kt(Me,_),Ne=xn+Ne),on&&it(/((--!?|])>)|<\/(style|title|textarea)/i,Ne)){kt(Me,_);continue}if(Zt==="attributename"&&Yo(Ne,"href")){kt(Me,_);continue}if(H.forceKeepAttr)continue;if(!H.keepAttr){kt(Me,_);continue}if(!ve&&it(/\/>/i,Ne)){kt(Me,_);continue}at&&to([We,Ye,bn],In=>{Ne=vr(Ne,In," ")});const ir=Ke(_.nodeName);if(!An(ir,Zt,Ne)){kt(Me,_);continue}if(R&&typeof C=="object"&&typeof C.getAttributeType=="function"&&!Ue)switch(C.getAttributeType(ir,Zt)){case"TrustedHTML":{Ne=R.createHTML(Ne);break}case"TrustedScriptURL":{Ne=R.createScriptURL(Ne);break}}if(Ne!==jn)try{Ue?_.setAttributeNS(Ue,Me,Ne):_.setAttribute(Me,Ne),sr(_)?xt(_):Ps(t.removed)}catch{kt(Me,_)}}tt(ye.afterSanitizeAttributes,_,null)},zr=function ie(_){let U=null;const H=On(_);for(tt(ye.beforeSanitizeShadowDOM,_,null);U=H.nextNode();)tt(ye.uponSanitizeShadowNode,U,null),zt(U),Rt(U),U.content instanceof c&&ie(U.content);tt(ye.afterSanitizeShadowDOM,_,null)};return t.sanitize=function(ie){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},U=null,H=null,we=null,je=null;if(Yt=!ie,Yt&&(ie="<!-->"),typeof ie!="string"&&!Mt(ie))if(typeof ie.toString=="function"){if(ie=ie.toString(),typeof ie!="string")throw br("dirty is not a string, aborting")}else throw br("toString is not a function");if(!t.isSupported)return ie;if(wn||Sn(_),t.removed=[],typeof ie=="string"&&(Pt=!1),Pt){if(ie.nodeName){const pt=Ke(ie.nodeName);if(!De[pt]||_t[pt])throw br("root node is forbidden and cannot be sanitized in-place")}}else if(ie instanceof h)U=Tn("<!---->"),H=U.ownerDocument.importNode(ie,!0),H.nodeType===wr.element&&H.nodeName==="BODY"||H.nodeName==="HTML"?U=H:U.appendChild(H);else{if(!be&&!at&&!Xe&&ie.indexOf("<")===-1)return R&&Nt?R.createHTML(ie):ie;if(U=Tn(ie),!U)return be?null:Nt?q:""}U&&X&&xt(U.firstChild);const Me=On(Pt?ie:U);for(;we=Me.nextNode();)zt(we),Rt(we),we.content instanceof c&&zr(we.content);if(Pt)return ie;if(be){if(yt)for(je=me.call(U.ownerDocument);U.firstChild;)je.appendChild(U.firstChild);else je=U;return(Ze.shadowroot||Ze.shadowrootmode)&&(je=Te.call(o,je,!0)),je}let Ue=Xe?U.outerHTML:U.innerHTML;return Xe&&De["!doctype"]&&U.ownerDocument&&U.ownerDocument.doctype&&U.ownerDocument.doctype.name&&it(Ui,U.ownerDocument.doctype.name)&&(Ue="<!DOCTYPE "+U.ownerDocument.doctype.name+`>
`+Ue),at&&to([We,Ye,bn],pt=>{Ue=vr(Ue,pt," ")}),R&&Nt?R.createHTML(Ue):Ue},t.setConfig=function(){let ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Sn(ie),wn=!0},t.clearConfig=function(){ln=null,wn=!1},t.isValidAttribute=function(ie,_,U){ln||Sn({});const H=Ke(ie),we=Ke(_);return An(H,we,U)},t.addHook=function(ie,_){typeof _=="function"&&yr(ye[ie],_)},t.removeHook=function(ie,_){if(_!==void 0){const U=Sp(ye[ie],_);return U===-1?void 0:Ep(ye[ie],U,1)[0]}return Ps(ye[ie])},t.removeHooks=function(ie){ye[ie]=[]},t.removeAllHooks=function(){ye=$s()},t}var oo=Bi();const hg=Object.freeze(Object.defineProperty({__proto__:null,default:oo},Symbol.toStringTag,{value:"Module"}));let Er;try{Er=typeof window<"u"&&window.document||oo.sanitize?oo:null}catch{Er=null}function Fs(e){return typeof e!="string"?e:Er&&typeof Er.sanitize=="function"?Er.sanitize(e,{ALLOWED_TAGS:[],ALLOWED_ATTR:[]}):e.replace(/<script[\s\S]*?<\/script>/gi,"").replace(/<style[\s\S]*?<\/style>/gi,"").replace(/<[^>]*>/g,"")}function po(e){if(!e||typeof e!="object")return e;const t={};for(const[n,o]of Object.entries(e))typeof o=="string"?t[n]=Fs(o):Array.isArray(o)?t[n]=o.map(s=>typeof s=="string"?Fs(s):typeof s=="object"&&s!==null?po(s):s):typeof o=="object"&&o!==null?t[n]=po(o):t[n]=o;return t}const Kp=rn(["low","medium","high","urgent"]).default("medium"),Up=rn(["available","in_progress","done","blocked"]).default("available"),Bp=rn(["normal","emergency"]).default("normal"),qp=rn(["bug","feature","support","compliance","campaign","internal"]).default("internal"),Hp=rn(["material","approval","resource","dependency","other"]).nullable().optional(),Wp=Ot({id:Oa([de(),Qe()]).optional(),name:de().default(""),quantity:Qe().min(0).default(1),unitPrice:Qe().min(0).default(0),unit_price:Qe().min(0).optional()}).passthrough(),Vp=Ot({id:Oa([de(),Qe()]).optional(),text:de().default(""),done:Ri().default(!1)}).passthrough(),Et=de().nullable().optional().default(""),Jp=Ot({title:de().min(1,"Titulo e obrigatorio"),description:de().optional().default(""),priority:Kp,status:Up,type:Bp,category:qp,blockReason:Hp,client:Et,clientId:Et,location:Et,notes:de().optional().default(""),assignee:Et,assignedTo:Et,estimatedStart:Et,estimatedEnd:Et,actualStart:Et,actualEnd:Et,slaDeadline:Et,leadTimeHours:Qe().nullable().optional(),expenses:nn(Wp).default([]),checklist:nn(Vp).default([]),attachments:nn(fo()).default([]),projectId:Et,parentOrderId:Et,sortOrder:Qe().optional().default(0),emergencyNumber:Qe().nullable().optional()}).passthrough(),Gp=Ot({name:de().min(1,"Nome e obrigatorio"),role:de().optional().default(""),color:de().optional().default("#3b82f6"),email:de().email("Email invalido").optional().or(Li("")).default(""),workStart:de().optional().default("08:00"),workEnd:de().optional().default("18:00"),workDays:nn(Qe()).optional().default([1,2,3,4,5]),salaryMonth:Qe().min(0,"Salario nao pode ser negativo").default(0),hoursMonth:Qe().min(1).default(176)}).passthrough(),Yp=Ot({title:de().min(1,"Titulo e obrigatorio"),description:de().optional().default(""),startDate:de().min(1,"Data de inicio e obrigatoria"),endDate:de().optional().default(""),assignee:de().optional().default(""),type:rn(["meeting","task","reminder","deadline","other"]).default("task"),color:de().optional().default("#3b82f6"),attendees:nn(fo()).default([]),notes:de().optional().default(""),attachments:nn(fo()).default([])}).passthrough();Ot({content:de().min(1,"Comentario nao pode estar vazio"),orderId:de().min(1),userName:de().optional().default("Anonimo")}).passthrough();const Xp=Ot({label:de().min(1,"Nome do setor e obrigatorio"),color:de().optional().default("#3b82f6")}).passthrough(),Qp=Ot({name:de().min(1,"Nome do projeto e obrigatorio"),sectorId:de().optional().default(""),color:de().optional().default("#3b82f6"),description:de().optional().default("")}).passthrough(),eh=Ot({name:de().min(1,"Nome do cliente e obrigatorio"),email:de().email("Email invalido").optional().or(Li("")).default(""),phone:de().optional().default(""),company:de().optional().default(""),notes:de().optional().default("")}).passthrough(),th=Ot({name:de().min(1,"Nome do projeto e obrigatorio"),description:de().optional().default(""),startDate:de().nullable().optional().default(null),endDate:de().nullable().optional().default(null),status:rn(["planning","active","completed","on_hold"]).default("planning"),color:de().optional().default("#3b82f6"),createdBy:de().optional().default("")}).passthrough(),nh=Ot({name:de().min(1,"Nome da tarefa e obrigatorio"),projectId:de().min(1,"Projeto e obrigatorio"),wbsNumber:de().optional().default(""),parentId:de().nullable().optional().default(null),sortOrder:Qe().optional().default(0),level:Qe().optional().default(0),isMilestone:Ri().optional().default(!1),startDate:de().nullable().optional().default(null),endDate:de().nullable().optional().default(null),durationDays:Qe().min(0).optional().default(1),estimatedHours:Qe().nullable().optional().default(null),progress:Qe().min(0).max(100).optional().default(0),assignedTo:de().optional().default(""),predecessors:nn(Ot({taskId:de(),type:rn(["FS","SS","FF","SF"]).default("FS"),lag:Qe().default(0)})).optional().default([]),notes:de().optional().default(""),attachments:nn(fo()).optional().default([]),color:de().optional().default(""),osOrderId:de().nullable().optional().default(null)}).passthrough();function rh(e,t){try{const n=po(t);return{success:!0,data:e.parse(n),error:null}}catch(n){return n instanceof Ci?{success:!1,data:null,error:(n.issues||n.errors||[]).map(s=>s.message).join(", ")}:{success:!1,data:null,error:n.message}}}function oh(e,t){try{const n=po(t),o=new Set(Object.keys(n)),c=e.partial().parse(n),d={};for(const h of Object.keys(c))o.has(h)&&(d[h]=c[h]);return{success:!0,data:d,error:null}}catch(n){return n instanceof Ci?{success:!1,data:null,error:(n.issues||n.errors||[]).map(s=>s.message).join(", ")}:{success:!1,data:null,error:n.message}}}var qi={exports:{}};(function(e,t){((n,o)=>{e.exports=o()})(as,function(){var n=function(r,a){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(i,u){i.__proto__=u}:function(i,u){for(var l in u)Object.prototype.hasOwnProperty.call(u,l)&&(i[l]=u[l])}))(r,a)},o=function(){return(o=Object.assign||function(r){for(var a,i=1,u=arguments.length;i<u;i++)for(var l in a=arguments[i])Object.prototype.hasOwnProperty.call(a,l)&&(r[l]=a[l]);return r}).apply(this,arguments)};function s(r,a,i){for(var u,l=0,f=a.length;l<f;l++)!u&&l in a||((u=u||Array.prototype.slice.call(a,0,l))[l]=a[l]);return r.concat(u||Array.prototype.slice.call(a))}var c=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:as,d=Object.keys,h=Array.isArray;function g(r,a){return typeof a=="object"&&d(a).forEach(function(i){r[i]=a[i]}),r}typeof Promise>"u"||c.Promise||(c.Promise=Promise);var v=Object.getPrototypeOf,I={}.hasOwnProperty;function P(r,a){return I.call(r,a)}function $(r,a){typeof a=="function"&&(a=a(v(r))),(typeof Reflect>"u"?d:Reflect.ownKeys)(a).forEach(function(i){Y(r,i,a[i])})}var C=Object.defineProperty;function Y(r,a,i,u){C(r,a,g(i&&P(i,"get")&&typeof i.get=="function"?{get:i.get,set:i.set,configurable:!0}:{value:i,configurable:!0,writable:!0},u))}function re(r){return{from:function(a){return r.prototype=Object.create(a.prototype),Y(r.prototype,"constructor",r),{extend:$.bind(null,r.prototype)}}}}var D=Object.getOwnPropertyDescriptor,Z=[].slice;function L(r,a,i){return Z.call(r,a,i)}function W(r,a){return a(r)}function R(r){if(!r)throw new Error("Assertion Failed")}function q(r){c.setImmediate?setImmediate(r):setTimeout(r,0)}function ae(r,a){if(typeof a=="string"&&P(r,a))return r[a];if(!a)return r;if(typeof a!="string"){for(var i=[],u=0,l=a.length;u<l;++u){var f=ae(r,a[u]);i.push(f)}return i}var p,m=a.indexOf(".");return m===-1||(p=r[a.substr(0,m)])==null?void 0:ae(p,a.substr(m+1))}function ce(r,a,i){if(r&&a!==void 0&&!("isFrozen"in Object&&Object.isFrozen(r)))if(typeof a!="string"&&"length"in a){R(typeof i!="string"&&"length"in i);for(var u=0,l=a.length;u<l;++u)ce(r,a[u],i[u])}else{var f,p,m=a.indexOf(".");m!==-1?(f=a.substr(0,m),(m=a.substr(m+1))===""?i===void 0?h(r)&&!isNaN(parseInt(f))?r.splice(f,1):delete r[f]:r[f]=i:ce(p=(p=r[f])&&P(r,f)?p:r[f]={},m,i)):i===void 0?h(r)&&!isNaN(parseInt(a))?r.splice(a,1):delete r[a]:r[a]=i}}function me(r){var a,i={};for(a in r)P(r,a)&&(i[a]=r[a]);return i}var Ee=[].concat;function Te(r){return Ee.apply([],r)}var ft="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Te([8,16,32,64].map(function(r){return["Int","Uint","Float"].map(function(a){return a+r+"Array"})}))).filter(function(r){return c[r]}),ye=new Set(ft.map(function(r){return c[r]})),We=null;function Ye(r){return We=new WeakMap,r=function a(i){if(!i||typeof i!="object")return i;var u=We.get(i);if(u)return u;if(h(i)){u=[],We.set(i,u);for(var l=0,f=i.length;l<f;++l)u.push(a(i[l]))}else if(ye.has(i.constructor))u=i;else{var p,m=v(i);for(p in u=m===Object.prototype?{}:Object.create(m),We.set(i,u),i)P(i,p)&&(u[p]=a(i[p]))}return u}(r),We=null,r}var bn={}.toString;function _n(r){return bn.call(r).slice(8,-1)}var Jt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",$n=typeof Jt=="symbol"?function(r){var a;return r!=null&&(a=r[Jt])&&a.apply(r)}:function(){return null};function mt(r,a){a=r.indexOf(a),0<=a&&r.splice(a,1)}var Dt={};function dt(r){var a,i,u,l;if(arguments.length===1){if(h(r))return r.slice();if(this===Dt&&typeof r=="string")return[r];if(l=$n(r))for(i=[];!(u=l.next()).done;)i.push(u.value);else{if(r==null)return[r];if(typeof(a=r.length)!="number")return[r];for(i=new Array(a);a--;)i[a]=r[a]}}else for(a=arguments.length,i=new Array(a);a--;)i[a]=arguments[a];return i}var De=typeof Symbol<"u"?function(r){return r[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ft=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],qe=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ft),Ze={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function $t(r,a){this.name=r,this.message=a}function Oe(r,a){return r+". Errors: "+Object.keys(a).map(function(i){return a[i].toString()}).filter(function(i,u,l){return l.indexOf(i)===u}).join(`
`)}function _t(r,a,i,u){this.failures=a,this.failedKeys=u,this.successCount=i,this.message=Oe(r,a)}function ot(r,a){this.name="BulkError",this.failures=Object.keys(a).map(function(i){return a[i]}),this.failuresByPos=a,this.message=Oe(r,this.failures)}re($t).from(Error).extend({toString:function(){return this.name+": "+this.message}}),re(_t).from($t),re(ot).from($t);var gt=qe.reduce(function(r,a){return r[a]=a+"Error",r},{}),Fn=$t,se=qe.reduce(function(r,a){var i=a+"Error";function u(l,f){this.name=i,l?typeof l=="string"?(this.message="".concat(l).concat(f?`
 `+f:""),this.inner=f||null):typeof l=="object"&&(this.message="".concat(l.name," ").concat(l.message),this.inner=l):(this.message=Ze[a]||i,this.inner=null)}return re(u).from(Fn),r[a]=u,r},{}),wt=(se.Syntax=SyntaxError,se.Type=TypeError,se.Range=RangeError,ft.reduce(function(r,a){return r[a+"Error"]=se[a],r},{}));ft=qe.reduce(function(r,a){return["Syntax","Type","Range"].indexOf(a)===-1&&(r[a+"Error"]=se[a]),r},{});function ve(){}function at(r){return r}function on(r,a){return r==null||r===at?a:function(i){return a(r(i))}}function Xe(r,a){return function(){r.apply(this,arguments),a.apply(this,arguments)}}function wn(r,a){return r===ve?a:function(){var i=r.apply(this,arguments),u=(i!==void 0&&(arguments[0]=i),this.onsuccess),l=this.onerror,f=(this.onsuccess=null,this.onerror=null,a.apply(this,arguments));return u&&(this.onsuccess=this.onsuccess?Xe(u,this.onsuccess):u),l&&(this.onerror=this.onerror?Xe(l,this.onerror):l),f!==void 0?f:i}}function X(r,a){return r===ve?a:function(){r.apply(this,arguments);var i=this.onsuccess,u=this.onerror;this.onsuccess=this.onerror=null,a.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?Xe(i,this.onsuccess):i),u&&(this.onerror=this.onerror?Xe(u,this.onerror):u)}}function be(r,a){return r===ve?a:function(l){var u=r.apply(this,arguments),l=(g(l,u),this.onsuccess),f=this.onerror,p=(this.onsuccess=null,this.onerror=null,a.apply(this,arguments));return l&&(this.onsuccess=this.onsuccess?Xe(l,this.onsuccess):l),f&&(this.onerror=this.onerror?Xe(f,this.onerror):f),u===void 0?p===void 0?void 0:p:g(u,p)}}function yt(r,a){return r===ve?a:function(){return a.apply(this,arguments)!==!1&&r.apply(this,arguments)}}function Nt(r,a){return r===ve?a:function(){var i=r.apply(this,arguments);if(i&&typeof i.then=="function"){for(var u=this,l=arguments.length,f=new Array(l);l--;)f[l]=arguments[l];return i.then(function(){return a.apply(u,f)})}return a.apply(this,arguments)}}ft.ModifyError=_t,ft.DexieError=$t,ft.BulkError=ot;var st=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function or(r){st=r}var xn={},Zn=100,Pt=typeof Promise>"u"?[]:(qe=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[Pt=crypto.subtle.digest("SHA-512",new Uint8Array([0])),v(Pt),qe]:[qe,v(qe),qe]),qe=Pt[0],Wn=Pt[1],Wn=Wn&&Wn.then,Ve=qe&&qe.constructor,kn=!!Pt[2],an=function(r,a){Yt.push([r,a]),sn&&(queueMicrotask(ln),sn=!1)},Kn=!0,sn=!0,Ft=[],Gt=[],cn=at,Je={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ve,pgp:!1,env:{},finalize:ve},oe=Je,Yt=[],Ct=0,Un=[];function G(r){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var a=this._PSD=oe;if(typeof r!="function"){if(r!==xn)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Xt(this,this._value)}else this._state=null,this._value=null,++a.ref,function i(u,l){try{l(function(f){if(u._state===null){if(f===u)throw new TypeError("A promise cannot be resolved with itself.");var p=u._lib&&dn();f&&typeof f.then=="function"?i(u,function(m,x){f instanceof G?f._then(m,x):f.then(m,x)}):(u._state=!0,u._value=f,Cr(u)),p&&Qt()}},Xt.bind(null,u))}catch(f){Xt(u,f)}}(this,r)}var un={get:function(){var r=oe,a=On;function i(u,l){var f=this,p=!r.global&&(r!==oe||a!==On),m=p&&!zt(),x=new G(function(A,k){ar(f,new Pr(_(u,r,p,m),_(l,r,p,m),A,k,r))});return this._consoleTask&&(x._consoleTask=this._consoleTask),x}return i.prototype=xn,i},set:function(r){Y(this,"then",r&&r.prototype===xn?un:{get:function(){return r},set:un.set})}};function Pr(r,a,i,u,l){this.onFulfilled=typeof r=="function"?r:null,this.onRejected=typeof a=="function"?a:null,this.resolve=i,this.reject=u,this.psd=l}function Xt(r,a){var i,u;Gt.push(a),r._state===null&&(i=r._lib&&dn(),a=cn(a),r._state=!1,r._value=a,u=r,Ft.some(function(l){return l._value===u._value})||Ft.push(u),Cr(r),i)&&Qt()}function Cr(r){var a=r._listeners;r._listeners=[];for(var i=0,u=a.length;i<u;++i)ar(r,a[i]);var l=r._PSD;--l.ref||l.finalize(),Ct===0&&(++Ct,an(function(){--Ct==0&&Sn()},[]))}function ar(r,a){if(r._state===null)r._listeners.push(a);else{var i=r._state?a.onFulfilled:a.onRejected;if(i===null)return(r._state?a.resolve:a.reject)(r._value);++a.psd.ref,++Ct,an(Ke,[i,r,a])}}function Ke(r,a,i){try{var u,l=a._value;!a._state&&Gt.length&&(Gt=[]),u=st&&a._consoleTask?a._consoleTask.run(function(){return r(l)}):r(l),a._state||Gt.indexOf(l)!==-1||(f=>{for(var p=Ft.length;p;)if(Ft[--p]._value===f._value)return Ft.splice(p,1)})(a),i.resolve(u)}catch(f){i.reject(f)}finally{--Ct==0&&Sn(),--i.psd.ref||i.psd.finalize()}}function ln(){ie(Je,function(){dn()&&Qt()})}function dn(){var r=Kn;return sn=Kn=!1,r}function Qt(){var r,a,i;do for(;0<Yt.length;)for(r=Yt,Yt=[],i=r.length,a=0;a<i;++a){var u=r[a];u[0].apply(null,u[1])}while(0<Yt.length);sn=Kn=!0}function Sn(){for(var r=Ft,a=(Ft=[],r.forEach(function(u){u._PSD.onunhandled.call(null,u._value,u)}),Un.slice(0)),i=a.length;i;)a[--i]()}function En(r){return new G(xn,!1,r)}function Ae(r,a){var i=oe;return function(){var u=dn(),l=oe;try{return Rt(i,!0),r.apply(this,arguments)}catch(f){a&&a(f)}finally{Rt(l,!1),u&&Qt()}}}$(G.prototype,{then:un,_then:function(r,a){ar(this,new Pr(null,null,r,a,oe))},catch:function(r){var a,i;return arguments.length===1?this.then(null,r):(a=r,i=arguments[1],typeof a=="function"?this.then(null,function(u){return(u instanceof a?i:En)(u)}):this.then(null,function(u){return(u&&u.name===a?i:En)(u)}))},finally:function(r){return this.then(function(a){return G.resolve(r()).then(function(){return a})},function(a){return G.resolve(r()).then(function(){return En(a)})})},timeout:function(r,a){var i=this;return r<1/0?new G(function(u,l){var f=setTimeout(function(){return l(new se.Timeout(a))},r);i.then(u,l).finally(clearTimeout.bind(null,f))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Y(G.prototype,Symbol.toStringTag,"Dexie.Promise"),Je.env=zr(),$(G,{all:function(){var r=dt.apply(null,arguments).map(An);return new G(function(a,i){r.length===0&&a([]);var u=r.length;r.forEach(function(l,f){return G.resolve(l).then(function(p){r[f]=p,--u||a(r)},i)})})},resolve:function(r){return r instanceof G?r:r&&typeof r.then=="function"?new G(function(a,i){r.then(a,i)}):new G(xn,!0,r)},reject:En,race:function(){var r=dt.apply(null,arguments).map(An);return new G(function(a,i){r.map(function(u){return G.resolve(u).then(a,i)})})},PSD:{get:function(){return oe},set:function(r){return oe=r}},totalEchoes:{get:function(){return On}},newPSD:Mt,usePSD:ie,scheduler:{get:function(){return an},set:function(r){an=r}},rejectionMapper:{get:function(){return cn},set:function(r){cn=r}},follow:function(r,a){return new G(function(i,u){return Mt(function(l,f){var p=oe;p.unhandleds=[],p.onunhandled=f,p.finalize=Xe(function(){var m,x=this;m=function(){x.unhandleds.length===0?l():f(x.unhandleds[0])},Un.push(function A(){m(),Un.splice(Un.indexOf(A),1)}),++Ct,an(function(){--Ct==0&&Sn()},[])},p.finalize),r()},a,i,u)})}}),Ve&&(Ve.allSettled&&Y(G,"allSettled",function(){var r=dt.apply(null,arguments).map(An);return new G(function(a){r.length===0&&a([]);var i=r.length,u=new Array(i);r.forEach(function(l,f){return G.resolve(l).then(function(p){return u[f]={status:"fulfilled",value:p}},function(p){return u[f]={status:"rejected",reason:p}}).then(function(){return--i||a(u)})})})}),Ve.any&&typeof AggregateError<"u"&&Y(G,"any",function(){var r=dt.apply(null,arguments).map(An);return new G(function(a,i){r.length===0&&i(new AggregateError([]));var u=r.length,l=new Array(u);r.forEach(function(f,p){return G.resolve(f).then(function(m){return a(m)},function(m){l[p]=m,--u||i(new AggregateError(l))})})})}),Ve.withResolvers)&&(G.withResolvers=Ve.withResolvers);var He={awaits:0,echoes:0,id:0},xt=0,kt=[],Tn=0,On=0,sr=0;function Mt(r,p,i,u){var l=oe,f=Object.create(l),p=(f.parent=l,f.ref=0,f.global=!1,f.id=++sr,Je.env,f.env=kn?{Promise:G,PromiseProp:{value:G,configurable:!0,writable:!0},all:G.all,race:G.race,allSettled:G.allSettled,any:G.any,resolve:G.resolve,reject:G.reject}:{},p&&g(f,p),++l.ref,f.finalize=function(){--this.parent.ref||this.parent.finalize()},ie(f,r,i,u));return f.ref===0&&f.finalize(),p}function tt(){return He.id||(He.id=++xt),++He.awaits,He.echoes+=Zn,He.id}function zt(){return!!He.awaits&&(--He.awaits==0&&(He.id=0),He.echoes=He.awaits*Zn,!0)}function An(r){return He.echoes&&r&&r.constructor===Ve?(tt(),r.then(function(a){return zt(),a},function(a){return zt(),H(a)})):r}function Mr(){var r=kt[kt.length-1];kt.pop(),Rt(r,!1)}function Rt(r,a){var i,u,l=oe;(a?!He.echoes||Tn++&&r===oe:!Tn||--Tn&&r===oe)||queueMicrotask(a?(function(f){++On,He.echoes&&--He.echoes!=0||(He.echoes=He.awaits=He.id=0),kt.push(oe),Rt(f,!0)}).bind(null,r):Mr),r!==oe&&(oe=r,l===Je&&(Je.env=zr()),kn)&&(i=Je.env.Promise,u=r.env,l.global||r.global)&&(Object.defineProperty(c,"Promise",u.PromiseProp),i.all=u.all,i.race=u.race,i.resolve=u.resolve,i.reject=u.reject,u.allSettled&&(i.allSettled=u.allSettled),u.any)&&(i.any=u.any)}function zr(){var r=c.Promise;return kn?{Promise:r,PromiseProp:Object.getOwnPropertyDescriptor(c,"Promise"),all:r.all,race:r.race,allSettled:r.allSettled,any:r.any,resolve:r.resolve,reject:r.reject}:{}}function ie(r,a,i,u,l){var f=oe;try{return Rt(r,!0),a(i,u,l)}finally{Rt(f,!1)}}function _(r,a,i,u){return typeof r!="function"?r:function(){var l=oe;i&&tt(),Rt(a,!0);try{return r.apply(this,arguments)}finally{Rt(l,!1),u&&queueMicrotask(zt)}}}function U(r){Promise===Ve&&He.echoes===0?Tn===0?r():enqueueNativeMicroTask(r):setTimeout(r,0)}(""+Wn).indexOf("[native code]")===-1&&(tt=zt=ve);var H=G.reject,we="",je="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Me="String expected.",Ue=[],pt="__dbnames",Zt="readonly",jn="readwrite";function Ne(r,a){return r?a?function(){return r.apply(this,arguments)&&a.apply(this,arguments)}:r:a}var ir={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function In(r){return typeof r!="string"||/\./.test(r)?function(a){return a}:function(a){return a[r]===void 0&&r in a&&delete(a=Ye(a))[r],a}}function Na(){throw se.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function ge(r,a){try{var i=Pa(r),u=Pa(a);if(i!==u)return i==="Array"?1:u==="Array"?-1:i==="binary"?1:u==="binary"?-1:i==="string"?1:u==="string"?-1:i==="Date"?1:u!=="Date"?NaN:-1;switch(i){case"number":case"Date":case"string":return a<r?1:r<a?-1:0;case"binary":for(var l=Ca(r),f=Ca(a),p=l.length,m=f.length,x=p<m?p:m,A=0;A<x;++A)if(l[A]!==f[A])return l[A]<f[A]?-1:1;return p===m?0:p<m?-1:1;case"Array":for(var k=r,b=a,E=k.length,T=b.length,S=E<T?E:T,w=0;w<S;++w){var j=ge(k[w],b[w]);if(j!==0)return j}return E===T?0:E<T?-1:1}}catch{}return NaN}function Pa(r){var a=typeof r;return a=="object"&&(ArrayBuffer.isView(r)||(a=_n(r))==="ArrayBuffer")?"binary":a}function Ca(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r)}function Rr(r,a,i){var u=r.schema.yProps;return u?(a&&0<i.numFailures&&(a=a.filter(function(l,f){return!i.failures[f]})),Promise.all(u.map(function(l){return l=l.updatesTable,a?r.db.table(l).where("k").anyOf(a).delete():r.db.table(l).clear()})).then(function(){return i})):i}Ma.prototype.execute=function(r){var a=this["@@propmod"];if(a.add!==void 0){var i=a.add;if(h(i))return s(s([],h(r)?r:[],!0),i).sort();if(typeof i=="number")return(Number(r)||0)+i;if(typeof i=="bigint")try{return BigInt(r)+i}catch{return BigInt(0)+i}throw new TypeError("Invalid term ".concat(i))}if(a.remove!==void 0){var u=a.remove;if(h(u))return h(r)?r.filter(function(l){return!u.includes(l)}).sort():[];if(typeof u=="number")return Number(r)-u;if(typeof u=="bigint")try{return BigInt(r)-u}catch{return BigInt(0)-u}throw new TypeError("Invalid subtrahend ".concat(u))}return i=(i=a.replacePrefix)==null?void 0:i[0],i&&typeof r=="string"&&r.startsWith(i)?a.replacePrefix[1]+r.substring(i.length):r};var cr=Ma;function Ma(r){this["@@propmod"]=r}function za(r,a){for(var i=d(a),u=i.length,l=!1,f=0;f<u;++f){var p=i[f],m=a[p],x=ae(r,p);m instanceof cr?(ce(r,p,m.execute(x)),l=!0):x!==m&&(ce(r,p,m),l=!0)}return l}Ie.prototype._trans=function(r,a,i){var u=this._tx||oe.trans,l=this.name,f=st&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(r==="readonly"?"read":"write"," ").concat(this.name));function p(A,k,b){if(b.schema[l])return a(b.idbtrans,b);throw new se.NotFound("Table "+l+" not part of transaction")}var m=dn();try{var x=u&&u.db._novip===this.db._novip?u===oe.trans?u._promise(r,p,i):Mt(function(){return u._promise(r,p,i)},{trans:u,transless:oe.transless||oe}):function A(k,b,E,T){if(k.idbdb&&(k._state.openComplete||oe.letThrough||k._vip)){var S=k._createTransaction(b,E,k._dbSchema);try{S.create(),k._state.PR1398_maxLoop=3}catch(w){return w.name===gt.InvalidState&&k.isOpen()&&0<--k._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),k.close({disableAutoOpen:!1}),k.open().then(function(){return A(k,b,E,T)})):H(w)}return S._promise(b,function(w,j){return Mt(function(){return oe.trans=S,T(w,j,S)})}).then(function(w){if(b==="readwrite")try{S.idbtrans.commit()}catch{}return b==="readonly"?w:S._completion.then(function(){return w})})}if(k._state.openComplete)return H(new se.DatabaseClosed(k._state.dbOpenError));if(!k._state.isBeingOpened){if(!k._state.autoOpen)return H(new se.DatabaseClosed);k.open().catch(ve)}return k._state.dbReadyPromise.then(function(){return A(k,b,E,T)})}(this.db,r,[this.name],p);return f&&(x._consoleTask=f,x=x.catch(function(A){return console.trace(A),H(A)})),x}finally{m&&Qt()}},Ie.prototype.get=function(r,a){var i=this;return r&&r.constructor===Object?this.where(r).first(a):r==null?H(new se.Type("Invalid argument to Table.get()")):this._trans("readonly",function(u){return i.core.get({trans:u,key:r}).then(function(l){return i.hook.reading.fire(l)})}).then(a)},Ie.prototype.where=function(r){if(typeof r=="string")return new this.db.WhereClause(this,r);if(h(r))return new this.db.WhereClause(this,"[".concat(r.join("+"),"]"));var a=d(r);if(a.length===1)return this.where(a[0]).equals(r[a[0]]);var i=this.schema.indexes.concat(this.schema.primKey).filter(function(m){if(m.compound&&a.every(function(A){return 0<=m.keyPath.indexOf(A)})){for(var x=0;x<a.length;++x)if(a.indexOf(m.keyPath[x])===-1)return!1;return!0}return!1}).sort(function(m,x){return m.keyPath.length-x.keyPath.length})[0];if(i&&this.db._maxKey!==we)return p=i.keyPath.slice(0,a.length),this.where(p).equals(p.map(function(m){return r[m]}));!i&&st&&console.warn("The query ".concat(JSON.stringify(r)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(a.join("+"),"]"));var u=this.schema.idxByName;function l(m,x){return ge(m,x)===0}var p=a.reduce(function(k,x){var A=k[0],k=k[1],b=u[x],E=r[x];return[A||b,A||!b?Ne(k,b&&b.multi?function(T){return T=ae(T,x),h(T)&&T.some(function(S){return l(E,S)})}:function(T){return l(E,ae(T,x))}):k]},[null,null]),f=p[0],p=p[1];return f?this.where(f.name).equals(r[f.keyPath]).filter(p):i?this.filter(p):this.where(a).equals("")},Ie.prototype.filter=function(r){return this.toCollection().and(r)},Ie.prototype.count=function(r){return this.toCollection().count(r)},Ie.prototype.offset=function(r){return this.toCollection().offset(r)},Ie.prototype.limit=function(r){return this.toCollection().limit(r)},Ie.prototype.each=function(r){return this.toCollection().each(r)},Ie.prototype.toArray=function(r){return this.toCollection().toArray(r)},Ie.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ie.prototype.orderBy=function(r){return new this.db.Collection(new this.db.WhereClause(this,h(r)?"[".concat(r.join("+"),"]"):r))},Ie.prototype.reverse=function(){return this.toCollection().reverse()},Ie.prototype.mapToClass=function(r){for(var a=this.db,i=this.name,u=((this.schema.mappedClass=r).prototype instanceof Na&&(r=(p=>{var m=k,x=p;if(typeof x!="function"&&x!==null)throw new TypeError("Class extends value "+String(x)+" is not a constructor or null");function A(){this.constructor=m}function k(){return p!==null&&p.apply(this,arguments)||this}return n(m,x),m.prototype=x===null?Object.create(x):(A.prototype=x.prototype,new A),Object.defineProperty(k.prototype,"db",{get:function(){return a},enumerable:!1,configurable:!0}),k.prototype.table=function(){return i},k})(r)),new Set),l=r.prototype;l;l=v(l))Object.getOwnPropertyNames(l).forEach(function(p){return u.add(p)});function f(p){if(!p)return p;var m,x=Object.create(r.prototype);for(m in p)if(!u.has(m))try{x[m]=p[m]}catch{}return x}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=f,this.hook("reading",f),r},Ie.prototype.defineClass=function(){return this.mapToClass(function(r){g(this,r)})},Ie.prototype.add=function(r,a){var i=this,u=this.schema.primKey,l=u.auto,f=u.keyPath,p=r;return f&&l&&(p=In(f)(r)),this._trans("readwrite",function(m){return i.core.mutate({trans:m,type:"add",keys:a!=null?[a]:null,values:[p]})}).then(function(m){return m.numFailures?G.reject(m.failures[0]):m.lastResult}).then(function(m){if(f)try{ce(r,f,m)}catch{}return m})},Ie.prototype.upsert=function(r,a){var i=this,u=this.schema.primKey.keyPath;return this._trans("readwrite",function(l){return i.core.get({trans:l,key:r}).then(function(f){var p=f??{};return za(p,a),u&&ce(p,u,r),i.core.mutate({trans:l,type:"put",values:[p],keys:[r],upsert:!0,updates:{keys:[r],changeSpecs:[a]}}).then(function(m){return m.numFailures?G.reject(m.failures[0]):!!f})})})},Ie.prototype.update=function(r,a){return typeof r!="object"||h(r)?this.where(":id").equals(r).modify(a):(r=ae(r,this.schema.primKey.keyPath))===void 0?H(new se.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(a)},Ie.prototype.put=function(r,a){var i=this,u=this.schema.primKey,l=u.auto,f=u.keyPath,p=r;return f&&l&&(p=In(f)(r)),this._trans("readwrite",function(m){return i.core.mutate({trans:m,type:"put",values:[p],keys:a!=null?[a]:null})}).then(function(m){return m.numFailures?G.reject(m.failures[0]):m.lastResult}).then(function(m){if(f)try{ce(r,f,m)}catch{}return m})},Ie.prototype.delete=function(r){var a=this;return this._trans("readwrite",function(i){return a.core.mutate({trans:i,type:"delete",keys:[r]}).then(function(u){return Rr(a,[r],u)}).then(function(u){return u.numFailures?G.reject(u.failures[0]):void 0})})},Ie.prototype.clear=function(){var r=this;return this._trans("readwrite",function(a){return r.core.mutate({trans:a,type:"deleteRange",range:ir}).then(function(i){return Rr(r,null,i)})}).then(function(a){return a.numFailures?G.reject(a.failures[0]):void 0})},Ie.prototype.bulkGet=function(r){var a=this;return this._trans("readonly",function(i){return a.core.getMany({keys:r,trans:i}).then(function(u){return u.map(function(l){return a.hook.reading.fire(l)})})})},Ie.prototype.bulkAdd=function(r,a,i){var u=this,l=Array.isArray(a)?a:void 0,f=(i=i||(l?void 0:a))?i.allKeys:void 0;return this._trans("readwrite",function(p){var m=u.schema.primKey,A=m.auto,m=m.keyPath;if(m&&l)throw new se.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(l&&l.length!==r.length)throw new se.InvalidArgument("Arguments objects and keys must have the same length");var x=r.length,A=m&&A?r.map(In(m)):r;return u.core.mutate({trans:p,type:"add",keys:l,values:A,wantResults:f}).then(function(k){var b=k.numFailures,E=k.failures;if(b===0)return f?k.results:k.lastResult;throw new ot("".concat(u.name,".bulkAdd(): ").concat(b," of ").concat(x," operations failed"),E)})})},Ie.prototype.bulkPut=function(r,a,i){var u=this,l=Array.isArray(a)?a:void 0,f=(i=i||(l?void 0:a))?i.allKeys:void 0;return this._trans("readwrite",function(p){var m=u.schema.primKey,A=m.auto,m=m.keyPath;if(m&&l)throw new se.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(l&&l.length!==r.length)throw new se.InvalidArgument("Arguments objects and keys must have the same length");var x=r.length,A=m&&A?r.map(In(m)):r;return u.core.mutate({trans:p,type:"put",keys:l,values:A,wantResults:f}).then(function(k){var b=k.numFailures,E=k.failures;if(b===0)return f?k.results:k.lastResult;throw new ot("".concat(u.name,".bulkPut(): ").concat(b," of ").concat(x," operations failed"),E)})})},Ie.prototype.bulkUpdate=function(r){var a=this,i=this.core,u=r.map(function(p){return p.key}),l=r.map(function(p){return p.changes}),f=[];return this._trans("readwrite",function(p){return i.getMany({trans:p,keys:u,cache:"clone"}).then(function(m){var x=[],A=[],k=(r.forEach(function(b,E){var T=b.key,S=b.changes,w=m[E];if(w){for(var j=0,N=Object.keys(S);j<N.length;j++){var O=N[j],M=S[O];if(O===a.schema.primKey.keyPath){if(ge(M,T)!==0)throw new se.Constraint("Cannot update primary key in bulkUpdate()")}else ce(w,O,M)}f.push(E),x.push(T),A.push(w)}}),x.length);return i.mutate({trans:p,type:"put",keys:x,values:A,updates:{keys:u,changeSpecs:l}}).then(function(b){var E=b.numFailures,T=b.failures;if(E===0)return k;for(var S=0,w=Object.keys(T);S<w.length;S++){var j,N=w[S],O=f[Number(N)];O!=null&&(j=T[N],delete T[N],T[O]=j)}throw new ot("".concat(a.name,".bulkUpdate(): ").concat(E," of ").concat(k," operations failed"),T)})})})},Ie.prototype.bulkDelete=function(r){var a=this,i=r.length;return this._trans("readwrite",function(u){return a.core.mutate({trans:u,type:"delete",keys:r}).then(function(l){return Rr(a,r,l)})}).then(function(u){var l=u.numFailures,f=u.failures;if(l===0)return u.lastResult;throw new ot("".concat(a.name,".bulkDelete(): ").concat(l," of ").concat(i," operations failed"),f)})};var Ra=Ie;function Ie(){}function ur(r){function a(p,m){if(m){for(var x=arguments.length,A=new Array(x-1);--x;)A[x-1]=arguments[x];return i[p].subscribe.apply(null,A),r}if(typeof p=="string")return i[p]}var i={};a.addEventType=f;for(var u=1,l=arguments.length;u<l;++u)f(arguments[u]);return a;function f(p,m,x){var A,k;if(typeof p!="object")return m=m||yt,k={subscribers:[],fire:x=x||ve,subscribe:function(b){k.subscribers.indexOf(b)===-1&&(k.subscribers.push(b),k.fire=m(k.fire,b))},unsubscribe:function(b){k.subscribers=k.subscribers.filter(function(E){return E!==b}),k.fire=k.subscribers.reduce(m,x)}},i[p]=a[p]=k;d(A=p).forEach(function(b){var E=A[b];if(h(E))f(b,A[b][0],A[b][1]);else{if(E!=="asap")throw new se.InvalidArgument("Invalid event config");var T=f(b,at,function(){for(var S=arguments.length,w=new Array(S);S--;)w[S]=arguments[S];T.subscribers.forEach(function(j){q(function(){j.apply(null,w)})})})}})}}function lr(r,a){return re(a).from({prototype:r}),a}function Bn(r,a){return!(r.filter||r.algorithm||r.or)&&(a?r.justLimit:!r.replayFilter)}function ko(r,a){r.filter=Ne(r.filter,a)}function So(r,a,i){var u=r.replayFilter;r.replayFilter=u?function(){return Ne(u(),a())}:a,r.justLimit=i&&!u}function Lr(r,a){if(r.isPrimKey)return a.primaryKey;var i=a.getIndexByKeyPath(r.index);if(i)return i;throw new se.Schema("KeyPath "+r.index+" on object store "+a.name+" is not indexed")}function La(r,a,i){var u=Lr(r,a.schema);return a.openCursor({trans:i,values:!r.keysOnly,reverse:r.dir==="prev",unique:!!r.unique,query:{index:u,range:r.range}})}function $r(r,a,i,u){var l,f,p=r.replayFilter?Ne(r.filter,r.replayFilter()):r.filter;return r.or?(l={},f=function(m,x,A){var k,b;p&&!p(x,A,function(E){return x.stop(E)},function(E){return x.fail(E)})||((b=""+(k=x.primaryKey))=="[object ArrayBuffer]"&&(b=""+new Uint8Array(k)),P(l,b))||(l[b]=!0,a(m,x,A))},Promise.all([r.or._iterate(f,i),$a(La(r,u,i),r.algorithm,f,!r.keysOnly&&r.valueMapper)])):$a(La(r,u,i),Ne(r.algorithm,p),a,!r.keysOnly&&r.valueMapper)}function $a(r,a,i,u){var l=Ae(u?function(f,p,m){return i(u(f),p,m)}:i);return r.then(function(f){if(f)return f.start(function(){var p=function(){return f.continue()};a&&!a(f,function(m){return p=m},function(m){f.stop(m),p=ve},function(m){f.fail(m),p=ve})||l(f.value,f,function(m){return p=m}),p()})})}xe.prototype._read=function(r,a){var i=this._ctx;return i.error?i.table._trans(null,H.bind(null,i.error)):i.table._trans("readonly",r).then(a)},xe.prototype._write=function(r){var a=this._ctx;return a.error?a.table._trans(null,H.bind(null,a.error)):a.table._trans("readwrite",r,"locked")},xe.prototype._addAlgorithm=function(r){var a=this._ctx;a.algorithm=Ne(a.algorithm,r)},xe.prototype._iterate=function(r,a){return $r(this._ctx,r,a,this._ctx.table.core)},xe.prototype.clone=function(r){var a=Object.create(this.constructor.prototype),i=Object.create(this._ctx);return r&&g(i,r),a._ctx=i,a},xe.prototype.raw=function(){return this._ctx.valueMapper=null,this},xe.prototype.each=function(r){var a=this._ctx;return this._read(function(i){return $r(a,r,i,a.table.core)})},xe.prototype.count=function(r){var a=this;return this._read(function(i){var u,l=a._ctx,f=l.table.core;return Bn(l,!0)?f.count({trans:i,query:{index:Lr(l,f.schema),range:l.range}}).then(function(p){return Math.min(p,l.limit)}):(u=0,$r(l,function(){return++u,!1},i,f).then(function(){return u}))}).then(r)},xe.prototype.sortBy=function(r,a){var i=r.split(".").reverse(),u=i[0],l=i.length-1;function f(x,A){return A?f(x[i[A]],A-1):x[u]}var p=this._ctx.dir==="next"?1:-1;function m(x,A){return ge(f(x,l),f(A,l))*p}return this.toArray(function(x){return x.sort(m)}).then(a)},xe.prototype.toArray=function(r){var a=this;return this._read(function(i){var u,l,f,p=a._ctx;return p.dir==="next"&&Bn(p,!0)&&0<p.limit?(u=p.valueMapper,l=Lr(p,p.table.core.schema),p.table.core.query({trans:i,limit:p.limit,values:!0,query:{index:l,range:p.range}}).then(function(m){return m=m.result,u?m.map(u):m})):(f=[],$r(p,function(m){return f.push(m)},i,p.table.core).then(function(){return f}))},r)},xe.prototype.offset=function(r){var a=this._ctx;return r<=0||(a.offset+=r,Bn(a)?So(a,function(){var i=r;return function(u,l){return i===0||(i===1?--i:l(function(){u.advance(i),i=0}),!1)}}):So(a,function(){var i=r;return function(){return--i<0}})),this},xe.prototype.limit=function(r){return this._ctx.limit=Math.min(this._ctx.limit,r),So(this._ctx,function(){var a=r;return function(i,u,l){return--a<=0&&u(l),0<=a}},!0),this},xe.prototype.until=function(r,a){return ko(this._ctx,function(i,u,l){return!r(i.value)||(u(l),a)}),this},xe.prototype.first=function(r){return this.limit(1).toArray(function(a){return a[0]}).then(r)},xe.prototype.last=function(r){return this.reverse().first(r)},xe.prototype.filter=function(r){var a;return ko(this._ctx,function(i){return r(i.value)}),(a=this._ctx).isMatch=Ne(a.isMatch,r),this},xe.prototype.and=function(r){return this.filter(r)},xe.prototype.or=function(r){return new this.db.WhereClause(this._ctx.table,r,this)},xe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},xe.prototype.desc=function(){return this.reverse()},xe.prototype.eachKey=function(r){var a=this._ctx;return a.keysOnly=!a.isMatch,this.each(function(i,u){r(u.key,u)})},xe.prototype.eachUniqueKey=function(r){return this._ctx.unique="unique",this.eachKey(r)},xe.prototype.eachPrimaryKey=function(r){var a=this._ctx;return a.keysOnly=!a.isMatch,this.each(function(i,u){r(u.primaryKey,u)})},xe.prototype.keys=function(r){var a=this._ctx,i=(a.keysOnly=!a.isMatch,[]);return this.each(function(u,l){i.push(l.key)}).then(function(){return i}).then(r)},xe.prototype.primaryKeys=function(r){var a=this._ctx;if(a.dir==="next"&&Bn(a,!0)&&0<a.limit)return this._read(function(u){var l=Lr(a,a.table.core.schema);return a.table.core.query({trans:u,values:!1,limit:a.limit,query:{index:l,range:a.range}})}).then(function(u){return u.result}).then(r);a.keysOnly=!a.isMatch;var i=[];return this.each(function(u,l){i.push(l.primaryKey)}).then(function(){return i}).then(r)},xe.prototype.uniqueKeys=function(r){return this._ctx.unique="unique",this.keys(r)},xe.prototype.firstKey=function(r){return this.limit(1).keys(function(a){return a[0]}).then(r)},xe.prototype.lastKey=function(r){return this.reverse().firstKey(r)},xe.prototype.distinct=function(){var r,a=this._ctx,a=a.index&&a.table.schema.idxByName[a.index];return a&&a.multi&&(r={},ko(this._ctx,function(u){var u=u.primaryKey.toString(),l=P(r,u);return r[u]=!0,!l})),this},xe.prototype.modify=function(r){var a=this,i=this._ctx;return this._write(function(u){function l(w,j){var N=j.failures;E+=w-j.numFailures;for(var O=0,M=d(N);O<M.length;O++){var F=M[O];b.push(N[F])}}var f=typeof r=="function"?r:function(w){return za(w,r)},p=i.table.core,k=p.schema.primaryKey,m=k.outbound,x=k.extractKey,A=200,k=a.db._options.modifyChunkSize,b=(k&&(A=typeof k=="object"?k[p.name]||k["*"]||200:k),[]),E=0,T=[],S=r===Fa;return a.clone().primaryKeys().then(function(w){function j(O){var M=Math.min(A,w.length-O),F=w.slice(O,O+M);return(S?Promise.resolve([]):p.getMany({trans:u,keys:F,cache:"immutable"})).then(function(V){var J=[],K=[],te=m?[]:null,Q=S?F:[];if(!S)for(var B=0;B<M;++B){var ne=V[B],_e={value:Ye(ne),primKey:w[O+B]};f.call(_e,_e.value,_e)!==!1&&(_e.value==null?Q.push(w[O+B]):m||ge(x(ne),x(_e.value))===0?(K.push(_e.value),m&&te.push(w[O+B])):(Q.push(w[O+B]),J.push(_e.value)))}return Promise.resolve(0<J.length&&p.mutate({trans:u,type:"add",values:J}).then(function(ke){for(var le in ke.failures)Q.splice(parseInt(le),1);l(J.length,ke)})).then(function(){return(0<K.length||N&&typeof r=="object")&&p.mutate({trans:u,type:"put",keys:te,values:K,criteria:N,changeSpec:typeof r!="function"&&r,isAdditionalChunk:0<O}).then(function(ke){return l(K.length,ke)})}).then(function(){return(0<Q.length||N&&S)&&p.mutate({trans:u,type:"delete",keys:Q,criteria:N,isAdditionalChunk:0<O}).then(function(ke){return Rr(i.table,Q,ke)}).then(function(ke){return l(Q.length,ke)})}).then(function(){return w.length>O+M&&j(O+A)})})}var N=Bn(i)&&i.limit===1/0&&(typeof r!="function"||S)&&{index:i.index,range:i.range};return j(0).then(function(){if(0<b.length)throw new _t("Error modifying one or more objects",b,E,T);return w.length})})})},xe.prototype.delete=function(){var r=this._ctx,a=r.range;return!Bn(r)||r.table.schema.yProps||!r.isPrimKey&&a.type!==3?this.modify(Fa):this._write(function(i){var u=r.table.core.schema.primaryKey,l=a;return r.table.core.count({trans:i,query:{index:u,range:l}}).then(function(f){return r.table.core.mutate({trans:i,type:"deleteRange",range:l}).then(function(x){var m=x.failures,x=x.numFailures;if(x)throw new _t("Could not delete some values",Object.keys(m).map(function(A){return m[A]}),f-x);return f-x})})})};var nc=xe;function xe(){}var Fa=function(r,a){return a.value=null};function rc(r,a){return r<a?-1:r===a?0:1}function oc(r,a){return a<r?-1:r===a?0:1}function vt(r,a,i){return r=r instanceof Ka?new r.Collection(r):r,r._ctx.error=new(i||TypeError)(a),r}function qn(r){return new r.Collection(r,function(){return Za("")}).limit(0)}function Fr(T,a,i,u){var l,f,p,m,x,A,k,b=i.length;if(!i.every(function(w){return typeof w=="string"}))return vt(T,Me);function E(w){l=w==="next"?function(N){return N.toUpperCase()}:function(N){return N.toLowerCase()},f=w==="next"?function(N){return N.toLowerCase()}:function(N){return N.toUpperCase()},p=w==="next"?rc:oc;var j=i.map(function(N){return{lower:f(N),upper:l(N)}}).sort(function(N,O){return p(N.lower,O.lower)});m=j.map(function(N){return N.upper}),x=j.map(function(N){return N.lower}),k=(A=w)==="next"?"":u}E("next");var T=new T.Collection(T,function(){return fn(m[0],x[b-1]+u)}),S=(T._ondirectionchange=function(w){E(w)},0);return T._addAlgorithm(function(w,j,N){var O=w.key;if(typeof O=="string"){var M=f(O);if(a(M,x,S))return!0;for(var F=null,V=S;V<b;++V){var J=((K,te,Q,B,ne,_e)=>{for(var ke=Math.min(K.length,B.length),le=-1,fe=0;fe<ke;++fe){var ze=te[fe];if(ze!==B[fe])return ne(K[fe],Q[fe])<0?K.substr(0,fe)+Q[fe]+Q.substr(fe+1):ne(K[fe],B[fe])<0?K.substr(0,fe)+B[fe]+Q.substr(fe+1):0<=le?K.substr(0,le)+te[le]+Q.substr(le+1):null;ne(K[fe],ze)<0&&(le=fe)}return ke<B.length&&_e==="next"?K+Q.substr(K.length):ke<K.length&&_e==="prev"?K.substr(0,Q.length):le<0?null:K.substr(0,le)+B[le]+Q.substr(le+1)})(O,M,m[V],x[V],p,A);J===null&&F===null?S=V+1:(F===null||0<p(F,J))&&(F=J)}j(F!==null?function(){w.continue(F+k)}:N)}return!1}),T}function fn(r,a,i,u){return{type:2,lower:r,upper:a,lowerOpen:i,upperOpen:u}}function Za(r){return{type:1,lower:r,upper:r}}Object.defineProperty(Ge.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ge.prototype.between=function(r,a,i,u){i=i!==!1,u=u===!0;try{return 0<this._cmp(r,a)||this._cmp(r,a)===0&&(i||u)&&(!i||!u)?qn(this):new this.Collection(this,function(){return fn(r,a,!i,!u)})}catch{return vt(this,je)}},Ge.prototype.equals=function(r){return r==null?vt(this,je):new this.Collection(this,function(){return Za(r)})},Ge.prototype.above=function(r){return r==null?vt(this,je):new this.Collection(this,function(){return fn(r,void 0,!0)})},Ge.prototype.aboveOrEqual=function(r){return r==null?vt(this,je):new this.Collection(this,function(){return fn(r,void 0,!1)})},Ge.prototype.below=function(r){return r==null?vt(this,je):new this.Collection(this,function(){return fn(void 0,r,!1,!0)})},Ge.prototype.belowOrEqual=function(r){return r==null?vt(this,je):new this.Collection(this,function(){return fn(void 0,r)})},Ge.prototype.startsWith=function(r){return typeof r!="string"?vt(this,Me):this.between(r,r+we,!0,!0)},Ge.prototype.startsWithIgnoreCase=function(r){return r===""?this.startsWith(r):Fr(this,function(a,i){return a.indexOf(i[0])===0},[r],we)},Ge.prototype.equalsIgnoreCase=function(r){return Fr(this,function(a,i){return a===i[0]},[r],"")},Ge.prototype.anyOfIgnoreCase=function(){var r=dt.apply(Dt,arguments);return r.length===0?qn(this):Fr(this,function(a,i){return i.indexOf(a)!==-1},r,"")},Ge.prototype.startsWithAnyOfIgnoreCase=function(){var r=dt.apply(Dt,arguments);return r.length===0?qn(this):Fr(this,function(a,i){return i.some(function(u){return a.indexOf(u)===0})},r,we)},Ge.prototype.anyOf=function(){var r,a,i=this,u=dt.apply(Dt,arguments),l=this._cmp;try{u.sort(l)}catch{return vt(this,je)}return u.length===0?qn(this):((r=new this.Collection(this,function(){return fn(u[0],u[u.length-1])}))._ondirectionchange=function(f){l=f==="next"?i._ascending:i._descending,u.sort(l)},a=0,r._addAlgorithm(function(f,p,m){for(var x=f.key;0<l(x,u[a]);)if(++a===u.length)return p(m),!1;return l(x,u[a])===0||(p(function(){f.continue(u[a])}),!1)}),r)},Ge.prototype.notEqual=function(r){return this.inAnyRange([[-1/0,r],[r,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ge.prototype.noneOf=function(){var r=dt.apply(Dt,arguments);if(r.length===0)return new this.Collection(this);try{r.sort(this._ascending)}catch{return vt(this,je)}var a=r.reduce(function(i,u){return i?i.concat([[i[i.length-1][1],u]]):[[-1/0,u]]},null);return a.push([r[r.length-1],this.db._maxKey]),this.inAnyRange(a,{includeLowers:!1,includeUppers:!1})},Ge.prototype.inAnyRange=function(r,N){var i=this,u=this._cmp,l=this._ascending,f=this._descending,p=this._min,m=this._max;if(r.length===0)return qn(this);if(!r.every(function(O){return O[0]!==void 0&&O[1]!==void 0&&l(O[0],O[1])<=0}))return vt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",se.InvalidArgument);var x=!N||N.includeLowers!==!1,A=N&&N.includeUppers===!0,k,b=l;function E(O,M){return b(O[0],M[0])}try{(k=r.reduce(function(O,M){for(var F=0,V=O.length;F<V;++F){var J=O[F];if(u(M[0],J[1])<0&&0<u(M[1],J[0])){J[0]=p(J[0],M[0]),J[1]=m(J[1],M[1]);break}}return F===V&&O.push(M),O},[])).sort(E)}catch{return vt(this,je)}var T=0,S=A?function(O){return 0<l(O,k[T][1])}:function(O){return 0<=l(O,k[T][1])},w=x?function(O){return 0<f(O,k[T][0])}:function(O){return 0<=f(O,k[T][0])},j=S,N=new this.Collection(this,function(){return fn(k[0][0],k[k.length-1][1],!x,!A)});return N._ondirectionchange=function(O){b=O==="next"?(j=S,l):(j=w,f),k.sort(E)},N._addAlgorithm(function(O,M,F){for(var V,J=O.key;j(J);)if(++T===k.length)return M(F),!1;return!S(V=J)&&!w(V)||(i._cmp(J,k[T][1])===0||i._cmp(J,k[T][0])===0||M(function(){b===l?O.continue(k[T][0]):O.continue(k[T][1])}),!1)}),N},Ge.prototype.startsWithAnyOf=function(){var r=dt.apply(Dt,arguments);return r.every(function(a){return typeof a=="string"})?r.length===0?qn(this):this.inAnyRange(r.map(function(a){return[a,a+we]})):vt(this,"startsWithAnyOf() only works with strings")};var Ka=Ge;function Ge(){}function Kt(r){return Ae(function(a){return dr(a),r(a.target.error),!1})}function dr(r){r.stopPropagation&&r.stopPropagation(),r.preventDefault&&r.preventDefault()}var fr="storagemutated",Eo="x-storagemutated-1",pn=ur(null,fr),ac=(Ut.prototype._lock=function(){return R(!oe.global),++this._reculock,this._reculock!==1||oe.global||(oe.lockOwnerFor=this),this},Ut.prototype._unlock=function(){if(R(!oe.global),--this._reculock==0)for(oe.global||(oe.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var r=this._blockedFuncs.shift();try{ie(r[1],r[0])}catch{}}return this},Ut.prototype._locked=function(){return this._reculock&&oe.lockOwnerFor!==this},Ut.prototype.create=function(r){var a=this;if(this.mode){var i=this.db.idbdb,u=this.db._state.dbOpenError;if(R(!this.idbtrans),!r&&!i)switch(u&&u.name){case"DatabaseClosedError":throw new se.DatabaseClosed(u);case"MissingAPIError":throw new se.MissingAPI(u.message,u);default:throw new se.OpenFailed(u)}if(!this.active)throw new se.TransactionInactive;R(this._completion._state===null),(r=this.idbtrans=r||(this.db.core||i).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ae(function(l){dr(l),a._reject(r.error)}),r.onabort=Ae(function(l){dr(l),a.active&&a._reject(new se.Abort(r.error)),a.active=!1,a.on("abort").fire(l)}),r.oncomplete=Ae(function(){a.active=!1,a._resolve(),"mutatedParts"in r&&pn.storagemutated.fire(r.mutatedParts)})}return this},Ut.prototype._promise=function(r,a,i){var u,l=this;return r==="readwrite"&&this.mode!=="readwrite"?H(new se.ReadOnly("Transaction is readonly")):this.active?this._locked()?new G(function(f,p){l._blockedFuncs.push([function(){l._promise(r,a,i).then(f,p)},oe])}):i?Mt(function(){var f=new G(function(p,m){l._lock();var x=a(p,m,l);x&&x.then&&x.then(p,m)});return f.finally(function(){return l._unlock()}),f._lib=!0,f}):((u=new G(function(f,p){var m=a(f,p,l);m&&m.then&&m.then(f,p)}))._lib=!0,u):H(new se.TransactionInactive)},Ut.prototype._root=function(){return this.parent?this.parent._root():this},Ut.prototype.waitFor=function(r){var a,i=this._root(),u=G.resolve(r),l=(i._waitingFor?i._waitingFor=i._waitingFor.then(function(){return u}):(i._waitingFor=u,i._waitingQueue=[],a=i.idbtrans.objectStore(i.storeNames[0]),function f(){for(++i._spinCount;i._waitingQueue.length;)i._waitingQueue.shift()();i._waitingFor&&(a.get(-1/0).onsuccess=f)}()),i._waitingFor);return new G(function(f,p){u.then(function(m){return i._waitingQueue.push(Ae(f.bind(null,m)))},function(m){return i._waitingQueue.push(Ae(p.bind(null,m)))}).finally(function(){i._waitingFor===l&&(i._waitingFor=null)})})},Ut.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new se.Abort))},Ut.prototype.table=function(r){var a=this._memoizedTables||(this._memoizedTables={});if(P(a,r))return a[r];var i=this.schema[r];if(i)return(i=new this.db.Table(r,i,this)).core=this.db.core.table(r),a[r]=i;throw new se.NotFound("Table "+r+" not part of transaction")},Ut);function Ut(){}function To(r,a,i,u,l,f,p,m){return{name:r,keyPath:a,unique:i,multi:u,auto:l,compound:f,src:(i&&!p?"&":"")+(u?"*":"")+(l?"++":"")+Ua(a),type:m}}function Ua(r){return typeof r=="string"?r:r?"["+[].join.call(r,"+")+"]":""}function Oo(r,a,i){return{name:r,primKey:a,indexes:i,mappedClass:null,idxByName:(u=function(l){return[l.name,l]},i.reduce(function(l,f,p){return f=u(f,p),f&&(l[f[0]]=f[1]),l},{}))};var u}var pr=function(r){try{return r.only([[]]),pr=function(){return[[]]},[[]]}catch{return pr=function(){return we},we}};function Ao(r){return r==null?function(){}:typeof r=="string"?(a=r).split(".").length===1?function(i){return i[a]}:function(i){return ae(i,a)}:function(i){return ae(i,r)};var a}function Ba(r){return[].slice.call(r)}var sc=0;function hr(r){return r==null?":id":typeof r=="string"?r:"[".concat(r.join("+"),"]")}function ic(r,a,x){function u(S){if(S.type===3)return null;if(S.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var b=S.lower,E=S.upper,T=S.lowerOpen,S=S.upperOpen;return b===void 0?E===void 0?null:a.upperBound(E,!!S):E===void 0?a.lowerBound(b,!!T):a.bound(b,E,!!T,!!S)}function l(k){var b,E=k.name;return{name:E,schema:k,mutate:function(T){var S=T.trans,w=T.type,j=T.keys,N=T.values,O=T.range;return new Promise(function(M,F){M=Ae(M);var V=S.objectStore(E),J=V.keyPath==null,K=w==="put"||w==="add";if(!K&&w!=="delete"&&w!=="deleteRange")throw new Error("Invalid operation type: "+w);var te,Q=(j||N||{length:1}).length;if(j&&N&&j.length!==N.length)throw new Error("Given keys array must have same length as given values array.");if(Q===0)return M({numFailures:0,failures:{},results:[],lastResult:void 0});function B(Fe){++ke,dr(Fe)}var ne=[],_e=[],ke=0;if(w==="deleteRange"){if(O.type===4)return M({numFailures:ke,failures:_e,results:[],lastResult:void 0});O.type===3?ne.push(te=V.clear()):ne.push(te=V.delete(u(O)))}else{var J=K?J?[N,j]:[N,null]:[j,null],le=J[0],fe=J[1];if(K)for(var ze=0;ze<Q;++ze)ne.push(te=fe&&fe[ze]!==void 0?V[w](le[ze],fe[ze]):V[w](le[ze])),te.onerror=B;else for(ze=0;ze<Q;++ze)ne.push(te=V[w](le[ze])),te.onerror=B}function St(Fe){Fe=Fe.target.result,ne.forEach(function(Pn,Ho){return Pn.error!=null&&(_e[Ho]=Pn.error)}),M({numFailures:ke,failures:_e,results:w==="delete"?j:ne.map(function(Pn){return Pn.result}),lastResult:Fe})}te.onerror=function(Fe){B(Fe),St(Fe)},te.onsuccess=St})},getMany:function(T){var S=T.trans,w=T.keys;return new Promise(function(j,N){j=Ae(j);for(var O,M=S.objectStore(E),F=w.length,V=new Array(F),J=0,K=0,te=function(ne){ne=ne.target,V[ne._pos]=ne.result,++K===J&&j(V)},Q=Kt(N),B=0;B<F;++B)w[B]!=null&&((O=M.get(w[B]))._pos=B,O.onsuccess=te,O.onerror=Q,++J);J===0&&j(V)})},get:function(T){var S=T.trans,w=T.key;return new Promise(function(j,N){j=Ae(j);var O=S.objectStore(E).get(w);O.onsuccess=function(M){return j(M.target.result)},O.onerror=Kt(N)})},query:(b=m,function(T){return new Promise(function(S,w){S=Ae(S);var j,N,O,K=T.trans,M=T.values,F=T.limit,J=T.query,V=F===1/0?void 0:F,te=J.index,J=J.range,K=K.objectStore(E),K=te.isPrimaryKey?K:K.index(te.name),te=u(J);if(F===0)return S({result:[]});b?((J=M?K.getAll(te,V):K.getAllKeys(te,V)).onsuccess=function(Q){return S({result:Q.target.result})},J.onerror=Kt(w)):(j=0,N=!M&&"openKeyCursor"in K?K.openKeyCursor(te):K.openCursor(te),O=[],N.onsuccess=function(Q){var B=N.result;return!B||(O.push(M?B.value:B.primaryKey),++j===F)?S({result:O}):void B.continue()},N.onerror=Kt(w))})}),openCursor:function(T){var S=T.trans,w=T.values,j=T.query,N=T.reverse,O=T.unique;return new Promise(function(M,F){M=Ae(M);var K=j.index,V=j.range,J=S.objectStore(E),J=K.isPrimaryKey?J:J.index(K.name),K=N?O?"prevunique":"prev":O?"nextunique":"next",te=!w&&"openKeyCursor"in J?J.openKeyCursor(u(V),K):J.openCursor(u(V),K);te.onerror=Kt(F),te.onsuccess=Ae(function(Q){var B,ne,_e,ke,le=te.result;le?(le.___id=++sc,le.done=!1,B=le.continue.bind(le),ne=(ne=le.continuePrimaryKey)&&ne.bind(le),_e=le.advance.bind(le),ke=function(){throw new Error("Cursor not stopped")},le.trans=S,le.stop=le.continue=le.continuePrimaryKey=le.advance=function(){throw new Error("Cursor not started")},le.fail=Ae(F),le.next=function(){var fe=this,ze=1;return this.start(function(){return ze--?fe.continue():fe.stop()}).then(function(){return fe})},le.start=function(fe){function ze(){if(te.result)try{fe()}catch(Fe){le.fail(Fe)}else le.done=!0,le.start=function(){throw new Error("Cursor behind last entry")},le.stop()}var St=new Promise(function(Fe,Pn){Fe=Ae(Fe),te.onerror=Kt(Pn),le.fail=Pn,le.stop=function(Ho){le.stop=le.continue=le.continuePrimaryKey=le.advance=ke,Fe(Ho)}});return te.onsuccess=Ae(function(Fe){te.onsuccess=ze,ze()}),le.continue=B,le.continuePrimaryKey=ne,le.advance=_e,ze(),St},M(le)):M(null)},F)})},count:function(T){var S=T.query,w=T.trans,j=S.index,N=S.range;return new Promise(function(O,M){var F=w.objectStore(E),F=j.isPrimaryKey?F:F.index(j.name),V=u(N),V=V?F.count(V):F.count();V.onsuccess=Ae(function(J){return O(J.target.result)}),V.onerror=Kt(M)})}}}f=x,p=Ba((x=r).objectStoreNames);var f,x={schema:{name:x.name,tables:p.map(function(k){return f.objectStore(k)}).map(function(k){var b=k.keyPath,E=k.autoIncrement,S=h(b),T={},S={name:k.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:b==null,compound:S,keyPath:b,autoIncrement:E,unique:!0,extractKey:Ao(b)},indexes:Ba(k.indexNames).map(function(w){return k.index(w)}).map(function(O){var M=O.name,j=O.unique,N=O.multiEntry,O=O.keyPath,M={name:M,compound:h(O),keyPath:O,unique:j,multiEntry:N,extractKey:Ao(O)};return T[hr(O)]=M}),getIndexByKeyPath:function(w){return T[hr(w)]}};return T[":id"]=S.primaryKey,b!=null&&(T[hr(b)]=S.primaryKey),S})},hasGetAll:0<p.length&&"getAll"in f.objectStore(p[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},p=x.schema,m=x.hasGetAll,x=p.tables.map(l),A={};return x.forEach(function(k){return A[k.name]=k}),{stack:"dbcore",transaction:r.transaction.bind(r),table:function(k){if(A[k])return A[k];throw new Error("Table '".concat(k,"' not found"))},MIN_KEY:-1/0,MAX_KEY:pr(a),schema:p}}function cc(r,a,i,u){return i=i.IDBKeyRange,a=ic(a,i,u),{dbcore:r.dbcore.reduce(function(l,f){return f=f.create,o(o({},l),f(l))},a)}}function Zr(r,a){var i=a.db,i=cc(r._middlewares,i,r._deps,a);r.core=i.dbcore,r.tables.forEach(function(u){var l=u.name;r.core.schema.tables.some(function(f){return f.name===l})&&(u.core=r.core.table(l),r[l]instanceof r.Table)&&(r[l].core=u.core)})}function Kr(r,a,i,u){i.forEach(function(l){var f=u[l];a.forEach(function(p){var m=function x(A,k){return D(A,k)||(A=v(A))&&x(A,k)}(p,l);(!m||"value"in m&&m.value===void 0)&&(p===r.Transaction.prototype||p instanceof r.Transaction?Y(p,l,{get:function(){return this.table(l)},set:function(x){C(this,l,{value:x,writable:!0,configurable:!0,enumerable:!0})}}):p[l]=new r.Table(l,f))})})}function jo(r,a){a.forEach(function(i){for(var u in i)i[u]instanceof r.Table&&delete i[u]})}function uc(r,a){return r._cfg.version-a._cfg.version}function lc(r,a,i,u){var l=r._dbSchema,f=(i.objectStoreNames.contains("$meta")&&!l.$meta&&(l.$meta=Oo("$meta",Ha("")[0],[]),r._storeNames.push("$meta")),r._createTransaction("readwrite",r._storeNames,l)),p=(f.create(i),f._completion.catch(u),f._reject.bind(f)),m=oe.transless||oe;Mt(function(){if(oe.trans=f,oe.transless=m,a!==0)return Zr(r,i),A=a,((x=f).storeNames.includes("$meta")?x.table("$meta").get("version").then(function(k){return k??A}):G.resolve(A)).then(function(j){var b=r,E=j,T=f,S=i,w=[],j=b._versions,N=b._dbSchema=Br(0,b.idbdb,S);return(j=j.filter(function(O){return O._cfg.version>=E})).length===0?G.resolve():(j.forEach(function(O){w.push(function(){var M,F,V,J=N,K=O._cfg.dbschema,te=(qr(b,J,S),qr(b,K,S),N=b._dbSchema=K,Io(J,K)),Q=(te.add.forEach(function(B){Do(S,B[0],B[1].primKey,B[1].indexes)}),te.change.forEach(function(B){if(B.recreate)throw new se.Upgrade("Not yet support for changing primary key");var ne=S.objectStore(B.name);B.add.forEach(function(_e){return Ur(ne,_e)}),B.change.forEach(function(_e){ne.deleteIndex(_e.name),Ur(ne,_e)}),B.del.forEach(function(_e){return ne.deleteIndex(_e)})}),O._cfg.contentUpgrade);if(Q&&O._cfg.version>E)return Zr(b,S),T._memoizedTables={},M=me(K),te.del.forEach(function(B){M[B]=J[B]}),jo(b,[b.Transaction.prototype]),Kr(b,[b.Transaction.prototype],d(M),M),T.schema=M,(F=De(Q))&&tt(),K=G.follow(function(){var B;(V=Q(T))&&F&&(B=zt.bind(null,null),V.then(B,B))}),V&&typeof V.then=="function"?G.resolve(V):K.then(function(){return V})}),w.push(function(M){var F,V,J=O._cfg.dbschema;F=J,V=M,[].slice.call(V.db.objectStoreNames).forEach(function(K){return F[K]==null&&V.db.deleteObjectStore(K)}),jo(b,[b.Transaction.prototype]),Kr(b,[b.Transaction.prototype],b._storeNames,b._dbSchema),T.schema=b._dbSchema}),w.push(function(M){b.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(b.idbdb.version/10)===O._cfg.version?(b.idbdb.deleteObjectStore("$meta"),delete b._dbSchema.$meta,b._storeNames=b._storeNames.filter(function(F){return F!=="$meta"})):M.objectStore("$meta").put(O._cfg.version,"version"))})}),function O(){return w.length?G.resolve(w.shift()(T.idbtrans)).then(O):G.resolve()}().then(function(){qa(N,S)}))}).catch(p);var x,A;d(l).forEach(function(k){Do(i,k,l[k].primKey,l[k].indexes)}),Zr(r,i),G.follow(function(){return r.on.populate.fire(f)}).catch(p)})}function dc(r,a){qa(r._dbSchema,a),a.db.version%10!=0||a.objectStoreNames.contains("$meta")||a.db.createObjectStore("$meta").add(Math.ceil(a.db.version/10-1),"version");var i=Br(0,r.idbdb,a);qr(r,r._dbSchema,a);for(var u=0,l=Io(i,r._dbSchema).change;u<l.length;u++){var f=(p=>{if(p.change.length||p.recreate)return console.warn("Unable to patch indexes of table ".concat(p.name," because it has changes on the type of index or primary key.")),{value:void 0};var m=a.objectStore(p.name);p.add.forEach(function(x){st&&console.debug("Dexie upgrade patch: Creating missing index ".concat(p.name,".").concat(x.src)),Ur(m,x)})})(l[u]);if(typeof f=="object")return f.value}}function Io(r,a){var i,u={del:[],add:[],change:[]};for(i in r)a[i]||u.del.push(i);for(i in a){var l=r[i],f=a[i];if(l){var p={name:i,def:f,recreate:!1,del:[],add:[],change:[]};if(""+(l.primKey.keyPath||"")!=""+(f.primKey.keyPath||"")||l.primKey.auto!==f.primKey.auto)p.recreate=!0,u.change.push(p);else{var m=l.idxByName,x=f.idxByName,A=void 0;for(A in m)x[A]||p.del.push(A);for(A in x){var k=m[A],b=x[A];k?k.src!==b.src&&p.change.push(b):p.add.push(b)}(0<p.del.length||0<p.add.length||0<p.change.length)&&u.change.push(p)}}else u.add.push([i,f])}return u}function Do(r,a,i,u){var l=r.db.createObjectStore(a,i.keyPath?{keyPath:i.keyPath,autoIncrement:i.auto}:{autoIncrement:i.auto});u.forEach(function(f){return Ur(l,f)})}function qa(r,a){d(r).forEach(function(i){a.db.objectStoreNames.contains(i)||(st&&console.debug("Dexie: Creating missing table",i),Do(a,i,r[i].primKey,r[i].indexes))})}function Ur(r,a){r.createIndex(a.name,a.keyPath,{unique:a.unique,multiEntry:a.multi})}function Br(r,a,i){var u={};return L(a.objectStoreNames,0).forEach(function(l){for(var f=i.objectStore(l),p=To(Ua(A=f.keyPath),A||"",!0,!1,!!f.autoIncrement,A&&typeof A!="string",!0),m=[],x=0;x<f.indexNames.length;++x){var k=f.index(f.indexNames[x]),A=k.keyPath,k=To(k.name,A,!!k.unique,!!k.multiEntry,!1,A&&typeof A!="string",!1);m.push(k)}u[l]=Oo(l,p,m)}),u}function qr(r,a,i){for(var u=i.db.objectStoreNames,l=0;l<u.length;++l){var f=u[l],p=i.objectStore(f);r._hasGetAll="getAll"in p;for(var m=0;m<p.indexNames.length;++m){var x,A=p.indexNames[m],k=p.index(A).keyPath,k=typeof k=="string"?k:"["+L(k).join("+")+"]";a[f]&&(x=a[f].idxByName[k])&&(x.name=A,delete a[f].idxByName[k],a[f].idxByName[A]=x)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&c.WorkerGlobalScope&&c instanceof c.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function Ha(r){return r.split(",").map(function(a,i){var l=a.split(":"),u=(u=l[1])==null?void 0:u.trim(),l=(a=l[0].trim()).replace(/([&*]|\+\+)/g,""),f=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return To(l,f||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),h(f),i===0,u)})}Hn.prototype._createTableSchema=Oo,Hn.prototype._parseIndexSyntax=Ha,Hn.prototype._parseStoresSpec=function(r,a){var i=this;d(r).forEach(function(u){if(r[u]!==null){var l=i._parseIndexSyntax(r[u]),f=l.shift();if(!f)throw new se.Schema("Invalid schema for table "+u+": "+r[u]);if(f.unique=!0,f.multi)throw new se.Schema("Primary key cannot be multiEntry*");l.forEach(function(p){if(p.auto)throw new se.Schema("Only primary key can be marked as autoIncrement (++)");if(!p.keyPath)throw new se.Schema("Index must have a name and cannot be an empty string")}),f=i._createTableSchema(u,f,l),a[u]=f}})},Hn.prototype.stores=function(i){var a=this.db,i=(this._cfg.storesSource=this._cfg.storesSource?g(this._cfg.storesSource,i):i,a._versions),u={},l={};return i.forEach(function(f){g(u,f._cfg.storesSource),l=f._cfg.dbschema={},f._parseStoresSpec(u,l)}),a._dbSchema=l,jo(a,[a._allTables,a,a.Transaction.prototype]),Kr(a,[a._allTables,a,a.Transaction.prototype,this._cfg.tables],d(l),l),a._storeNames=d(l),this},Hn.prototype.upgrade=function(r){return this._cfg.contentUpgrade=Nt(this._cfg.contentUpgrade||ve,r),this};var fc=Hn;function Hn(){}function No(r,a){var i=r._dbNamesDB;return i||(i=r._dbNamesDB=new en(pt,{addons:[],indexedDB:r,IDBKeyRange:a})).version(1).stores({dbnames:"name"}),i.table("dbnames")}function Po(r){return r&&typeof r.databases=="function"}function Co(r){return Mt(function(){return oe.letThrough=!0,r()})}function Mo(r){return!("from"in r)}var nt=function(r,a){var i;if(!this)return i=new nt,r&&"d"in r&&g(i,r),i;g(this,arguments.length?{d:1,from:r,to:1<arguments.length?a:r}:{d:0})};function mr(r,a,i){var u=ge(a,i);if(!isNaN(u)){if(0<u)throw RangeError();if(Mo(r))return g(r,{from:a,to:i,d:1});var u=r.l,l=r.r;if(ge(i,r.from)<0)return u?mr(u,a,i):r.l={from:a,to:i,d:1,l:null,r:null},Va(r);if(0<ge(a,r.to))return l?mr(l,a,i):r.r={from:a,to:i,d:1,l:null,r:null},Va(r);ge(a,r.from)<0&&(r.from=a,r.l=null,r.d=l?l.d+1:1),0<ge(i,r.to)&&(r.to=i,r.r=null,r.d=r.l?r.l.d+1:1),a=!r.r,u&&!r.l&&gr(r,u),l&&a&&gr(r,l)}}function gr(r,a){Mo(a)||function i(u,l){var f=l.from,p=l.l,m=l.r;mr(u,f,l.to),p&&i(u,p),m&&i(u,m)}(r,a)}function Wa(r,a){var i=Hr(a),u=i.next();if(!u.done)for(var l=u.value,f=Hr(r),p=f.next(l.from),m=p.value;!u.done&&!p.done;){if(ge(m.from,l.to)<=0&&0<=ge(m.to,l.from))return!0;ge(l.from,m.from)<0?l=(u=i.next(m.from)).value:m=(p=f.next(l.from)).value}return!1}function Hr(r){var a=Mo(r)?null:{s:0,n:r};return{next:function(i){for(var u=0<arguments.length;a;)switch(a.s){case 0:if(a.s=1,u)for(;a.n.l&&ge(i,a.n.from)<0;)a={up:a,n:a.n.l,s:1};else for(;a.n.l;)a={up:a,n:a.n.l,s:1};case 1:if(a.s=2,!u||ge(i,a.n.to)<=0)return{value:a.n,done:!1};case 2:if(a.n.r){a.s=3,a={up:a,n:a.n.r,s:0};continue}case 3:a=a.up}return{done:!0}}}}function Va(r){var a,i,u,l=(((l=r.r)==null?void 0:l.d)||0)-(((l=r.l)==null?void 0:l.d)||0),l=1<l?"r":l<-1?"l":"";l&&(a=l=="r"?"l":"r",i=o({},r),u=r[l],r.from=u.from,r.to=u.to,r[l]=u[l],i[l]=u[a],(r[a]=i).d=Ja(i)),r.d=Ja(r)}function Ja(i){var a=i.r,i=i.l;return(a?i?Math.max(a.d,i.d):a.d:i?i.d:0)+1}function Wr(r,a){return d(a).forEach(function(i){r[i]?gr(r[i],a[i]):r[i]=function u(l){var f,p,m={};for(f in l)P(l,f)&&(p=l[f],m[f]=!p||typeof p!="object"||ye.has(p.constructor)?p:u(p));return m}(a[i])}),r}function zo(r,a){return r.all||a.all||Object.keys(r).some(function(i){return a[i]&&Wa(a[i],r[i])})}$(nt.prototype,((qe={add:function(r){return gr(this,r),this},addKey:function(r){return mr(this,r,r),this},addKeys:function(r){var a=this;return r.forEach(function(i){return mr(a,i,i)}),this},hasKey:function(r){var a=Hr(this).next(r).value;return a&&ge(a.from,r)<=0&&0<=ge(a.to,r)}})[Jt]=function(){return Hr(this)},qe));var Dn={},Ro={},Lo=!1;function Vr(r){Wr(Ro,r),Lo||(Lo=!0,setTimeout(function(){Lo=!1,$o(Ro,!(Ro={}))},0))}function $o(r,a){a===void 0&&(a=!1);var i=new Set;if(r.all)for(var u=0,l=Object.values(Dn);u<l.length;u++)Ga(m=l[u],r,i,a);else for(var f in r){var p,m,f=/^idb\:\/\/(.*)\/(.*)\//.exec(f);f&&(p=f[1],f=f[2],m=Dn["idb://".concat(p,"/").concat(f)])&&Ga(m,r,i,a)}i.forEach(function(x){return x()})}function Ga(r,a,i,u){for(var l=[],f=0,p=Object.entries(r.queries.query);f<p.length;f++){for(var m=p[f],x=m[0],A=[],k=0,b=m[1];k<b.length;k++){var E=b[k];zo(a,E.obsSet)?E.subscribers.forEach(function(j){return i.add(j)}):u&&A.push(E)}u&&l.push([x,A])}if(u)for(var T=0,S=l;T<S.length;T++){var w=S[T],x=w[0],A=w[1];r.queries.query[x]=A}}function pc(r){var a=r._state,i=r._deps.indexedDB;if(a.isBeingOpened||r.idbdb)return a.dbReadyPromise.then(function(){return a.dbOpenError?H(a.dbOpenError):r});a.isBeingOpened=!0,a.dbOpenError=null,a.openComplete=!1;var u=a.openCanceller,l=Math.round(10*r.verno),f=!1;function p(){if(a.openCanceller!==u)throw new se.DatabaseClosed("db.open() was cancelled")}function m(){return new G(function(E,T){if(p(),!i)throw new se.MissingAPI;var S=r.name,w=a.autoSchema||!l?i.open(S):i.open(S,l);if(!w)throw new se.MissingAPI;w.onerror=Kt(T),w.onblocked=Ae(r._fireOnBlocked),w.onupgradeneeded=Ae(function(j){var N;k=w.transaction,a.autoSchema&&!r._options.allowEmptyDB?(w.onerror=dr,k.abort(),w.result.close(),(N=i.deleteDatabase(S)).onsuccess=N.onerror=Ae(function(){T(new se.NoSuchDatabase("Database ".concat(S," doesnt exist")))})):(k.onerror=Kt(T),N=j.oldVersion>Math.pow(2,62)?0:j.oldVersion,b=N<1,r.idbdb=w.result,f&&dc(r,k),lc(r,N/10,k,T))},T),w.onsuccess=Ae(function(){k=null;var j,N,O,M,F,V,J=r.idbdb=w.result,K=L(J.objectStoreNames);if(0<K.length)try{var te=J.transaction((F=K).length===1?F[0]:F,"readonly");if(a.autoSchema)V=J,M=te,(O=r).verno=V.version/10,M=O._dbSchema=Br(0,V,M),O._storeNames=L(V.objectStoreNames,0),Kr(O,[O._allTables],d(M),M);else if(qr(r,r._dbSchema,te),N=te,((N=Io(Br(0,(j=r).idbdb,N),j._dbSchema)).add.length||N.change.some(function(Q){return Q.add.length||Q.change.length}))&&!f)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),J.close(),l=J.version+1,f=!0,E(m());Zr(r,te)}catch{}Ue.push(r),J.onversionchange=Ae(function(Q){a.vcFired=!0,r.on("versionchange").fire(Q)}),J.onclose=Ae(function(){r.close({disableAutoOpen:!1})}),b&&(K=r._deps,F=S,Po(V=K.indexedDB)||F===pt||No(V,K.IDBKeyRange).put({name:F}).catch(ve)),E()},T)}).catch(function(E){switch(E==null?void 0:E.name){case"UnknownError":if(0<a.PR1398_maxLoop)return a.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),m();break;case"VersionError":if(0<l)return l=0,m()}return G.reject(E)})}var x,A=a.dbReadyResolve,k=null,b=!1;return G.race([u,(typeof navigator>"u"?G.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(E){function T(){return indexedDB.databases().finally(E)}x=setInterval(T,100),T()}).finally(function(){return clearInterval(x)}):Promise.resolve()).then(m)]).then(function(){return p(),a.onReadyBeingFired=[],G.resolve(Co(function(){return r.on.ready.fire(r.vip)})).then(function E(){var T;if(0<a.onReadyBeingFired.length)return T=a.onReadyBeingFired.reduce(Nt,ve),a.onReadyBeingFired=[],G.resolve(Co(function(){return T(r.vip)})).then(E)})}).finally(function(){a.openCanceller===u&&(a.onReadyBeingFired=null,a.isBeingOpened=!1)}).catch(function(E){a.dbOpenError=E;try{k&&k.abort()}catch{}return u===a.openCanceller&&r._close(),H(E)}).finally(function(){a.openComplete=!0,A()}).then(function(){var E;return b&&(E={},r.tables.forEach(function(T){T.schema.indexes.forEach(function(S){S.name&&(E["idb://".concat(r.name,"/").concat(T.name,"/").concat(S.name)]=new nt(-1/0,[[[]]]))}),E["idb://".concat(r.name,"/").concat(T.name,"/")]=E["idb://".concat(r.name,"/").concat(T.name,"/:dels")]=new nt(-1/0,[[[]]])}),pn(fr).fire(E),$o(E,!0)),r})}function Fo(r){function a(f){return r.next(f)}var i=l(a),u=l(function(f){return r.throw(f)});function l(f){return function(m){var m=f(m),x=m.value;return m.done?x:x&&typeof x.then=="function"?x.then(i,u):h(x)?Promise.all(x).then(i,u):i(x)}}return l(a)()}function Jr(r,a,i){for(var u=h(r)?r.slice():[r],l=0;l<i;++l)u.push(a);return u}var hc={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(r){return o(o({},r),{table:function(u){var i=r.table(u),u=i.schema,l={},f=[];function p(E,T,S){var O=hr(E),w=l[O]=l[O]||[],j=E==null?0:typeof E=="string"?1:E.length,N=0<T,O=o(o({},S),{name:N?"".concat(O,"(virtual-from:").concat(S.name,")"):S.name,lowLevelIndex:S,isVirtual:N,keyTail:T,keyLength:j,extractKey:Ao(E),unique:!N&&S.unique});return w.push(O),O.isPrimaryKey||f.push(O),1<j&&p(j===2?E[0]:E.slice(0,j-1),T+1,S),w.sort(function(M,F){return M.keyTail-F.keyTail}),O}var m=p(u.primaryKey.keyPath,0,u.primaryKey);l[":id"]=[m];for(var x=0,A=u.indexes;x<A.length;x++){var k=A[x];p(k.keyPath,0,k)}function b(E){var T,S=E.query.index;return S.isVirtual?o(o({},E),{query:{index:S.lowLevelIndex,range:(T=E.query.range,S=S.keyTail,{type:T.type===1?2:T.type,lower:Jr(T.lower,T.lowerOpen?r.MAX_KEY:r.MIN_KEY,S),lowerOpen:!0,upper:Jr(T.upper,T.upperOpen?r.MIN_KEY:r.MAX_KEY,S),upperOpen:!0})}}):E}return o(o({},i),{schema:o(o({},u),{primaryKey:m,indexes:f,getIndexByKeyPath:function(E){return(E=l[hr(E)])&&E[0]}}),count:function(E){return i.count(b(E))},query:function(E){return i.query(b(E))},openCursor:function(E){var T=E.query.index,S=T.keyTail,w=T.keyLength;return T.isVirtual?i.openCursor(b(E)).then(function(N){return N&&j(N)}):i.openCursor(E);function j(N){return Object.create(N,{continue:{value:function(O){O!=null?N.continue(Jr(O,E.reverse?r.MAX_KEY:r.MIN_KEY,S)):E.unique?N.continue(N.key.slice(0,w).concat(E.reverse?r.MIN_KEY:r.MAX_KEY,S)):N.continue()}},continuePrimaryKey:{value:function(O,M){N.continuePrimaryKey(Jr(O,r.MAX_KEY,S),M)}},primaryKey:{get:function(){return N.primaryKey}},key:{get:function(){var O=N.key;return w===1?O[0]:O.slice(0,w)}},value:{get:function(){return N.value}}})}}})}})}};function Zo(r,a,i,u){return i=i||{},u=u||"",d(r).forEach(function(l){var f,p,m;P(a,l)?(f=r[l],p=a[l],typeof f=="object"&&typeof p=="object"&&f&&p?(m=_n(f))!==_n(p)?i[u+l]=a[l]:m==="Object"?Zo(f,p,i,u+l+"."):f!==p&&(i[u+l]=a[l]):f!==p&&(i[u+l]=a[l])):i[u+l]=void 0}),d(a).forEach(function(l){P(r,l)||(i[u+l]=a[l])}),i}function Ko(r,a){return a.type==="delete"?a.keys:a.keys||a.values.map(r.extractKey)}var mc={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(r){return o(o({},r),{table:function(a){var i=r.table(a),u=i.schema.primaryKey;return o(o({},i),{mutate:function(l){var f=oe.trans,p=f.table(a).hook,m=p.deleting,x=p.creating,A=p.updating;switch(l.type){case"add":if(x.fire===ve)break;return f._promise("readwrite",function(){return k(l)},!0);case"put":if(x.fire===ve&&A.fire===ve)break;return f._promise("readwrite",function(){return k(l)},!0);case"delete":if(m.fire===ve)break;return f._promise("readwrite",function(){return k(l)},!0);case"deleteRange":if(m.fire===ve)break;return f._promise("readwrite",function(){return function b(E,T,S){return i.query({trans:E,values:!1,query:{index:u,range:T},limit:S}).then(function(w){var j=w.result;return k({type:"delete",keys:j,trans:E}).then(function(N){return 0<N.numFailures?Promise.reject(N.failures[0]):j.length<S?{failures:[],numFailures:0,lastResult:void 0}:b(E,o(o({},T),{lower:j[j.length-1],lowerOpen:!0}),S)})})}(l.trans,l.range,1e4)},!0)}return i.mutate(l);function k(b){var E,T,S,w=oe.trans,j=b.keys||Ko(u,b);if(j)return(b=b.type==="add"||b.type==="put"?o(o({},b),{keys:j}):o({},b)).type!=="delete"&&(b.values=s([],b.values)),b.keys&&(b.keys=s([],b.keys)),E=i,S=j,((T=b).type==="add"?Promise.resolve([]):E.getMany({trans:T.trans,keys:S,cache:"immutable"})).then(function(N){var O=j.map(function(M,F){var V,J,K,te=N[F],Q={onerror:null,onsuccess:null};return b.type==="delete"?m.fire.call(Q,M,te,w):b.type==="add"||te===void 0?(V=x.fire.call(Q,M,b.values[F],w),M==null&&V!=null&&(b.keys[F]=M=V,u.outbound||ce(b.values[F],u.keyPath,M))):(V=Zo(te,b.values[F]),(J=A.fire.call(Q,V,M,te,w))&&(K=b.values[F],Object.keys(J).forEach(function(B){P(K,B)?K[B]=J[B]:ce(K,B,J[B])}))),Q});return i.mutate(b).then(function(M){for(var F=M.failures,V=M.results,J=M.numFailures,M=M.lastResult,K=0;K<j.length;++K){var te=(V||j)[K],Q=O[K];te==null?Q.onerror&&Q.onerror(F[K]):Q.onsuccess&&Q.onsuccess(b.type==="put"&&N[K]?b.values[K]:te)}return{failures:F,results:V,numFailures:J,lastResult:M}}).catch(function(M){return O.forEach(function(F){return F.onerror&&F.onerror(M)}),Promise.reject(M)})});throw new Error("Keys missing")}}})}})}};function Ya(r,a,i){try{if(!a||a.keys.length<r.length)return null;for(var u=[],l=0,f=0;l<a.keys.length&&f<r.length;++l)ge(a.keys[l],r[f])===0&&(u.push(i?Ye(a.values[l]):a.values[l]),++f);return u.length===r.length?u:null}catch{return null}}var gc={stack:"dbcore",level:-1,create:function(r){return{table:function(a){var i=r.table(a);return o(o({},i),{getMany:function(u){var l;return u.cache?(l=Ya(u.keys,u.trans._cache,u.cache==="clone"))?G.resolve(l):i.getMany(u).then(function(f){return u.trans._cache={keys:u.keys,values:u.cache==="clone"?Ye(f):f},f}):i.getMany(u)},mutate:function(u){return u.type!=="add"&&(u.trans._cache=null),i.mutate(u)}})}}}};function Xa(r,a){return r.trans.mode==="readonly"&&!!r.subscr&&!r.trans.explicit&&r.trans.db._options.cache!=="disabled"&&!a.schema.primaryKey.outbound}function Qa(r,a){switch(r){case"query":return a.values&&!a.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var yc={stack:"dbcore",level:0,name:"Observability",create:function(r){var a=r.schema.name,i=new nt(r.MIN_KEY,r.MAX_KEY);return o(o({},r),{transaction:function(u,l,f){if(oe.subscr&&l!=="readonly")throw new se.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(oe.querier));return r.transaction(u,l,f)},table:function(u){function l(j){var w,j=j.query;return[w=j.index,new nt((w=(j=j.range).lower)!=null?w:r.MIN_KEY,(w=j.upper)!=null?w:r.MAX_KEY)]}var f=r.table(u),p=f.schema,m=p.primaryKey,x=p.indexes,A=m.extractKey,k=m.outbound,b=m.autoIncrement&&x.filter(function(S){return S.compound&&S.keyPath.includes(m.keyPath)}),E=o(o({},f),{mutate:function(S){function w(ne){return ne="idb://".concat(a,"/").concat(u,"/").concat(ne),F[ne]||(F[ne]=new nt)}var j,N,O,M=S.trans,F=S.mutatedParts||(S.mutatedParts={}),V=w(""),J=w(":dels"),K=S.type,Q=S.type==="deleteRange"?[S.range]:S.type==="delete"?[S.keys]:S.values.length<50?[Ko(m,S).filter(function(ne){return ne}),S.values]:[],te=Q[0],Q=Q[1],B=S.trans._cache;return h(te)?(V.addKeys(te),(K=K==="delete"||te.length===Q.length?Ya(te,B):null)||J.addKeys(te),(K||Q)&&(j=w,N=K,O=Q,p.indexes.forEach(function(ne){var _e=j(ne.name||"");function ke(fe){return fe!=null?ne.extractKey(fe):null}function le(fe){ne.multiEntry&&h(fe)?fe.forEach(function(ze){return _e.addKey(ze)}):_e.addKey(fe)}(N||O).forEach(function(fe,Fe){var St=N&&ke(N[Fe]),Fe=O&&ke(O[Fe]);ge(St,Fe)!==0&&(St!=null&&le(St),Fe!=null)&&le(Fe)})}))):te?(Q={from:(B=te.lower)!=null?B:r.MIN_KEY,to:(K=te.upper)!=null?K:r.MAX_KEY},J.add(Q),V.add(Q)):(V.add(i),J.add(i),p.indexes.forEach(function(ne){return w(ne.name).add(i)})),f.mutate(S).then(function(ne){return!te||S.type!=="add"&&S.type!=="put"||(V.addKeys(ne.results),b&&b.forEach(function(_e){for(var ke=S.values.map(function(St){return _e.extractKey(St)}),le=_e.keyPath.findIndex(function(St){return St===m.keyPath}),fe=0,ze=ne.results.length;fe<ze;++fe)ke[fe][le]=ne.results[fe];w(_e.name).addKeys(ke)})),M.mutatedParts=Wr(M.mutatedParts||{},F),ne})}}),T={get:function(S){return[m,new nt(S.key)]},getMany:function(S){return[m,new nt().addKeys(S.keys)]},count:l,query:l,openCursor:l};return d(T).forEach(function(S){E[S]=function(w){var j=oe.subscr,N=!!j,O=Xa(oe,f)&&Qa(S,w)?w.obsSet={}:j;if(N){var M,j=function(Q){return Q="idb://".concat(a,"/").concat(u,"/").concat(Q),O[Q]||(O[Q]=new nt)},F=j(""),V=j(":dels"),N=T[S](w),J=N[0],N=N[1];if((S==="query"&&J.isPrimaryKey&&!w.values?V:j(J.name||"")).add(N),!J.isPrimaryKey){if(S!=="count")return M=S==="query"&&k&&w.values&&f.query(o(o({},w),{values:!1})),f[S].apply(this,arguments).then(function(Q){if(S==="query"){if(k&&w.values)return M.then(function(ke){return ke=ke.result,F.addKeys(ke),Q});var B=w.values?Q.result.map(A):Q.result;(w.values?F:V).addKeys(B)}else{var ne,_e;if(S==="openCursor")return _e=w.values,(ne=Q)&&Object.create(ne,{key:{get:function(){return V.addKey(ne.primaryKey),ne.key}},primaryKey:{get:function(){var ke=ne.primaryKey;return V.addKey(ke),ke}},value:{get:function(){return _e&&F.addKey(ne.primaryKey),ne.value}}})}return Q});V.add(i)}}return f[S].apply(this,arguments)}}),E}})}};function es(r,a,i){var u;return i.numFailures===0?a:a.type==="deleteRange"||(u=a.keys?a.keys.length:"values"in a&&a.values?a.values.length:1,i.numFailures===u)?null:(u=o({},a),h(u.keys)&&(u.keys=u.keys.filter(function(l,f){return!(f in i.failures)})),"values"in u&&h(u.values)&&(u.values=u.values.filter(function(l,f){return!(f in i.failures)})),u)}function Uo(r,a){return i=r,((u=a).lower===void 0||(u.lowerOpen?0<ge(i,u.lower):0<=ge(i,u.lower)))&&(i=r,(u=a).upper===void 0||(u.upperOpen?ge(i,u.upper)<0:ge(i,u.upper)<=0));var i,u}function ts(r,a,i,u,l,f){var p,m,x,A,k,b;return!i||i.length===0||(p=a.query.index,m=p.multiEntry,x=a.query.range,A=u.schema.primaryKey.extractKey,k=p.extractKey,b=(p.lowLevelIndex||p).extractKey,(u=i.reduce(function(E,T){var S=E,w=[];if(T.type==="add"||T.type==="put")for(var j=new nt,N=T.values.length-1;0<=N;--N){var O,M=T.values[N],F=A(M);!j.hasKey(F)&&(O=k(M),m&&h(O)?O.some(function(Q){return Uo(Q,x)}):Uo(O,x))&&(j.addKey(F),w.push(M))}switch(T.type){case"add":var V=new nt().addKeys(a.values?E.map(function(B){return A(B)}):E),S=E.concat(a.values?w.filter(function(B){return B=A(B),!V.hasKey(B)&&(V.addKey(B),!0)}):w.map(function(B){return A(B)}).filter(function(B){return!V.hasKey(B)&&(V.addKey(B),!0)}));break;case"put":var J=new nt().addKeys(T.values.map(function(B){return A(B)}));S=E.filter(function(B){return!J.hasKey(a.values?A(B):B)}).concat(a.values?w:w.map(function(B){return A(B)}));break;case"delete":var K=new nt().addKeys(T.keys);S=E.filter(function(B){return!K.hasKey(a.values?A(B):B)});break;case"deleteRange":var te=T.range;S=E.filter(function(B){return!Uo(A(B),te)})}return S},r))===r)?r:(u.sort(function(E,T){return ge(b(E),b(T))||ge(A(E),A(T))}),a.limit&&a.limit<1/0&&(u.length>a.limit?u.length=a.limit:r.length===a.limit&&u.length<a.limit&&(l.dirty=!0)),f?Object.freeze(u):u)}function ns(r,a){return ge(r.lower,a.lower)===0&&ge(r.upper,a.upper)===0&&!!r.lowerOpen==!!a.lowerOpen&&!!r.upperOpen==!!a.upperOpen}function vc(r,a){return((i,u,l,f)=>{if(i===void 0)return u!==void 0?-1:0;if(u===void 0)return 1;if((i=ge(i,u))===0){if(l&&f)return 0;if(l)return 1;if(f)return-1}return i})(r.lower,a.lower,r.lowerOpen,a.lowerOpen)<=0&&0<=((i,u,l,f)=>{if(i===void 0)return u!==void 0?1:0;if(u===void 0)return-1;if((i=ge(i,u))===0){if(l&&f)return 0;if(l)return-1;if(f)return 1}return i})(r.upper,a.upper,r.upperOpen,a.upperOpen)}function bc(r,a,i,u){r.subscribers.add(i),u.addEventListener("abort",function(){var l,f;r.subscribers.delete(i),r.subscribers.size===0&&(l=r,f=a,setTimeout(function(){l.subscribers.size===0&&mt(f,l)},3e3))})}var _c={stack:"dbcore",level:0,name:"Cache",create:function(r){var a=r.schema.name;return o(o({},r),{transaction:function(i,u,l){var f,p,m=r.transaction(i,u,l);return u==="readwrite"&&(l=(f=new AbortController).signal,m.addEventListener("abort",(p=function(x){return function(){if(f.abort(),u==="readwrite"){for(var A=new Set,k=0,b=i;k<b.length;k++){var E=b[k],T=Dn["idb://".concat(a,"/").concat(E)];if(T){var S=r.table(E),w=T.optimisticOps.filter(function(ne){return ne.trans===m});if(m._explicit&&x&&m.mutatedParts)for(var j=0,N=Object.values(T.queries.query);j<N.length;j++)for(var O=0,M=(J=N[j]).slice();O<M.length;O++)zo((K=M[O]).obsSet,m.mutatedParts)&&(mt(J,K),K.subscribers.forEach(function(ne){return A.add(ne)}));else if(0<w.length){T.optimisticOps=T.optimisticOps.filter(function(ne){return ne.trans!==m});for(var F=0,V=Object.values(T.queries.query);F<V.length;F++)for(var J,K,te,Q=0,B=(J=V[F]).slice();Q<B.length;Q++)(K=B[Q]).res!=null&&m.mutatedParts&&(x&&!K.dirty?(te=Object.isFrozen(K.res),te=ts(K.res,K.req,w,S,K,te),K.dirty?(mt(J,K),K.subscribers.forEach(function(ne){return A.add(ne)})):te!==K.res&&(K.res=te,K.promise=G.resolve({result:te}))):(K.dirty&&mt(J,K),K.subscribers.forEach(function(ne){return A.add(ne)})))}}}A.forEach(function(ne){return ne()})}}})(!1),{signal:l}),m.addEventListener("error",p(!1),{signal:l}),m.addEventListener("complete",p(!0),{signal:l})),m},table:function(i){var u=r.table(i),l=u.schema.primaryKey;return o(o({},u),{mutate:function(f){var p,m=oe.trans;return!l.outbound&&m.db._options.cache!=="disabled"&&!m.explicit&&m.idbtrans.mode==="readwrite"&&(p=Dn["idb://".concat(a,"/").concat(i)])?(m=u.mutate(f),f.type!=="add"&&f.type!=="put"||!(50<=f.values.length||Ko(l,f).some(function(x){return x==null}))?(p.optimisticOps.push(f),f.mutatedParts&&Vr(f.mutatedParts),m.then(function(x){0<x.numFailures&&(mt(p.optimisticOps,f),(x=es(0,f,x))&&p.optimisticOps.push(x),f.mutatedParts)&&Vr(f.mutatedParts)}),m.catch(function(){mt(p.optimisticOps,f),f.mutatedParts&&Vr(f.mutatedParts)})):m.then(function(x){var A=es(0,o(o({},f),{values:f.values.map(function(k,b){var E;return x.failures[b]?k:(ce(E=(E=l.keyPath)!=null&&E.includes(".")?Ye(k):o({},k),l.keyPath,x.results[b]),E)})}),x);p.optimisticOps.push(A),queueMicrotask(function(){return f.mutatedParts&&Vr(f.mutatedParts)})}),m):u.mutate(f)},query:function(f){var p,m,x,A,k,b,E;return Xa(oe,u)&&Qa("query",f)?(p=((x=oe.trans)==null?void 0:x.db._options.cache)==="immutable",m=(x=oe).requery,x=x.signal,b=((T,S,w,j)=>{var N=Dn["idb://".concat(T,"/").concat(S)];if(!N)return[];if(!(T=N.queries[w]))return[null,!1,N,null];var O=T[(j.query?j.query.index.name:null)||""];if(!O)return[null,!1,N,null];switch(w){case"query":var M=O.find(function(F){return F.req.limit===j.limit&&F.req.values===j.values&&ns(F.req.query.range,j.query.range)});return M?[M,!0,N,O]:[O.find(function(F){return("limit"in F.req?F.req.limit:1/0)>=j.limit&&(!j.values||F.req.values)&&vc(F.req.query.range,j.query.range)}),!1,N,O];case"count":return M=O.find(function(F){return ns(F.req.query.range,j.query.range)}),[M,!!M,N,O]}})(a,i,"query",f),E=b[0],A=b[2],k=b[3],E&&b[1]?E.obsSet=f.obsSet:(b=u.query(f).then(function(T){var S=T.result;if(E&&(E.res=S),p){for(var w=0,j=S.length;w<j;++w)Object.freeze(S[w]);Object.freeze(S)}else T.result=Ye(S);return T}).catch(function(T){return k&&E&&mt(k,E),Promise.reject(T)}),E={obsSet:f.obsSet,promise:b,subscribers:new Set,type:"query",req:f,dirty:!1},k?k.push(E):(k=[E],(A=A||(Dn["idb://".concat(a,"/").concat(i)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[f.query.index.name||""]=k)),bc(E,k,m,x),E.promise.then(function(T){return{result:ts(T.result,f,A==null?void 0:A.optimisticOps,u,E,p)}})):u.query(f)}})}})}};function Gr(r,a){return new Proxy(r,{get:function(i,u,l){return u==="db"?a:Reflect.get(i,u,l)}})}Be.prototype.version=function(r){if(isNaN(r)||r<.1)throw new se.Type("Given version is not a positive number");if(r=Math.round(10*r)/10,this.idbdb||this._state.isBeingOpened)throw new se.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,r);var a=this._versions,i=a.filter(function(u){return u._cfg.version===r})[0];return i||(i=new this.Version(r),a.push(i),a.sort(uc),i.stores({}),this._state.autoSchema=!1),i},Be.prototype._whenReady=function(r){var a=this;return this.idbdb&&(this._state.openComplete||oe.letThrough||this._vip)?r():new G(function(i,u){if(a._state.openComplete)return u(new se.DatabaseClosed(a._state.dbOpenError));if(!a._state.isBeingOpened){if(!a._state.autoOpen)return void u(new se.DatabaseClosed);a.open().catch(ve)}a._state.dbReadyPromise.then(i,u)}).then(r)},Be.prototype.use=function(l){var a=l.stack,i=l.create,u=l.level,l=l.name,f=(l&&this.unuse({stack:a,name:l}),this._middlewares[a]||(this._middlewares[a]=[]));return f.push({stack:a,create:i,level:u??10,name:l}),f.sort(function(p,m){return p.level-m.level}),this},Be.prototype.unuse=function(r){var a=r.stack,i=r.name,u=r.create;return a&&this._middlewares[a]&&(this._middlewares[a]=this._middlewares[a].filter(function(l){return u?l.create!==u:!!i&&l.name!==i})),this},Be.prototype.open=function(){var r=this;return ie(Je,function(){return pc(r)})},Be.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var r=this._state,a=Ue.indexOf(this);if(0<=a&&Ue.splice(a,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}r.isBeingOpened||(r.dbReadyPromise=new G(function(i){r.dbReadyResolve=i}),r.openCanceller=new G(function(i,u){r.cancelOpen=u}))},Be.prototype.close=function(a){var a=(a===void 0?{disableAutoOpen:!0}:a).disableAutoOpen,i=this._state;a?(i.isBeingOpened&&i.cancelOpen(new se.DatabaseClosed),this._close(),i.autoOpen=!1,i.dbOpenError=new se.DatabaseClosed):(this._close(),i.autoOpen=this._options.autoOpen||i.isBeingOpened,i.openComplete=!1,i.dbOpenError=null)},Be.prototype.delete=function(r){var a=this,i=(r===void 0&&(r={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),u=this._state;return new G(function(l,f){function p(){a.close(r);var m=a._deps.indexedDB.deleteDatabase(a.name);m.onsuccess=Ae(function(){var x,A,k;x=a._deps,A=a.name,Po(k=x.indexedDB)||A===pt||No(k,x.IDBKeyRange).delete(A).catch(ve),l()}),m.onerror=Kt(f),m.onblocked=a._fireOnBlocked}if(i)throw new se.InvalidArgument("Invalid closeOptions argument to db.delete()");u.isBeingOpened?u.dbReadyPromise.then(p):p()})},Be.prototype.backendDB=function(){return this.idbdb},Be.prototype.isOpen=function(){return this.idbdb!==null},Be.prototype.hasBeenClosed=function(){var r=this._state.dbOpenError;return r&&r.name==="DatabaseClosed"},Be.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Be.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Be.prototype,"tables",{get:function(){var r=this;return d(this._allTables).map(function(a){return r._allTables[a]})},enumerable:!1,configurable:!0}),Be.prototype.transaction=function(){var r=(function(a,i,u){var l=arguments.length;if(l<2)throw new se.InvalidArgument("Too few arguments");for(var f=new Array(l-1);--l;)f[l-1]=arguments[l];return u=f.pop(),[a,Te(f),u]}).apply(this,arguments);return this._transaction.apply(this,r)},Be.prototype._transaction=function(r,a,i){var u,l,f=this,p=oe.trans,m=(p&&p.db===this&&r.indexOf("!")===-1||(p=null),r.indexOf("?")!==-1);r=r.replace("!","").replace("?","");try{if(l=a.map(function(A){if(A=A instanceof f.Table?A.name:A,typeof A!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return A}),r=="r"||r===Zt)u=Zt;else{if(r!="rw"&&r!=jn)throw new se.InvalidArgument("Invalid transaction mode: "+r);u=jn}if(p){if(p.mode===Zt&&u===jn){if(!m)throw new se.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");p=null}p&&l.forEach(function(A){if(p&&p.storeNames.indexOf(A)===-1){if(!m)throw new se.SubTransaction("Table "+A+" not included in parent transaction.");p=null}}),m&&p&&!p.active&&(p=null)}}catch(A){return p?p._promise(null,function(k,b){b(A)}):H(A)}var x=(function A(k,b,E,T,S){return G.resolve().then(function(){var O=oe.transless||oe,w=k._createTransaction(b,E,k._dbSchema,T),O=(w.explicit=!0,{trans:w,transless:O});if(T)w.idbtrans=T.idbtrans;else try{w.create(),w.idbtrans._explicit=!0,k._state.PR1398_maxLoop=3}catch(M){return M.name===gt.InvalidState&&k.isOpen()&&0<--k._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),k.close({disableAutoOpen:!1}),k.open().then(function(){return A(k,b,E,null,S)})):H(M)}var j,N=De(S),O=(N&&tt(),G.follow(function(){var M;(j=S.call(w,w))&&(N?(M=zt.bind(null,null),j.then(M,M)):typeof j.next=="function"&&typeof j.throw=="function"&&(j=Fo(j)))},O));return(j&&typeof j.then=="function"?G.resolve(j).then(function(M){return w.active?M:H(new se.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):O.then(function(){return j})).then(function(M){return T&&w._resolve(),w._completion.then(function(){return M})}).catch(function(M){return w._reject(M),H(M)})})}).bind(null,this,u,l,p,i);return p?p._promise(u,x,"lock"):oe.trans?ie(oe.transless,function(){return f._whenReady(x)}):this._whenReady(x)},Be.prototype.table=function(r){if(P(this._allTables,r))return this._allTables[r];throw new se.InvalidTable("Table ".concat(r," does not exist"))};var en=Be;function Be(r,a){var i,u,l,f,p,m=this,x=(this._middlewares={},this.verno=0,Be.dependencies),x=(this._options=a=o({addons:Be.addons,autoOpen:!0,indexedDB:x.indexedDB,IDBKeyRange:x.IDBKeyRange,cache:"cloned"},a),this._deps={indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange},a.addons),A=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ve,dbReadyPromise:null,cancelOpen:ve,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:a.autoOpen}),k=(A.dbReadyPromise=new G(function(b){A.dbReadyResolve=b}),A.openCanceller=new G(function(b,E){A.cancelOpen=E}),this._state=A,this.name=r,this.on=ur(this,"populate","blocked","versionchange","close",{ready:[Nt,ve]}),this.once=function(b,E){var T=function(){for(var S=[],w=0;w<arguments.length;w++)S[w]=arguments[w];m.on(b).unsubscribe(T),E.apply(m,S)};return m.on(b,T)},this.on.ready.subscribe=W(this.on.ready.subscribe,function(b){return function(E,T){Be.vip(function(){var S,w=m._state;w.openComplete?(w.dbOpenError||G.resolve().then(E),T&&b(E)):w.onReadyBeingFired?(w.onReadyBeingFired.push(E),T&&b(E)):(b(E),S=m,T||b(function j(){S.on.ready.unsubscribe(E),S.on.ready.unsubscribe(j)}))})}}),this.Collection=(i=this,lr(nc.prototype,function(j,w){this.db=i;var T=ir,S=null;if(w)try{T=w()}catch(O){S=O}var w=j._ctx,j=w.table,N=j.hook.reading.fire;this._ctx={table:j,index:w.index,isPrimKey:!w.index||j.schema.primKey.keyPath&&w.index===j.schema.primKey.name,range:T,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:S,or:w.or,valueMapper:N!==at?N:null}})),this.Table=(u=this,lr(Ra.prototype,function(b,E,T){this.db=u,this._tx=T,this.name=b,this.schema=E,this.hook=u._allTables[b]?u._allTables[b].hook:ur(null,{creating:[wn,ve],reading:[on,at],updating:[be,ve],deleting:[X,ve]})})),this.Transaction=(l=this,lr(ac.prototype,function(b,E,T,S,w){var j=this;b!=="readonly"&&E.forEach(function(N){N=(N=T[N])==null?void 0:N.yProps,N&&(E=E.concat(N.map(function(O){return O.updatesTable})))}),this.db=l,this.mode=b,this.storeNames=E,this.schema=T,this.chromeTransactionDurability=S,this.idbtrans=null,this.on=ur(this,"complete","error","abort"),this.parent=w||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new G(function(N,O){j._resolve=N,j._reject=O}),this._completion.then(function(){j.active=!1,j.on.complete.fire()},function(N){var O=j.active;return j.active=!1,j.on.error.fire(N),j.parent?j.parent._reject(N):O&&j.idbtrans&&j.idbtrans.abort(),H(N)})})),this.Version=(f=this,lr(fc.prototype,function(b){this.db=f,this._cfg={version:b,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(p=this,lr(Ka.prototype,function(b,E,T){if(this.db=p,this._ctx={table:b,index:E===":id"?null:E,or:T},this._cmp=this._ascending=ge,this._descending=function(S,w){return ge(w,S)},this._max=function(S,w){return 0<ge(S,w)?S:w},this._min=function(S,w){return ge(S,w)<0?S:w},this._IDBKeyRange=p._deps.IDBKeyRange,!this._IDBKeyRange)throw new se.MissingAPI})),this.on("versionchange",function(b){0<b.newVersion?console.warn("Another connection wants to upgrade database '".concat(m.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(m.name,"'. Closing db now to resume the delete request.")),m.close({disableAutoOpen:!1})}),this.on("blocked",function(b){!b.newVersion||b.newVersion<b.oldVersion?console.warn("Dexie.delete('".concat(m.name,"') was blocked")):console.warn("Upgrade '".concat(m.name,"' blocked by other connection holding version ").concat(b.oldVersion/10))}),this._maxKey=pr(a.IDBKeyRange),this._createTransaction=function(b,E,T,S){return new m.Transaction(b,E,T,m._options.chromeTransactionDurability,S)},this._fireOnBlocked=function(b){m.on("blocked").fire(b),Ue.filter(function(E){return E.name===m.name&&E!==m&&!E._state.vcFired}).map(function(E){return E.on("versionchange").fire(b)})},this.use(gc),this.use(_c),this.use(yc),this.use(hc),this.use(mc),new Proxy(this,{get:function(b,E,T){var S;return E==="_vip"||(E==="table"?function(w){return Gr(m.table(w),k)}:(S=Reflect.get(b,E,T))instanceof Ra?Gr(S,k):E==="tables"?S.map(function(w){return Gr(w,k)}):E==="_createTransaction"?function(){return Gr(S.apply(this,arguments),k)}:S)}}));this.vip=k,x.forEach(function(b){return b(m)})}var Yr,Wn=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",wc=(Bo.prototype.subscribe=function(r,a,i){return this._subscribe(r&&typeof r!="function"?r:{next:r,error:a,complete:i})},Bo.prototype[Wn]=function(){return this},Bo);function Bo(r){this._subscribe=r}try{Yr={indexedDB:c.indexedDB||c.mozIndexedDB||c.webkitIndexedDB||c.msIndexedDB,IDBKeyRange:c.IDBKeyRange||c.webkitIDBKeyRange}}catch{Yr={indexedDB:null,IDBKeyRange:null}}function rs(r){var a,i=!1,u=new wc(function(l){var f=De(r),p,m=!1,x={},A={},k={get closed(){return m},unsubscribe:function(){m||(m=!0,p&&p.abort(),b&&pn.storagemutated.unsubscribe(T))}},b=(l.start&&l.start(k),!1),E=function(){return U(S)},T=function(w){Wr(x,w),zo(A,x)&&E()},S=function(){var w,j,N;!m&&Yr.indexedDB&&(x={},w={},p&&p.abort(),p=new AbortController,N=(O=>{var M=dn();try{f&&tt();var F=Mt(r,O);return F=f?F.finally(zt):F}finally{M&&Qt()}})(j={subscr:w,signal:p.signal,requery:E,querier:r,trans:null}),Promise.resolve(N).then(function(O){i=!0,a=O,m||j.signal.aborted||(x={},(M=>{for(var F in M)if(P(M,F))return;return 1})(A=w)||b||(pn(fr,T),b=!0),U(function(){return!m&&l.next&&l.next(O)}))},function(O){i=!1,["DatabaseClosedError","AbortError"].includes(O==null?void 0:O.name)||m||U(function(){m||l.error&&l.error(O)})}))};return setTimeout(E,0),k});return u.hasValue=function(){return i},u.getValue=function(){return a},u}var Nn=en;function qo(r){var a=hn;try{hn=!0,pn.storagemutated.fire(r),$o(r,!0)}finally{hn=a}}$(Nn,o(o({},ft),{delete:function(r){return new Nn(r,{addons:[]}).delete()},exists:function(r){return new Nn(r,{addons:[]}).open().then(function(a){return a.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(r){try{return a=Nn.dependencies,i=a.indexedDB,a=a.IDBKeyRange,(Po(i)?Promise.resolve(i.databases()).then(function(u){return u.map(function(l){return l.name}).filter(function(l){return l!==pt})}):No(i,a).toCollection().primaryKeys()).then(r)}catch{return H(new se.MissingAPI)}var a,i},defineClass:function(){return function(r){g(this,r)}},ignoreTransaction:function(r){return oe.trans?ie(oe.transless,r):r()},vip:Co,async:function(r){return function(){try{var a=Fo(r.apply(this,arguments));return a&&typeof a.then=="function"?a:G.resolve(a)}catch(i){return H(i)}}},spawn:function(r,a,i){try{var u=Fo(r.apply(i,a||[]));return u&&typeof u.then=="function"?u:G.resolve(u)}catch(l){return H(l)}},currentTransaction:{get:function(){return oe.trans||null}},waitFor:function(r,a){return r=G.resolve(typeof r=="function"?Nn.ignoreTransaction(r):r).timeout(a||6e4),oe.trans?oe.trans.waitFor(r):r},Promise:G,debug:{get:function(){return st},set:function(r){or(r)}},derive:re,extend:g,props:$,override:W,Events:ur,on:pn,liveQuery:rs,extendObservabilitySet:Wr,getByKeyPath:ae,setByKeyPath:ce,delByKeyPath:function(r,a){typeof a=="string"?ce(r,a,void 0):"length"in a&&[].map.call(a,function(i){ce(r,i,void 0)})},shallowClone:me,deepClone:Ye,getObjectDiff:Zo,cmp:ge,asap:q,minKey:-1/0,addons:[],connections:Ue,errnames:gt,dependencies:Yr,cache:Dn,semVer:"4.3.0",version:"4.3.0".split(".").map(function(r){return parseInt(r)}).reduce(function(r,a,i){return r+a/Math.pow(10,2*i)})})),Nn.maxKey=pr(Nn.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(pn(fr,function(r){hn||(r=new CustomEvent(Eo,{detail:r}),hn=!0,dispatchEvent(r),hn=!1)}),addEventListener(Eo,function(r){r=r.detail,hn||qo(r)}));var Vn,hn=!1,os=function(){};return typeof BroadcastChannel<"u"&&((os=function(){(Vn=new BroadcastChannel(Eo)).onmessage=function(r){return r.data&&qo(r.data)}})(),typeof Vn.unref=="function"&&Vn.unref(),pn(fr,function(r){hn||Vn.postMessage(r)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(r){if(!en.disableBfCache&&r.persisted){st&&console.debug("Dexie: handling persisted pagehide"),Vn!=null&&Vn.close();for(var a=0,i=Ue;a<i.length;a++)i[a].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(r){!en.disableBfCache&&r.persisted&&(st&&console.debug("Dexie: handling persisted pageshow"),os(),qo({all:new nt(-1/0,[[]])}))})),G.rejectionMapper=function(r,a){return!r||r instanceof $t||r instanceof TypeError||r instanceof SyntaxError||!r.name||!wt[r.name]?r:(a=new wt[r.name](a||r.message,r),"stack"in r&&Y(a,"stack",{get:function(){return this.inner.stack}}),a)},or(st),o(en,Object.freeze({__proto__:null,Dexie:en,Entity:Na,PropModification:cr,RangeSet:nt,add:function(r){return new cr({add:r})},cmp:ge,default:en,liveQuery:rs,mergeRanges:gr,rangesOverlap:Wa,remove:function(r){return new cr({remove:r})},replacePrefix:function(r,a){return new cr({replacePrefix:[r,a]})}}),{default:en}),en})})(qi);var ah=qi.exports;const fa=Oc(ah),Zs=Symbol.for("Dexie"),ho=globalThis[Zs]||(globalThis[Zs]=fa);if(fa.semVer!==ho.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${fa.semVer} and ${ho.semVer}`);const{liveQuery:mg,mergeRanges:gg,rangesOverlap:yg,RangeSet:vg,cmp:bg,Entity:_g,PropModification:wg,replacePrefix:xg,add:kg,remove:Sg,DexieYProvider:Eg}=ho,Wt=new ho("FynessOS");Wt.version(1).stores({os_orders:"id, status, priority, assignee, project_id, type, created_at, updated_at",os_sectors:"id, label",os_projects:"id, name, sector_id",os_comments:"id, order_id, created_at",os_time_entries:"id, order_id, user_name, created_at",os_templates:"id, name",team_members:"id, name, email, auth_user_id",agenda_events:"id, start_date, type, assignee",notifications:"id, user_id, is_read, created_at",activity_logs:"id, entity_type, entity_id, created_at",kpi_snapshots:"id, period, user_name",report_schedules:"id, user_id, is_active",companies:"id, name",projects:"id, name, company_id",pending_sync:"id, table_name, operation, created_at"});Wt.version(2).stores({clients:"id, name, email, company"});Wt.version(3).stores({eap_undo_history:"id"});async function pa(e,t){try{const n=Wt.table(e);await n.clear(),t&&t.length>0&&await n.bulkPut(t)}catch(n){console.warn(`[OfflineDB] Erro ao salvar ${e}:`,n);try{localStorage.setItem(e,JSON.stringify(t))}catch{}}}async function Tt(e){try{return await Wt.table(e).toArray()}catch(t){console.warn(`[OfflineDB] Erro ao ler ${e}:`,t);try{return JSON.parse(localStorage.getItem(e)||"[]")}catch{return[]}}}async function Qn(e,t){try{await Wt.table(e).put(t)}catch(n){console.warn(`[OfflineDB] Erro ao salvar item em ${e}:`,n)}}async function Ks(e,t){try{await Wt.table(e).delete(t)}catch(n){console.warn(`[OfflineDB] Erro ao remover de ${e}:`,n)}}async function na(e,t,n="upsert"){try{await Wt.table("pending_sync").put({id:`${e}_${t}`,table_name:e,item_id:t,operation:n,created_at:new Date().toISOString()})}catch(o){console.warn("[OfflineDB] Erro ao marcar pendingSync:",o)}}async function sh(){try{return await Wt.table("pending_sync").toArray()}catch{return[]}}async function Us(e,t){try{await Wt.table("pending_sync").delete(`${e}_${t}`)}catch(n){console.warn("[OfflineDB] Erro ao limpar pendingSync:",n)}}function Bs(e,t){const n={};for(const[o,s]of Object.entries(t))e[o]!==void 0&&(n[s]=e[o]);return n}function ih(e){return`${e}_${Date.now()}`}const Hi=[];function ch(e){Hi.push(e)}async function uh(){let e=0;for(const t of Hi)e+=await t.syncPending();e>0&&Gn(`${e} item(ns) sincronizado(s) com o servidor`,"success")}typeof window<"u"&&window.addEventListener("online",()=>{console.log("[Sync] Conexao restaurada, sincronizando..."),uh()});function bt(e){const{table:t,localKey:n,idPrefix:o,transform:s,fieldMap:c,schema:d,orderBy:h="created_at",orderAsc:g=!0}=e;async function v(){const{data:L,error:W}=await he.from(t).select("*").order(h,{ascending:g});if(W){console.error(`[${t}] GET ALL erro:`,W.message,W.code,W.details,W.hint),Gn(`Offline [${t}]: ${W.message}`,"warning");const R=await Tt(t);return s?R.map(q=>s(q)||q):R}return pa(t,L||[]),s?(L||[]).map(s):L||[]}async function I(L=1,W=20,R={}){const q=(L-1)*W,ae=q+W-1;let ce=he.from(t).select("*",{count:"exact"}).order(h,{ascending:g}).range(q,ae);for(const[ye,We]of Object.entries(R))We!=null&&We!==""&&(ce=ce.eq(ye,We));const{data:me,error:Ee,count:Te}=await ce;if(Ee){Gn("Modo offline  usando dados locais","warning");const ye=await Tt(t),We=ye.slice(q,ae+1);return{data:s?We.map(Ye=>s(Ye)||Ye):We,count:ye.length,page:L,pageSize:W,totalPages:Math.ceil(ye.length/W)}}return{data:s?(me||[]).map(s):me||[],count:Te||0,page:L,pageSize:W,totalPages:Math.ceil((Te||0)/W)}}async function P(L){const{data:W,error:R}=await he.from(t).select("*").eq("id",L).single();if(R){const ae=(await Tt(t)).find(ce=>ce.id===L);return ae?s?s(ae):ae:null}return s?s(W):W}async function $(L,W={}){if(d){const me=rh(d,L);if(!me.success)return Gn(me.error,"error"),null;L=me.data}const R=new Date().toISOString(),q={id:ih(o),...Bs(L,c),...W},{data:ae,error:ce}=await he.from(t).insert([q]).select().single();if(ce){console.error(`[${t}] CREATE erro:`,ce.message,ce.code,ce.details,ce.hint);const me={...q,created_at:R,updated_at:R};return await Qn(t,me),await na(t,me.id,"upsert"),Gn(`Salvo localmente: ${ce.message||"sem conexao"}`,"warning"),s?s(me):me}return ae&&await Qn(t,ae),s?s(ae):ae}async function C(L,W){if(d){const ce=oh(d,W);if(!ce.success)return Gn(ce.error,"error"),null;W=ce.data}const R={updated_at:new Date().toISOString(),...Bs(W,c)},{data:q,error:ae}=await he.from(t).update(R).eq("id",L).select().single();if(ae){console.error(`[${t}] UPDATE erro:`,ae.message,ae.code,ae.details,ae.hint);const me=(await Tt(t)).find(Ee=>Ee.id===L);if(me){const Ee={...me,...R};return await Qn(t,Ee),await na(t,L,"upsert"),s?s(Ee):Ee}return null}return q&&await Qn(t,q),s?s(q):q}async function Y(L){const{error:W}=await he.from(t).delete().eq("id",L);return W?(await Ks(t,L),await na(t,L,"delete")):await Ks(t,L),!W}async function re(L,W,R,q){const ae={[L]:W,updated_at:new Date().toISOString()},{error:ce}=await he.from(t).update(ae).eq(R,q);if(ce){const Ee=(await Tt(t)).map(Te=>Te[R]===q?{...Te,...ae}:Te);await pa(t,Ee)}}async function D(){const W=(await sh()).filter(q=>q.table_name===t);let R=0;for(const q of W)if(q.operation==="delete"){const{error:ae}=await he.from(t).delete().eq("id",q.item_id);ae||(R++,await Us(t,q.item_id))}else{const ce=(await Tt(t)).find(me=>me.id===q.item_id);if(ce){const{error:me}=await he.from(t).upsert([ce],{onConflict:"id"});me||(R++,await Us(t,q.item_id))}}return R}const Z={getAll:v,getPaginated:I,getById:P,create:$,update:C,remove:Y,bulkUpdate:re,syncPending:D};return ch(Z),Z}let ra=null;function lh(){return ra||(ra=ai("https://ydiwxlrkrmygpdfacpkt.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkaXd4bHJrcm15Z3BkZmFjcGt0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAwNzAwMTIsImV4cCI6MjA4NTY0NjAxMn0.uMqOpfKiRSpyaG0Da47KZWI5rOm7_Negsd5VU8J8RiI",{auth:{storageKey:"supabase-admin-ops",persistSession:!1,autoRefreshToken:!1,detectSessionInUrl:!1}})),ra}async function Tg(e,t,n,o="collaborator"){var s;try{const c=lh(),{data:d,error:h}=await c.auth.signUp({email:e,password:t,options:{data:{full_name:n}}});if(h)throw h;const g=((s=d.user)==null?void 0:s.id)||null;if(g){if(await new Promise(I=>setTimeout(I,500)),o!=="collaborator"){const{error:I}=await c.from("profiles").update({role:o}).eq("id",g);I&&(console.warn("Aviso: nao foi possivel definir role no profiles:",I.message),await new Promise(P=>setTimeout(P,1e3)),await c.from("profiles").update({role:o}).eq("id",g))}const{error:v}=await c.from("user_profiles").upsert([{id:g,name:n,email:e,role:o==="manager"?"Gestor":"",updated_at:new Date().toISOString()}],{onConflict:"id"});v&&(console.warn("user_profiles upsert falhou no isolated client, tentando com client principal:",v.message),await he.from("user_profiles").upsert([{id:g,name:n,email:e,role:o==="manager"?"Gestor":"",updated_at:new Date().toISOString()}],{onConflict:"id"}))}return{success:!0,userId:g}}catch(c){return{success:!1,error:c.message}}}async function Og(e,t){try{const{error:n}=await he.rpc("set_user_role",{target_user_id:e,new_role:t});if(!n)return{success:!0};const{error:o}=await he.from("profiles").update({role:t}).eq("id",e);return o?(console.error("Erro ao atualizar role do profile:",o.message),{success:!1,error:o.message}):{success:!0}}catch(n){return{success:!1,error:n.message}}}function dh(e){return e?{id:e.id,name:e.name,colorIndex:e.color_index,image:e.image||null,createdAt:e.created_at}:null}function fh(e){return e?{id:e.id,name:e.name,xml:e.xml,companyId:e.company_id,parentId:e.parent_id,level:e.level,isRoot:e.is_root,isTemplate:e.is_template,createdAt:e.created_at,updatedAt:e.updated_at}:null}const vo=bt({table:"companies",localKey:"bpmn_companies",idPrefix:"local_company",transform:dh,fieldMap:{name:"name",colorIndex:"color_index",image:"image"}}),Ag=vo.getAll,jg=e=>vo.create(e),Ig=(e,t)=>vo.update(e,t),Dg=e=>vo.remove(e),Ir=bt({table:"projects",localKey:"bpmn_projects",idPrefix:"local",transform:fh,fieldMap:{name:"name",xml:"xml",companyId:"company_id",parentId:"parent_id",level:"level",isRoot:"is_root",isTemplate:"is_template"}}),Ng=Ir.getAll,Pg=e=>Ir.getById(e),Cg=e=>Ir.create(e),Mg=(e,t)=>Ir.update(e,t),zg=e=>Ir.remove(e),Wi=ee.createContext({}),Aa=()=>{const e=ee.useContext(Wi);if(!e)throw new Error("useAuth deve ser usado dentro de AuthProvider");return e};function ph({children:e}){const[t,n]=ee.useState(null),[o,s]=ee.useState(null),[c,d]=ee.useState(!0),[h,g]=ee.useState(null),v=async Z=>{try{const L=new Promise((ae,ce)=>setTimeout(()=>ce(new Error("Timeout ao buscar perfil")),5e3)),W=he.from("profiles").select("*").eq("id",Z).single(),{data:R,error:q}=await Promise.race([W,L]);if(q)throw q;return s(R),R}catch(L){return console.error("Erro ao buscar perfil:",L),null}};ee.useEffect(()=>{(async()=>{try{const{data:{session:W}}=await he.auth.getSession();W!=null&&W.user&&(n(W.user),await v(W.user.id))}catch(W){console.error("Erro ao inicializar auth:",W),g(W.message)}finally{d(!1)}})();const{data:{subscription:L}}=he.auth.onAuthStateChange(async(W,R)=>{console.log("Auth state changed:",W),R!=null&&R.user?(n(R.user),await v(R.user.id)):(n(null),s(null)),d(!1)});return()=>{L==null||L.unsubscribe()}},[]);const I=async(Z,L)=>{try{g(null);const{data:W,error:R}=await he.auth.signInWithPassword({email:Z,password:L});if(R)throw R;return{success:!0,data:W}}catch(W){const R=W.message||"Erro ao fazer login",q=R.includes("Invalid login credentials")?"Email ou senha incorretos":R.includes("Email not confirmed")?"Email ainda nao confirmado. Verifique sua caixa de entrada.":R.includes("Too many requests")?"Muitas tentativas. Aguarde alguns minutos.":R.includes("User not found")?"Usuario nao encontrado":R.includes("Network")||R.includes("fetch")?"Erro de conexao. Verifique sua internet.":R;return g(q),{success:!1,error:q}}},P=async(Z,L,W)=>{try{g(null);const{data:R,error:q}=await he.auth.signUp({email:Z,password:L,options:{data:{full_name:W}}});if(q)throw q;return{success:!0,data:R}}catch(R){return g(R.message),{success:!1,error:R.message}}},$=async()=>{try{g(null);const{data:Z,error:L}=await he.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}});if(L)throw L;return{success:!0,data:Z}}catch(Z){return g(Z.message),{success:!1,error:Z.message}}},C=async()=>{try{g(null);const{error:Z}=await he.auth.signOut();if(Z)throw Z;return n(null),s(null),{success:!0}}catch(Z){return g(Z.message),{success:!1,error:Z.message}}},Y=async Z=>{try{if(g(null),!t)throw new Error("Usuario nao autenticado");const{data:L,error:W}=await he.from("profiles").update(Z).eq("id",t.id).select().single();if(W)throw W;return s(L),{success:!0,data:L}}catch(L){return g(L.message),{success:!1,error:L.message}}},re=async Z=>{try{g(null);const{error:L}=await he.auth.resetPasswordForEmail(Z,{redirectTo:`${window.location.origin}/reset-password`});if(L)throw L;return{success:!0}}catch(L){return g(L.message),{success:!1,error:L.message}}},D={user:t,profile:o,loading:c,error:h,isAuthenticated:!!t,isAdmin:(o==null?void 0:o.role)==="admin",isManager:(o==null?void 0:o.role)==="manager"||(o==null?void 0:o.role)==="admin",signIn:I,signUp:P,signInWithGoogle:$,signOut:C,updateProfile:Y,resetPassword:re,refreshProfile:()=>t&&v(t.id)};return y.jsx(Wi.Provider,{value:D,children:e})}const hh=["gestor","admin","gerente","manager","diretor","supervisor","coordenador"];function Vi(e){if(!e||!e.role)return"collaborator";const t=e.role.toLowerCase().trim();return hh.some(n=>t.includes(n))?"manager":"collaborator"}function Rg(e){return Vi(e)==="manager"}const Ji=ee.createContext({}),mh=()=>{const e=ee.useContext(Ji);if(!e)throw new Error("usePermissions deve ser usado dentro de PermissionProvider");return e};function gh({children:e}){const{user:t,profile:n,loading:o}=Aa(),[s,c]=ee.useState([]),[d,h]=ee.useState(!0),g={admin:[{name:"*",module:"*"}],member:[{name:"sales.view",module:"sales"},{name:"agenda.view",module:"agenda"},{name:"agenda.edit",module:"agenda"},{name:"os.view",module:"os"},{name:"os.create",module:"os"},{name:"os.edit",module:"os"}]},I=Vi(n)==="manager"||(n==null?void 0:n.role)==="admin"?"admin":"member",P=ee.useCallback(async()=>{if(!(n!=null&&n.role)){c([]),h(!1);return}try{const{data:R,error:q}=await he.rpc("get_user_permissions");q||!R||R.length===0?c(g[I]||g.member):c(R)}catch{c(g[I]||g.member)}finally{h(!1)}},[I]);ee.useEffect(()=>{o||P()},[o,P]);const $=I==="admin"||s.some(R=>R.name==="*"),C=ee.useCallback(R=>$?!0:s.some(q=>q.name===R||q.permission_name===R),[s,$]),Y=ee.useCallback(R=>$?!0:R.some(q=>C(q)),[C,$]),re=ee.useCallback(R=>$?!0:R.every(q=>C(q)),[C,$]),D=ee.useCallback(R=>$?!0:s.some(q=>q.module===R||q.name&&q.name.startsWith(`${R}.`)),[s,$]),Z=ee.useCallback(()=>C("financial.view_costs"),[C]),L=ee.useCallback(()=>C("financial.view_salaries"),[C]),W={permissions:s,loading:d||o,hasPermission:C,hasAnyPermission:Y,hasAllPermissions:re,canAccessModule:D,canViewCosts:Z,canViewSalaries:L,refreshPermissions:P,canAccessSales:()=>D("sales"),canAccessFinancial:()=>D("financial"),canAccessAgenda:()=>D("agenda"),canAccessOS:()=>D("os")};return y.jsx(Ji.Provider,{value:W,children:e})}const Gi=ee.createContext(null),qs="fyness_theme";function yh({children:e}){const[t,n]=ee.useState(()=>{if(typeof window>"u")return"light";const s=localStorage.getItem(qs);return s||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});ee.useEffect(()=>{const s=document.documentElement;t==="dark"?s.classList.add("dark"):s.classList.remove("dark"),localStorage.setItem(qs,t)},[t]);const o=ee.useCallback(()=>{n(s=>s==="dark"?"light":"dark")},[]);return y.jsx(Gi.Provider,{value:{theme:t,toggleTheme:o,isDark:t==="dark"},children:e})}function vh(){const e=ee.useContext(Gi);return e||{theme:"light",toggleTheme:()=>{},isDark:!1}}let Cn=null,Sr=null;function bh(){"serviceWorker"in navigator&&(window.addEventListener("load",async()=>{try{const e=await navigator.serviceWorker.getRegistrations();for(const o of e)await o.unregister();const t=await caches.keys();for(const o of t)await caches.delete(o);if(e.length>0||t.length>0){console.log("SW/Caches antigos limpos, recarregando..."),window.location.reload();return}const n=await navigator.serviceWorker.register("/sw.js");console.log("SW registrado:",n.scope),setInterval(()=>n.update(),60*60*1e3)}catch(e){console.log("SW registro falhou:",e)}}),window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),Cn=e,Sr&&Sr(!0)}),window.addEventListener("appinstalled",()=>{Cn=null,Sr&&Sr(!1)}))}function _h(){return Cn!==null}async function wh(){if(!Cn)return!1;Cn.prompt();const{outcome:e}=await Cn.userChoice;return Cn=null,e==="accepted"}function xh(e){Sr=e}function kh(){return window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0}const ha="/assets/logo-fyness-l7YroKwq.png";function Sh(){const[e,t]=ee.useState(!1),[n,o]=ee.useState(!1);ee.useEffect(()=>{kh()||localStorage.getItem("pwa_dismissed")!=="true"&&(_h()&&t(!0),xh(d=>{t(d)}))},[]);const s=async()=>{await wh()&&t(!1)},c=()=>{o(!0),t(!1),localStorage.setItem("pwa_dismissed","true")};return!e||n?null:y.jsx("div",{className:"fixed bottom-4 left-4 right-4 sm:left-auto sm:right-4 sm:w-96 z-50 animate-in slide-in-from-bottom",children:y.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl border border-slate-200 dark:border-slate-700 p-4",children:[y.jsxs("div",{className:"flex items-start gap-3",children:[y.jsx("img",{src:ha,alt:"Fyness",className:"w-10 h-10 object-contain shrink-0"}),y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsx("h3",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100",children:"Instalar Fyness OS?"}),y.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:"Acesse rapidamente a partir da tela inicial do seu dispositivo."})]}),y.jsx("button",{onClick:c,className:"text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300 shrink-0",children:y.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),y.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[y.jsx("button",{onClick:s,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors",children:"Instalar"}),y.jsx("button",{onClick:c,className:"px-4 py-2 text-sm text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:"Agora nao"})]})]})})}const Eh="modulepreload",Th=function(e){return"/"+e},Hs={},Vt=function(t,n,o){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));s=Promise.allSettled(n.map(g=>{if(g=Th(g),g in Hs)return;Hs[g]=!0;const v=g.endsWith(".css"),I=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${I}`))return;const P=document.createElement("link");if(P.rel=v?"stylesheet":Eh,v||(P.as="script"),P.crossOrigin="",P.href=g,h&&P.setAttribute("nonce",h),document.head.appendChild(P),v)return new Promise(($,C)=>{P.addEventListener("load",$),P.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${g}`)))})}))}function c(d){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=d,window.dispatchEvent(h),!h.defaultPrevented)throw d}return s.then(d=>{for(const h of d||[])h.status==="rejected"&&c(h.reason);return t().catch(c)})};class tn extends ee.Component{constructor(n){super(n);Wo(this,"handleReload",()=>{this.setState({hasError:!1,error:null}),window.location.reload()});Wo(this,"handleRetry",()=>{this.setState({hasError:!1,error:null})});this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,o){console.error("ErrorBoundary capturou erro:",n,o)}render(){return this.state.hasError?y.jsx("div",{className:"flex items-center justify-center min-h-screen bg-slate-50 dark:bg-slate-950",children:y.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[y.jsx("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:y.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),y.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 mb-2",children:"Algo deu errado"}),y.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6",children:"Ocorreu um erro inesperado. Tente novamente ou recarregue a pagina."}),y.jsxs("div",{className:"flex items-center justify-center gap-3",children:[y.jsx("button",{onClick:this.handleRetry,className:"px-4 py-2 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Tentar novamente"}),y.jsx("button",{onClick:this.handleReload,className:"px-4 py-2 text-sm font-medium bg-white dark:bg-slate-800 text-slate-700 dark:text-slate-200 rounded-lg border border-slate-200 dark:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors",children:"Recarregar pagina"})]}),this.state.error&&y.jsxs("details",{className:"mt-6 text-left",children:[y.jsx("summary",{className:"text-xs text-slate-400 cursor-pointer hover:text-slate-600 dark:hover:text-slate-300",children:"Detalhes do erro"}),y.jsx("pre",{className:"mt-2 p-3 bg-slate-100 dark:bg-slate-800 rounded-lg text-xs text-slate-600 dark:text-slate-300 overflow-auto max-h-32",children:this.state.error.toString()})]})]})}):this.props.children}}function Ws({permission:e,permissions:t,requireAll:n=!1,roles:o,redirectTo:s="/login"}){const{isAuthenticated:c,loading:d,profile:h}=Aa(),{hasPermission:g,hasAnyPermission:v,hasAllPermissions:I,loading:P}=mh(),$=va();return d||P?y.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-950",children:y.jsxs("div",{className:"text-center",children:[y.jsx("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),y.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Carregando..."})]})}):c?o&&o.length>0&&(!(h!=null&&h.role)||!o.includes(h.role))?y.jsx(xr,{to:"/unauthorized",replace:!0}):e&&!g(e)?y.jsx(xr,{to:"/unauthorized",replace:!0}):t&&t.length>0&&!(n?I(t):v(t))?y.jsx(xr,{to:"/unauthorized",replace:!0}):y.jsx(oi,{}):y.jsx(xr,{to:s,state:{from:$},replace:!0})}function ao(e){return e?{id:e.id||"",name:e.name||"",email:e.email||"",phone:e.phone||"",role:e.role||"",bio:e.bio||"",avatar:e.avatar||null,cpf:e.cpf||"",companyId:e.company_id||"",salaryMonth:e.salary_month||"",hoursMonth:e.hours_month||176,startDate:e.start_date||""}:{}}async function Yi(){const{data:{user:e}}=await he.auth.getUser();return{id:(e==null?void 0:e.id)||null,email:(e==null?void 0:e.email)||null}}function Tr(e){return`settings_profile_${e||"default"}`}async function Oh(){const{id:e,email:t}=await Yi();if(!e)try{return JSON.parse(localStorage.getItem("settings_profile_default")||"{}")}catch{return{}}const n={id:e,name:"",email:"",phone:"",role:"",bio:"",avatar:null,cpf:"",companyId:"",salaryMonth:"",hoursMonth:176,startDate:""};try{const{data:o,error:s}=await he.from("user_profiles").select("*").eq("id",e).single();if(!s&&o&&o.name)return ao(o);const{data:c}=await he.from("profiles").select("full_name, email, role").eq("id",e).single();let d=null;const{data:h}=await he.from("team_members").select("name, role, salary_month, hours_month, email").eq("auth_user_id",e).single();d=h;const g=(c==null?void 0:c.email)||t;if(!d&&g){const{data:P}=await he.from("team_members").select("name, role, salary_month, hours_month, email").eq("email",g).single();d=P}const v=(c==null?void 0:c.full_name)||(d==null?void 0:d.name)||"",I=(d==null?void 0:d.email)||(c==null?void 0:c.email)||t||"";if(v){const P={id:e,name:v,email:I,role:(d==null?void 0:d.role)||"",salary_month:(d==null?void 0:d.salary_month)||null,hours_month:(d==null?void 0:d.hours_month)||176,updated_at:new Date().toISOString()};await he.from("user_profiles").upsert([P],{onConflict:"id"});const $=ao(P);return localStorage.setItem(Tr(e),JSON.stringify($)),localStorage.setItem("settings_profile",JSON.stringify($)),$}if(o){const P=ao(o);return{...n,...P,id:e}}try{const P=JSON.parse(localStorage.getItem(Tr(e))||"{}");return{...n,...P,id:e}}catch{return n}}catch(o){console.error("Erro ao buscar profile:",o);try{const s=JSON.parse(localStorage.getItem(Tr(e))||"{}");return{...n,...s,id:e}}catch{return n}}}async function Lg(e){const{id:t}=await Yi(),n=t||e.id||"default",o={id:n,name:e.name||null,email:e.email||null,phone:e.phone||null,role:e.role||null,cpf:e.cpf||null,bio:e.bio||null,avatar:e.avatar||null,company_id:e.companyId||null,salary_month:e.salaryMonth||null,hours_month:e.hoursMonth||176,start_date:e.startDate||null,updated_at:new Date().toISOString()},{data:s,error:c}=await he.from("user_profiles").upsert([o],{onConflict:"id"}).select().single();if(c)return console.log(" Supabase nao conectado, salvando perfil no localStorage"),localStorage.setItem(Tr(n),JSON.stringify(e)),localStorage.setItem("settings_profile",JSON.stringify(e)),window.dispatchEvent(new Event("profile-updated")),e;const d=ao(s);return localStorage.setItem(Tr(n),JSON.stringify(d)),localStorage.setItem("settings_profile",JSON.stringify(d)),window.dispatchEvent(new Event("profile-updated")),d}const Ah=()=>y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),jh=()=>y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),Ih=()=>y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),Dh=()=>y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),Nh=()=>y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),Ph=()=>y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),Ch=()=>y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h10M4 14h14M4 18h8"})}),Mh=()=>y.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),zh=()=>y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})});function mn({to:e,icon:t,label:n,isCollapsed:o,badge:s}){const c=va(),d=c.pathname===e||c.pathname.startsWith(e+"/");return y.jsxs(Ac,{to:e,"aria-current":d?"page":void 0,"aria-label":n,className:`
        flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-200
        ${d?"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 font-medium":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-slate-100"}
        ${o?"justify-center":""}
      `,title:o?n:void 0,children:[y.jsx(t,{}),!o&&y.jsxs(y.Fragment,{children:[y.jsx("span",{className:"flex-1",children:n}),s&&y.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 rounded-full",children:s})]})]})}function Rh(){const{signOut:e}=Aa(),t=ba(),[n,o]=ee.useState(!0),[s,c]=ee.useState(!1),[d,h]=ee.useState({}),g=async()=>{const I=await Oh();h(I)};ee.useEffect(()=>{g()},[]),ee.useEffect(()=>{const I=()=>g();return window.addEventListener("storage",I),window.addEventListener("profile-updated",I),()=>{window.removeEventListener("storage",I),window.removeEventListener("profile-updated",I)}},[]);const v=async()=>{await e(),t("/login")};return y.jsxs("aside",{onMouseEnter:()=>o(!1),onMouseLeave:()=>o(!0),className:`
        flex flex-col bg-white dark:bg-slate-900 border-r border-slate-200 dark:border-slate-700 transition-all duration-300 h-screen sticky top-0
        ${n?"w-16":"w-64"}
      `,children:[y.jsx("div",{className:"h-16 flex items-center justify-center px-4 border-b border-slate-200 dark:border-slate-700",children:n?y.jsx("img",{src:ha,alt:"Fyness",className:"w-8 h-8 object-contain"}):y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("img",{src:ha,alt:"Fyness",className:"w-8 h-8 object-contain"}),y.jsx("span",{className:"font-bold text-slate-800 dark:text-slate-100",children:"Fyness OS"})]})}),y.jsxs("nav",{className:"flex-1 p-3 space-y-1 overflow-y-auto",role:"navigation","aria-label":"Menu principal",children:[y.jsx(mn,{to:"/dashboard",icon:Ah,label:"Dashboard",isCollapsed:n}),y.jsx(mn,{to:"/financial",icon:Nh,label:"Ordens de Servico",isCollapsed:n}),y.jsx(mn,{to:"/agenda",icon:Dh,label:"Agenda",isCollapsed:n}),y.jsx(mn,{to:"/routine",icon:Ih,label:"Minha Rotina",isCollapsed:n}),y.jsx(mn,{to:"/eap",icon:Ch,label:"EAP",isCollapsed:n}),y.jsx("div",{className:"my-4 border-t border-slate-200 dark:border-slate-700"}),y.jsx(mn,{to:"/sales",icon:jh,label:"Processos",isCollapsed:n}),y.jsx(mn,{to:"/reports",icon:Ph,label:"Relatorios",isCollapsed:n}),y.jsx(mn,{to:"/settings",icon:Mh,label:"Configuracoes",isCollapsed:n})]}),y.jsx("div",{className:"p-3 border-t border-slate-200 dark:border-slate-700",children:y.jsxs("div",{className:"relative",children:[y.jsxs("button",{onClick:()=>c(!s),"aria-label":"Menu do usuario","aria-expanded":s,"aria-haspopup":"true",className:`
              w-full flex items-center gap-3 p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors
              ${n?"justify-center":""}
            `,children:[d.avatar?y.jsx("img",{src:d.avatar,alt:"",className:"w-9 h-9 rounded-full object-cover shrink-0"}):y.jsx("div",{className:"w-9 h-9 rounded-full bg-gradient-to-br from-blue-500 to-blue-700 flex items-center justify-center text-white font-medium shrink-0",children:(d.name||"U").charAt(0).toUpperCase()}),!n&&y.jsxs("div",{className:"flex-1 text-left",children:[y.jsx("div",{className:"text-sm font-medium text-slate-800 dark:text-slate-100 truncate",children:d.name||"Sem nome"}),y.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 truncate",children:d.role||"Sem cargo"})]})]}),s&&y.jsxs("div",{className:`
              absolute bottom-full mb-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-600 rounded-lg shadow-lg py-1 z-50
              ${n?"left-0":"left-0 right-0"}
            `,children:[y.jsx("button",{onClick:()=>{c(!1),t("/settings")},className:"w-full px-4 py-2 text-left text-sm text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700",children:"Meu Perfil"}),y.jsxs("button",{onClick:v,className:"w-full px-4 py-2 text-left text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-2",children:[y.jsx(zh,{}),"Sair"]})]})]})})]})}function Lh(e){return e?{id:e.id,number:e.number,title:e.title,description:e.description||"",checklist:Array.isArray(e.checklist)?e.checklist:[],priority:e.priority||"medium",status:e.status||"available",category:e.category||"internal",blockReason:e.block_reason||null,client:e.client||"",clientId:e.client_id||null,location:e.location||"",notes:e.notes||"",assignee:e.assignee||null,assignedTo:e.assigned_to||null,sortOrder:e.sort_order??0,estimatedStart:e.estimated_start||"",estimatedEnd:e.estimated_end||"",actualStart:e.actual_start||"",actualEnd:e.actual_end||"",slaDeadline:e.sla_deadline||null,leadTimeHours:e.lead_time_hours||null,attachments:Array.isArray(e.attachments)?e.attachments:[],expenses:Array.isArray(e.expenses)?e.expenses:[],projectId:e.project_id||null,type:e.type||"normal",parentOrderId:e.parent_order_id||null,emergencyNumber:e.emergency_number||null,createdAt:e.created_at,updatedAt:e.updated_at}:null}function $h(e){return e?{id:e.id,name:e.name,sector:e.sector_id||"",color:e.color||"#3b82f6",description:e.description||"",createdAt:e.created_at,updatedAt:e.updated_at}:null}function Fh(e){return e?{id:e.id,label:e.label,color:e.color||"#3b82f6"}:null}const bo=bt({table:"os_sectors",localKey:"os_sectors",idPrefix:"sector",transform:Fh,schema:Xp,fieldMap:{label:"label",color:"color"}}),Zh=bo.getAll,$g=e=>{const t=e.id||e.label.trim().toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9_]/g,"")+"_"+Date.now();return bo.create(e,{id:t})},Fg=(e,t)=>bo.update(e,t),Zg=e=>bo.remove(e),Dr=bt({table:"os_projects",localKey:"os_projects",idPrefix:"proj",transform:$h,schema:Qp,fieldMap:{name:"name",sector:"sector_id",color:"color",description:"description"}}),Xi=Dr.getAll,Kh=e=>Dr.create(e),Kg=(e,t)=>Dr.update(e,t),Ug=e=>Dr.remove(e),nr=bt({table:"os_orders",localKey:"os_orders",idPrefix:"os",transform:Lh,schema:Jp,fieldMap:{number:"number",title:"title",description:"description",checklist:"checklist",priority:"priority",status:"status",category:"category",blockReason:"block_reason",client:"client",clientId:"client_id",location:"location",notes:"notes",assignee:"assignee",assignedTo:"assigned_to",sortOrder:"sort_order",estimatedStart:"estimated_start",estimatedEnd:"estimated_end",actualStart:"actual_start",actualEnd:"actual_end",slaDeadline:"sla_deadline",leadTimeHours:"lead_time_hours",attachments:"attachments",expenses:"expenses",projectId:"project_id",type:"type",parentOrderId:"parent_order_id",emergencyNumber:"emergency_number"}}),Uh=nr.getAll,Bh=(e,t)=>nr.update(e,t),Bg=e=>nr.remove(e);async function qh(){const{data:e,error:t}=await he.from("os_orders").select("number").order("number",{ascending:!1}).limit(1);return t||!e||e.length===0?JSON.parse(localStorage.getItem("os_orders")||"[]").reduce((s,c)=>Math.max(s,c.number||0),0)+1:(e[0].number||0)+1}async function Hh(){const{data:e,error:t}=await he.from("os_orders").select("emergency_number").eq("type","emergency").order("emergency_number",{ascending:!1}).limit(1);return t||!e||e.length===0?JSON.parse(localStorage.getItem("os_orders")||"[]").filter(s=>s.type==="emergency").reduce((s,c)=>Math.max(s,c.emergency_number||0),0)+1:(e[0].emergency_number||0)+1}function Wh(e){const n={urgent:4,high:24,medium:72,low:168}[e]||72,o=new Date;return o.setHours(o.getHours()+n),o.toISOString()}async function Vh(e){const t=e.slaDeadline||Wh(e.priority||"medium");if(e.type==="emergency"){const o=await Hh();return nr.create({...e,slaDeadline:t,emergencyNumber:e.emergencyNumber||o,priority:"urgent"})}const n=await qh();return nr.create({...e,slaDeadline:t,number:e.number||n})}async function qg(e){return(await Promise.all(e.map(n=>Bh(n.id,n)))).filter(Boolean)}async function Hg(e){await nr.bulkUpdate("project_id",null,"project_id",e)}async function Wg(e){await Dr.bulkUpdate("sector_id",null,"sector_id",e)}function Jh(e){return e?{id:e.id,name:e.name,role:e.role||"",color:e.color||"#3b82f6",workStart:e.work_start||"08:00",workEnd:e.work_end||"18:00",workDays:e.work_days||[1,2,3,4,5],salaryMonth:e.salary_month||0,hoursMonth:e.hours_month||176,email:e.email||"",authUserId:e.auth_user_id||null,createdAt:e.created_at,updatedAt:e.updated_at}:null}function Vg(e){if(!e)return"";const t=e.trim().split(/\s+/);return t.length<=2?e.trim():`${t[0]} ${t[t.length-1]}`}const Jg=["#3b82f6","#22c55e","#f97316","#ec4899","#8b5cf6","#eab308","#ef4444","#2563eb","#06b6d4","#84cc16","#f43f5e","#14b8a6"],_o=bt({table:"team_members",localKey:"team_members",idPrefix:"member",transform:Jh,schema:Gp,fieldMap:{name:"name",role:"role",color:"color",workStart:"work_start",workEnd:"work_end",workDays:"work_days",salaryMonth:"salary_month",hoursMonth:"hours_month",email:"email",authUserId:"auth_user_id"}}),Gh=_o.getAll,Gg=e=>_o.create(e),Yg=(e,t)=>_o.update(e,t),Xg=e=>_o.remove(e);function Yh(e){return e?{id:e.id,title:e.title,description:e.description||"",startDate:e.start_date,endDate:e.end_date,assignee:e.assignee||null,type:e.type||"task",color:e.color||"#3b82f6",attended:e.attended||!1,wasLate:e.was_late||!1,lateMinutes:e.late_minutes||0,recurrenceType:e.recurrence_type||null,recurrenceConfig:e.recurrence_config||{},recurrenceEndType:e.recurrence_end_type||"never",recurrenceEndValue:e.recurrence_end_value||null,recurrenceExceptions:e.recurrence_exceptions||[],attendees:Array.isArray(e.attendees)?e.attendees:[],notes:e.notes||"",attachments:Array.isArray(e.attachments)?e.attachments:[],createdAt:e.created_at}:null}const wo=bt({table:"agenda_events",localKey:"agenda_events",idPrefix:"evt",transform:Yh,schema:Yp,orderBy:"start_date",fieldMap:{title:"title",description:"description",startDate:"start_date",endDate:"end_date",assignee:"assignee",type:"type",color:"color",attended:"attended",wasLate:"was_late",lateMinutes:"late_minutes",recurrenceType:"recurrence_type",recurrenceConfig:"recurrence_config",recurrenceEndType:"recurrence_end_type",recurrenceEndValue:"recurrence_end_value",recurrenceExceptions:"recurrence_exceptions",attendees:"attendees",notes:"notes",attachments:"attachments"}}),Xh=wo.getAll,Qh=e=>wo.create(e),em=(e,t)=>wo.update(e,t),tm=e=>wo.remove(e);function ja(){return"Notification"in window}function nm(){return ja()?Notification.permission:"unsupported"}async function rm(){return ja()?Notification.permission==="granted"?!0:Notification.permission==="denied"?!1:await Notification.requestPermission()==="granted":!1}async function om({title:e,body:t,type:n="info",entityType:o=null,entityId:s=null,tag:c=null}){if(!ja()||Notification.permission!=="granted")return!1;const d="/icons/icon-192.svg",h=o==="os_order"&&s?"/financial":"/";if("serviceWorker"in navigator)try{return await(await navigator.serviceWorker.ready).showNotification(e||"Fyness OS",{body:t||"",icon:d,badge:d,tag:c||`fyness-${n}-${Date.now()}`,data:{url:h,entityType:o,entityId:s},vibrate:[200,100,200]}),!0}catch{}try{return new Notification(e||"Fyness OS",{body:t||"",icon:d,tag:c||`fyness-${n}-${Date.now()}`}),!0}catch{return!1}}async function Ia(){var t;const{data:{session:e}}=await he.auth.getSession();return((t=e==null?void 0:e.user)==null?void 0:t.id)||null}function so(e){return e?{id:e.id,userId:e.user_id,type:e.type||"info",title:e.title||"",message:e.message||"",entityType:e.entity_type||null,entityId:e.entity_id||null,isRead:e.is_read||!1,createdAt:e.created_at}:null}const Qi=bt({table:"notifications",localKey:"notifications",idPrefix:"notif",transform:so,fieldMap:{userId:"user_id",type:"type",title:"title",message:"message",entityType:"entity_type",entityId:"entity_id",isRead:"is_read"},orderBy:"created_at",orderAsc:!1}),am=Qi.remove;async function sm(){const e=await Ia();if(!e)return(await Tt("notifications")).map(s=>so(s)||s);const{data:t,error:n}=await he.from("notifications").select("*").eq("user_id",e).order("created_at",{ascending:!1});return n?(await Tt("notifications")).filter(s=>s.user_id===e).map(s=>so(s)||s):(t||[]).map(so)}async function im(){const e=await Ia();if(!e)return(await Tt("notifications")).filter(s=>!s.is_read).length;const{count:t,error:n}=await he.from("notifications").select("*",{count:"exact",head:!0}).eq("user_id",e).eq("is_read",!1);return n?(await Tt("notifications")).filter(s=>s.user_id===e&&!s.is_read).length:t||0}async function cm(e){return Qi.update(e,{isRead:!0})}async function um(){const e=await Ia();let t=he.from("notifications").update({is_read:!0,updated_at:new Date().toISOString()}).eq("is_read",!1);e&&(t=t.eq("user_id",e));const{error:n}=await t;if(n){const s=(await Tt("notifications")).map(c=>c.user_id===e&&!c.is_read?{...c,is_read:!0}:c);pa("notifications",s)}}function lm(e){return e?{id:e.id,name:e.name,email:e.email||"",phone:e.phone||"",company:e.company||"",notes:e.notes||"",createdAt:e.created_at,updatedAt:e.updated_at}:null}const ec=bt({table:"clients",localKey:"clients",idPrefix:"cli",transform:lm,schema:eh,fieldMap:{name:"name",email:"email",phone:"phone",company:"company",notes:"notes"}}),dm=ec.getAll;ec.getById;function fm(e){return e?{id:e.id,userId:e.user_id,userName:e.user_name||"Sistema",action:e.action||"",entityType:e.entity_type||"",entityId:e.entity_id||"",entityTitle:e.entity_title||"",oldValues:e.old_values||null,newValues:e.new_values||null,createdAt:e.created_at}:null}const pm=bt({table:"activity_logs",localKey:"activity_logs",idPrefix:"act",transform:fm,fieldMap:{userId:"user_id",userName:"user_name",action:"action",entityType:"entity_type",entityId:"entity_id",entityTitle:"entity_title",oldValues:"old_values",newValues:"new_values"},orderBy:"created_at",orderAsc:!1});pm.getAll;function Vs(e){if(!e)return!1;const t=new Date(e),n=new Date;return t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()}function Js(e){if(!e)return!1;const t=new Date(e),n=new Date,o=new Date(n.getFullYear(),n.getMonth()-1,1);return t.getMonth()===o.getMonth()&&t.getFullYear()===o.getFullYear()}function gn(e){if(e.actualStart&&e.actualEnd){const o=new Date(e.actualEnd)-new Date(e.actualStart);if(o>0)return o/(1e3*60*60)}const n=(e.checklist||[]).reduce((o,s)=>o+(s.durationMin||0),0);return n>0?n/60:0}function Yn(e){if(!e.estimatedStart||!e.estimatedEnd)return 0;const t=new Date(e.estimatedStart),o=new Date(e.estimatedEnd)-t;return o<=0?0:o/(1e3*60*60)}function Gs(e){if(!e.actualStart||!e.actualEnd)return null;const t=new Date(e.actualStart),n=new Date(e.actualEnd);return Math.max(0,Math.round((n-t)/(1e3*60*60*24)))}function Ys(e){if(!e.estimatedEnd||!e.actualEnd)return null;const t=new Date(e.estimatedEnd),n=new Date(e.actualEnd);return Math.round((n-t)/(1e3*60*60*24))}function hm(e){const t=parseFloat(e.salaryMonth||e.salary_month||0),n=parseFloat(e.hoursMonth||e.hours_month||176);return t<=0||n<=0?0:t/n}function Qg(e,t){const n=gn(e),o=t.find(h=>jr(h.name,e.assignee)||jr(h.name,e.assignedTo)),s=o?hm(o):0,c=n*s,d=(e.expenses||[]).reduce((h,g)=>h+(g.value||0)*(g.quantity||1),0);return{hours:n,hourlyRate:s,laborCost:c,materialCost:d,totalCost:c+d,memberFound:!!o}}function ey(e){const t=parseFloat(e);return isNaN(t)?"R$ 0,00":t.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}function ty(e){if(e<=0)return"0min";const t=Math.floor(e/60),n=e%60;return t===0?`${n}min`:n===0?`${t}h`:`${t}h ${n}min`}function ny(e){if(!e)return"";const t=Date.now()-new Date(e).getTime(),n=Math.floor(t/6e4);if(n<1)return"agora";if(n<60)return`ha ${n}min`;const o=Math.floor(n/60);if(o<24)return`ha ${o}h`;const s=Math.floor(o/24);return s===1?"ontem":s<7?`ha ${s} dias`:new Date(e).toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})}function Xs(e){return(e||"").toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function jr(e,t){const n=Xs(e),o=Xs(t);return!n||!o?!1:n===o||n.includes(o)||o.includes(n)}function ry(){try{return JSON.parse(localStorage.getItem("settings_profile")||"{}")}catch{return{}}}function oy(e,t){const n=t[0]||{id:"default",name:(e==null?void 0:e.name)||"Usuario",color:"#3b82f6"};return!e||!e.name?n:t.find(s=>jr(s.name,e.name))||{id:"self",name:e.name,color:"#3b82f6"}}function ay(e,t,n,o){const s=new Date(n),c=new Date(o);s.setHours(0,0,0,0),c.setHours(23,59,59,999);const d=e.filter(g=>{if(g.status==="done"&&g.actualEnd){const v=new Date(g.actualEnd);return v>=s&&v<=c}if(g.status==="in_progress"&&g.actualStart)return new Date(g.actualStart)<=c;if(g.status==="available"&&g.createdAt){const v=new Date(g.createdAt);return v>=s&&v<=c}return!1}),h=t.filter(g=>{if(!g.startDate)return!1;const v=new Date(g.startDate);return v>=s&&v<=c});return{filteredOrders:d,filteredEvents:h}}function mm(e,t,n){const o=new Date,s=e.filter(X=>X.status==="done"),c=s.filter(X=>Vs(X.actualEnd)),d=s.filter(X=>Js(X.actualEnd)),h=e.filter(X=>X.status==="in_progress"),g=e.filter(X=>X.status==="available"),v=s.map(X=>Gs(X)).filter(X=>X!==null),I=v.length>0?v.reduce((X,be)=>X+be,0)/v.length:0,P=c.map(X=>Gs(X)).filter(X=>X!==null),$=P.length>0?P.reduce((X,be)=>X+be,0)/P.length:0,C=c.length+h.length,Y=C>0?c.length/C*100:0,re=s.filter(X=>X.estimatedEnd&&X.actualEnd),D=re.filter(X=>Ys(X)<=0),Z=re.length>0?D.length/re.length*100:100,L=re.map(X=>Ys(X)).filter(X=>X>0),W=L.length>0?L.reduce((X,be)=>X+be,0)/L.length:0,R=(X,be)=>X.filter(yt=>yt.type==="meeting"&&yt.startDate&&yt.endDate&&be(yt.startDate)).reduce((yt,Nt)=>{const st=new Date(Nt.endDate)-new Date(Nt.startDate);return yt+Math.max(0,st/36e5)},0),q=R(t,Vs),ae=R(t,Js),ce=c.reduce((X,be)=>X+gn(be),0),me=d.reduce((X,be)=>X+gn(be),0),Ee=ce+q,Te=me+ae,ye=n>0?Math.min(Ee/n*100,100):0,We=o.getDate(),Ye=s.reduce((X,be)=>X+gn(be),0),bn=s.reduce((X,be)=>X+Yn(be),0),_n=Ye>0?bn/Ye*100:0,Jt=c.reduce((X,be)=>X+gn(be),0),$n=c.reduce((X,be)=>X+Yn(be),0),mt=Jt>0?$n/Jt*100:0,Dt=d.reduce((X,be)=>X+gn(be),0),dt=d.reduce((X,be)=>X+Yn(be),0),De=Dt>0?dt/Dt*100:0,ft=De>0?mt-De:0,Ze=h.length,Oe=Math.max(1,Math.floor(We*5/7))*8,_t=Oe>0?Math.min(Ee/Oe*100,100):0,ot=s.filter(X=>Yn(X)>0&&gn(X)>0),gt=ot.filter(X=>gn(X)>Yn(X)*1.3),Fn=ot.length>0?gt.length/ot.length*100:0,se=t.filter(X=>X.type==="meeting"&&new Date(X.endDate)<o),wt=se.filter(X=>X.attended===!0),ve=wt.filter(X=>!X.wasLate),at=wt.filter(X=>X.wasLate),on=se.length>0?wt.length/se.length*100:0,Xe=wt.length>0?ve.length/wt.length*100:0,wn=at.reduce((X,be)=>X+(parseInt(be.lateMinutes)||0),0);return{avgDelivery:I.toFixed(1),avgDeliveryMonth:$.toFixed(1),completionRate:Y.toFixed(0),onTimeRate:Z.toFixed(0),avgDelay:W.toFixed(1),hoursMonth:Ee,hoursLastMonth:Te,hoursPercent:ye,osHoursMonth:ce,meetingHoursMonth:q,productivity:_n.toFixed(0),productivityMonth:mt.toFixed(0),productivityChange:ft.toFixed(0),realizedHours:Jt,estimatedHours:$n,doneMonth:c.length,doneLastMonth:d.length,inProgress:h.length,available:g.length,total:e.length,workload:Ze,utilization:_t.toFixed(0),targetHours:n,totalDone:s.length,lateArrivals:at.length,totalLateMinutes:wn,meetingAttendance:on.toFixed(0),meetingPunctuality:Xe.toFixed(0),pastMeetings:se.length,attendedMeetings:wt.length,punctualMeetings:ve.length,reworkRate:Fn.toFixed(0),reworkCount:gt.length,reworkTotal:ot.length}}function gm(e){return e.leadTimeHours?e.leadTimeHours:e.status!=="done"||!e.createdAt||!e.actualEnd?null:(new Date(e.actualEnd)-new Date(e.createdAt))/(1e3*60*60)}function ym(e){const t=e.filter(n=>n.status==="done").map(n=>gm(n)).filter(n=>n!==null);return t.length===0?0:t.reduce((n,o)=>n+o,0)/t.length}function sy(e){const t=e.filter(o=>o.status==="done"&&o.slaDeadline&&o.actualEnd);if(t.length===0)return{rate:100,met:0,total:0};const n=t.filter(o=>new Date(o.actualEnd)<=new Date(o.slaDeadline));return{rate:Math.round(n.length/t.length*100),met:n.length,total:t.length}}function iy(e){const t=["bug","feature","support","compliance","campaign","internal"],n={};for(const o of t){const s=e.filter(d=>(d.category||"internal")===o),c=s.filter(d=>d.status==="done");n[o]={total:s.length,done:c.length,inProgress:s.filter(d=>d.status==="in_progress").length,avgLeadTime:ym(s)}}return n}function cy(e,t){return t.map(n=>{const o=e.filter(d=>d.status==="in_progress"&&(jr(n.name,d.assignee)||jr(n.name,d.assignedTo))),s=o.reduce((d,h)=>d+Yn(h),0),c=n.hoursMonth||n.hours_month||176;return{id:n.id,name:n.name,color:n.color||"#3b82f6",allocatedHours:s,availableHours:c,utilization:c>0?Math.round(s/c*100):0,activeOrders:o.length}})}function ma(e){return e?{id:e.id,userName:e.user_name||"",period:e.period,metrics:e.metrics||{},createdAt:e.created_at}:null}const Qs=bt({table:"kpi_snapshots",localKey:"kpi_snapshots",idPrefix:"ks",transform:ma,fieldMap:{userName:"user_name",period:"period",metrics:"metrics"},orderBy:"period",orderAsc:!0});function vm(){const e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}`}function uy(e){const[t,n]=e.split("-");return`${["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"][parseInt(n)-1]} ${t}`}async function ly(e,t,n,o){const s=vm(),c=mm(e,t,n),d={doneMonth:c.doneMonth,inProgress:c.inProgress,available:c.available,completionRate:parseFloat(c.completionRate),onTimeRate:parseFloat(c.onTimeRate),avgDelivery:parseFloat(c.avgDeliveryMonth),hoursMonth:c.hoursMonth,productivity:parseFloat(c.productivityMonth),utilization:parseFloat(c.utilization),reworkRate:parseFloat(c.reworkRate),meetingAttendance:parseFloat(c.meetingAttendance)},g=(await bm(o)).find(v=>v.period===s);return g?Qs.update(g.id,{metrics:d}):Qs.create({userName:o,period:s,metrics:d})}async function bm(e,t=12){const{data:n,error:o}=await he.from("kpi_snapshots").select("*").eq("user_name",e).order("period",{ascending:!0}).limit(t);return o?JSON.parse(localStorage.getItem("kpi_snapshots")||"[]").filter(c=>c.user_name===e).sort((c,d)=>c.period.localeCompare(d.period)).slice(-t).map(ma):(n||[]).map(ma)}function dy(e){var o,s;if(e.length<2)return{completionRate:0,onTimeRate:0,productivity:0,hoursMonth:0,avgDelivery:0};const t=((o=e[e.length-1])==null?void 0:o.metrics)||{},n=((s=e[e.length-2])==null?void 0:s.metrics)||{};return{completionRate:(t.completionRate||0)-(n.completionRate||0),onTimeRate:(t.onTimeRate||0)-(n.onTimeRate||0),productivity:(t.productivity||0)-(n.productivity||0),hoursMonth:(t.hoursMonth||0)-(n.hoursMonth||0),avgDelivery:(t.avgDelivery||0)-(n.avgDelivery||0)}}function fy(e,t){if(e.length<3)return null;const n=e.slice(-6).map(c=>{var d;return((d=c.metrics)==null?void 0:d[t])||0}),o=n.reduce((c,d)=>c+d,0)/n.length,s=n.length>=2?(n[n.length-1]-n[0])/(n.length-1):0;return{average:o,trend:s,nextMonth:o+s,direction:s>0?"up":s<0?"down":"stable"}}function _m(e){return{id:e.id,name:e.name||"",description:e.description||"",startDate:e.start_date||"",endDate:e.end_date||"",status:e.status||"planning",color:e.color||"#3b82f6",createdBy:e.created_by||"",createdAt:e.created_at,updatedAt:e.updated_at}}function ei(e){if(!e)return"";if(typeof e=="string"&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}$/.test(e))return e;const t=new Date(e);if(isNaN(t))return"";const n=o=>String(o).padStart(2,"0");return`${t.getUTCFullYear()}-${n(t.getUTCMonth()+1)}-${n(t.getUTCDate())}T${n(t.getUTCHours())}:${n(t.getUTCMinutes())}`}function wm(e){return{id:e.id,projectId:e.project_id||"",name:e.name||"",wbsNumber:e.wbs_number||"",parentId:e.parent_id||null,sortOrder:e.sort_order??0,level:e.level??0,isMilestone:e.is_milestone??!1,startDate:ei(e.start_date),endDate:ei(e.end_date),durationDays:e.duration_days??1,estimatedHours:e.estimated_hours??null,progress:e.progress??0,assignedTo:e.assigned_to||"",predecessors:Array.isArray(e.predecessors)?e.predecessors:[],notes:e.notes||"",attachments:Array.isArray(e.attachments)?e.attachments:[],color:e.color||"",osOrderId:e.os_order_id||null,createdAt:e.created_at,updatedAt:e.updated_at}}const tc=bt({table:"eap_projects",localKey:"eap_projects",idPrefix:"eprj",transform:_m,schema:th,fieldMap:{name:"name",description:"description",startDate:"start_date",endDate:"end_date",status:"status",color:"color",createdBy:"created_by"},orderBy:"created_at",orderAsc:!1}),Nr=bt({table:"eap_tasks",localKey:"eap_tasks",idPrefix:"etsk",transform:wm,schema:nh,fieldMap:{projectId:"project_id",name:"name",wbsNumber:"wbs_number",parentId:"parent_id",sortOrder:"sort_order",level:"level",isMilestone:"is_milestone",startDate:"start_date",endDate:"end_date",durationDays:"duration_days",estimatedHours:"estimated_hours",progress:"progress",assignedTo:"assigned_to",predecessors:"predecessors",notes:"notes",attachments:"attachments",color:"color",osOrderId:"os_order_id"},orderBy:"sort_order",orderAsc:!0});async function py(e,t,n){try{await Qn("eap_undo_history",{id:`${e}_undo`,stack:t}),await Qn("eap_undo_history",{id:`${e}_redo`,stack:n})}catch(o){console.warn("[EAP] Erro ao persistir undo/redo:",o)}}async function hy(e){try{const t=await Tt("eap_undo_history"),n=t.find(s=>s.id===`${e}_undo`),o=t.find(s=>s.id===`${e}_redo`);return{undoStack:Array.isArray(n==null?void 0:n.stack)?n.stack:[],redoStack:Array.isArray(o==null?void 0:o.stack)?o.stack:[]}}catch(t){return console.warn("[EAP] Erro ao carregar undo/redo:",t),{undoStack:[],redoStack:[]}}}function Da(e){const t=["startDate","endDate"],n={...e};for(const o of t)o in n&&!n[o]&&(n[o]=null);return"parentId"in n&&!n.parentId&&(n.parentId=null),n}const xm=tc.getAll,km=e=>tc.create(Da(e)),Sm=Nr.getAll,Em=e=>Nr.create(Da(e)),Tm=(e,t)=>Nr.update(e,Da(t)),Om=e=>Nr.remove(e);function Am(e,t){let n=e;for(;n.parentId;){const o=t.find(s=>s.id===n.parentId);if(!o)break;n=o}return n}async function jm(e){const n=(await Xi()).find(s=>s.name===e.name);if(n)return n.id;const o=await Kh({name:e.name,description:"Projeto gerado automaticamente pela EAP",color:"#3b82f6"});return(o==null?void 0:o.id)||null}function Im(e,t){const n=t.filter(c=>c.parentId===e.id).sort((c,d)=>(c.sortOrder||0)-(d.sortOrder||0));if(n.length===0)return[];const o=[];let s=0;for(const c of n){const d=t.filter(h=>h.parentId===c.id).sort((h,g)=>(h.sortOrder||0)-(g.sortOrder||0));if(d.length>0)for(const h of d)o.push({id:Date.now()+ ++s,text:h.name,group:c.name,done:!1,startedAt:null,completedAt:null,durationMin:null});else o.push({id:Date.now()+ ++s,text:c.name,group:null,done:!1,startedAt:null,completedAt:null,durationMin:null})}return o}async function my(e,t,n=[]){const o=n.length>0?Am(e,n):null;let s=null;o&&o.id!==e.id&&(s=await jm(o));const c=Im(e,n),d={title:e.name,description:e.notes||"",priority:"medium",category:"internal",assignedTo:e.assignedTo||"",estimatedStart:e.startDate||"",estimatedEnd:e.endDate||"",projectId:s,checklist:c},h=await Vh(d);return h?(await Nr.update(e.id,{osOrderId:h.id}),h):null}function gy(e,t){const n=new Map(t.map(c=>[c.id,c])),o=[],s=[];for(const c of e){if(!c.osOrderId)continue;const d=n.get(c.osOrderId);d&&(d.status==="done"&&c.progress!==100?o.push({id:c.id,progress:100}):c.progress===100&&d.status!=="done"?s.push({id:d.id,status:"done"}):c.progress>0&&c.progress<100&&d.status==="available"?s.push({id:d.id,status:"in_progress"}):d.status==="in_progress"&&c.progress===0&&o.push({id:c.id,progress:50}))}return{eapUpdates:o,osUpdates:s}}function ga(e){const t=n=>String(n).padStart(2,"0");return`${e.getFullYear()}-${t(e.getMonth()+1)}-${t(e.getDate())}`}function ya(e){const t=n=>String(n).padStart(2,"0");return`${e.getFullYear()}-${t(e.getMonth()+1)}-${t(e.getDate())}T${t(e.getHours())}:${t(e.getMinutes())}`}function yy(e,t){const n=t.filter($=>$.parentId===e);if(n.length===0)return null;const o=[];for(const $ of n){const C=$.startDate?new Date($.startDate):null,Y=$.endDate?new Date($.endDate):null;C&&!isNaN(C)?o.push({start:C,end:Y&&!isNaN(Y)?Y:C}):Y&&!isNaN(Y)&&o.push({start:Y,end:Y})}if(o.length===0)return null;const s=new Date(Math.min(...o.map($=>$.start))),c=new Date(Math.max(...o.map($=>$.end))),d=c-s,h=Math.max(1,Math.ceil(d/(1e3*60*60*24)));let g=0,v=0;for(const $ of n){const C=$.durationDays||1;g+=C,v+=($.progress||0)*C}const I=g>0?Math.round(v/g):0,P=n.reduce(($,C)=>$+(C.estimatedHours??(C.durationDays||1)*8),0);return{startDate:ya(s),endDate:ya(c),durationDays:h,estimatedHours:parseFloat(P.toFixed(2)),progress:I}}function vy(e){const t=new Set;if(e.length===0)return t;const n=new Set(e.filter(D=>D.parentId).map(D=>D.parentId)),o=e.filter(D=>!n.has(D.id));if(o.length===0)return t;const s=new Map(o.map(D=>[D.id,D])),c=new Map;for(const D of o)c.set(D.id,[]);for(const D of o)if(D.predecessors)for(const Z of D.predecessors){if(!s.has(Z.taskId))continue;const L=c.get(Z.taskId);L&&L.push({taskId:D.id,type:Z.type||"FS",lag:Z.lag||0})}const d=new Map;for(const D of o)d.set(D.id,0);for(const D of o)if(D.predecessors)for(const Z of D.predecessors)s.has(Z.taskId)&&d.set(D.id,(d.get(D.id)||0)+1);const h=[];for(const[D,Z]of d)Z===0&&h.push(D);const g=[];for(;h.length>0;){const D=h.shift();g.push(D);for(const Z of c.get(D)||[]){const L=(d.get(Z.taskId)||1)-1;d.set(Z.taskId,L),L===0&&h.push(Z.taskId)}}if(g.length<o.length){console.warn("[EAP] Dependencia circular detectada no calculo do caminho critico.");for(const D of o)g.includes(D.id)||g.push(D.id)}const v=new Date("2020-01-01T00:00:00"),I=D=>D?Math.round((new Date(D.includes("T")?D:D+"T00:00:00")-v)/864e5):0,P=new Map,$=new Map;for(const D of g){const Z=s.get(D),L=Z.durationDays||1;let W=I(Z.startDate);if(Z.predecessors&&Z.predecessors.length>0)for(const R of Z.predecessors){const q=s.get(R.taskId);if(!q)continue;const ae=P.get(R.taskId)??I(q.startDate),ce=$.get(R.taskId)??ae+(q.durationDays||1),me=R.type||"FS",Ee=R.lag||0;let Te;me==="FS"?Te=ce+Ee:me==="SS"?Te=ae+Ee:me==="FF"?Te=ce+Ee-L:me==="SF"?Te=ae+Ee-L:Te=ce+Ee,Te>W&&(W=Te)}P.set(D,W),$.set(D,W+L)}let C=0;for(const D of $.values())D>C&&(C=D);const Y=new Map,re=new Map;for(const D of o){const Z=D.durationDays||1;re.set(D.id,C),Y.set(D.id,C-Z)}for(let D=g.length-1;D>=0;D--){const Z=g[D],W=s.get(Z).durationDays||1;let R=C;const q=c.get(Z)||[];if(q.length>0)for(const ae of q){const ce=Y.get(ae.taskId),me=re.get(ae.taskId);if(ce===void 0)continue;const Ee=ae.type||"FS",Te=ae.lag||0;let ye;Ee==="FS"?ye=ce-Te:Ee==="SS"?ye=ce-Te+W:Ee==="FF"?ye=me-Te:Ee==="SF"?ye=me-Te+W:ye=ce-Te,ye<R&&(R=ye)}re.set(Z,R),Y.set(Z,R-W)}for(const D of g){const Z=P.get(D)??0;if((Y.get(D)??0)-Z<=0){t.add(D);const R=s.get(D);if(R&&R.parentId){t.add(R.parentId);let q=R.parentId;for(;q;){t.add(q);const ae=e.find(ce=>ce.id===q);q=ae?ae.parentId:null}}}}return t}function by(e){const t=[...e].sort((s,c)=>s.sortOrder-c.sortOrder),n=new Map,o=[];for(const s of t)n.set(s.id,{...s,children:[]});for(const s of t){const c=n.get(s.id);s.parentId&&n.has(s.parentId)?n.get(s.parentId).children.push(c):o.push(c)}return o}function _y(e,t=new Set){const n=[];function o(s){for(const c of s)n.push(c),c.children.length>0&&!t.has(c.id)&&o(c.children)}return o(e),n}function Rn(e){return e?e.includes("T")?new Date(e):new Date(e+"T00:00:00"):null}function Dm(e,t){if(!e||!t)return"";const n=Rn(e);let o=t-1;const s=new Date(n);for(;o>0;){s.setDate(s.getDate()+1);const c=s.getDay();c!==0&&c!==6&&o--}if(e.includes("T")){const c=d=>String(d).padStart(2,"0");return`${ga(s)}T${c(n.getHours())}:${c(n.getMinutes())}`}return ga(s)}function wy(e,t){if(!e||!t)return 1;const n=Rn(e),o=Rn(t),s=new Date(n);s.setHours(0,0,0,0);const c=new Date(o);c.setHours(0,0,0,0);let d=0;const h=new Date(s);for(;h<=c;){const g=h.getDay();g!==0&&g!==6&&d++,h.setDate(h.getDate()+1)}return Math.max(1,d)}function xy(e,t){if(!e||!t)return 0;const n=8,o=18,s=Rn(e),c=Rn(t);if(!s||!c||c<=s)return 0;if(s.toDateString()===c.toDateString()){if(s.getDay()===0||s.getDay()===6)return 0;const v=Math.max(s.getHours()+s.getMinutes()/60,n),I=Math.min(c.getHours()+c.getMinutes()/60,o);return Math.max(0,parseFloat((I-v).toFixed(2)))}let d=0;const h=new Date(s);if(h.getDay()!==0&&h.getDay()!==6){const v=Math.max(h.getHours()+h.getMinutes()/60,n);d+=Math.max(0,o-v)}h.setDate(h.getDate()+1),h.setHours(0,0,0,0);const g=new Date(c);for(g.setHours(0,0,0,0);h<g;)h.getDay()!==0&&h.getDay()!==6&&(d+=o-n),h.setDate(h.getDate()+1);if(c.getDay()!==0&&c.getDay()!==6){const v=Math.min(c.getHours()+c.getMinutes()/60,o);d+=Math.max(0,v-n)}return parseFloat(d.toFixed(2))}function ky(e,t,n){if(!t||t.length===0)return!1;const o=new Map(n.map(c=>[c.id,c]));function s(c,d,h=new Set){if(c===d)return!0;if(h.has(c))return!1;h.add(c);const g=o.get(c);if(!g||!g.predecessors)return!1;for(const v of g.predecessors)if(s(v.taskId,d,h))return!0;return!1}for(const c of t)if(c.taskId===e||s(e,c.taskId,new Set))return!0;return!1}function Jn(e,t){if(!e||t===0)return e;const n=Rn(e);let o=Math.abs(t);const s=t>0?1:-1;for(;o>0;){n.setDate(n.getDate()+s);const c=n.getDay();c!==0&&c!==6&&o--}return e.includes("T")?ya(n):ga(n)}function Sy(e,t){return!e||e.length===0?"":e.map(n=>{const o=t.get(n.taskId);if(o===void 0)return"";const s=n.type||"FS",c=n.lag||0;let d=String(o);return s!=="FS"&&(d+=s),c>0?d+="+"+c+"d":c<0&&(d+=c+"d"),d}).filter(Boolean).join(";")}function Ey(e,t){if(!e||!e.trim())return[];const n=e.split(/[;,]/),o=[];for(const s of n){const c=s.trim().match(/^(\d+)\s*(FS|SS|FF|SF)?\s*([+-]\d+)?\s*d?\s*$/i);if(!c)continue;const d=parseInt(c[1],10),h=(c[2]||"FS").toUpperCase(),g=c[3]?parseInt(c[3],10):0,v=t.get(d);v&&o.push({taskId:v,type:h,lag:g})}return o}function Ty(e){var h;const t=new Map(e.map(g=>[g.id,{...g}])),n=new Map,o=new Map;for(const g of e)n.set(g.id,0),o.set(g.id,[]);for(const g of e)if(g.predecessors)for(const v of g.predecessors)t.has(v.taskId)&&(n.set(g.id,(n.get(g.id)||0)+1),(h=o.get(v.taskId))==null||h.push(g.id));const s=[];for(const[g,v]of n)v===0&&s.push(g);const c=[];for(;s.length>0;){const g=s.shift();c.push(g);for(const v of o.get(g)||[]){const I=(n.get(v)||1)-1;n.set(v,I),I===0&&s.push(v)}}if(c.length<e.length){console.warn("[EAP] Dependencia circular detectada no auto-scheduling. Tarefas ciclicas serao ignoradas no agendamento.");for(const g of e)c.includes(g.id)||c.push(g.id)}const d=[];for(const g of c){const v=t.get(g);if(!v||!v.predecessors||v.predecessors.length===0)continue;let I=null,P=null;for(const $ of v.predecessors){const C=t.get($.taskId);if(!C)continue;const Y=$.type||"FS",re=$.lag||0;let D;if(Y==="FS"){if(!C.endDate)continue;D=Jn(C.endDate,1+re)}else if(Y==="SS"){if(!C.startDate)continue;D=re===0?C.startDate:Jn(C.startDate,re)}else if(Y==="FF"){if(!C.endDate)continue;const Z=v.durationDays||1,L=Jn(C.endDate,re);D=Jn(L,-(Z-1))}else if(Y==="SF"){if(!C.startDate)continue;const Z=v.durationDays||1,L=Jn(C.startDate,re);D=Jn(L,-(Z-1))}if(D){const Z=Rn(D);(!I||Z>I)&&(I=Z,P=D)}}if(P){const $=P,C=Dm($,v.durationDays||1),Y=(v.startDate||"").split("T")[0];$.split("T")[0]!==Y&&(d.push({id:v.id,startDate:$,endDate:C}),v.startDate=$,v.endDate=C)}}return d}const Pe={osOrders:["osOrders"],osSectors:["osSectors"],osProjects:["osProjects"],teamMembers:["teamMembers"],agendaEvents:["agendaEvents"],notifications:["notifications"],unreadCount:["unreadCount"],activities:["activities"],clients:["clients"],kpiHistory:["kpiHistory"],eapProjects:["eapProjects"],eapTasks:["eapTasks"]};function Oy(){return qt({queryKey:Pe.osOrders,queryFn:Uh,staleTime:3e4})}function Ay(){return qt({queryKey:Pe.osSectors,queryFn:Zh,staleTime:6e4})}function jy(){return qt({queryKey:Pe.osProjects,queryFn:Xi,staleTime:6e4})}function Iy(){return qt({queryKey:Pe.teamMembers,queryFn:Gh,staleTime:6e4})}function Dy(){return qt({queryKey:Pe.agendaEvents,queryFn:Xh,staleTime:3e4})}function Ny(){const e=jt();return Ht({mutationFn:Qh,onSuccess:()=>e.invalidateQueries({queryKey:Pe.agendaEvents})})}function Py(){const e=jt();return Ht({mutationFn:({id:t,updates:n})=>em(t,n),onSuccess:()=>e.invalidateQueries({queryKey:Pe.agendaEvents})})}function Cy(){const e=jt();return Ht({mutationFn:tm,onSuccess:()=>e.invalidateQueries({queryKey:Pe.agendaEvents})})}function Nm(){return qt({queryKey:Pe.notifications,queryFn:sm,staleTime:1e4})}function Pm(){return qt({queryKey:Pe.unreadCount,queryFn:im,staleTime:1e4})}function Cm(){const e=jt();return Ht({mutationFn:cm,onSuccess:()=>{e.invalidateQueries({queryKey:Pe.notifications}),e.invalidateQueries({queryKey:Pe.unreadCount})}})}function Mm(){const e=jt();return Ht({mutationFn:um,onSuccess:()=>{e.invalidateQueries({queryKey:Pe.notifications}),e.invalidateQueries({queryKey:Pe.unreadCount})}})}function zm(){const e=jt();return Ht({mutationFn:am,onSuccess:()=>{e.invalidateQueries({queryKey:Pe.notifications}),e.invalidateQueries({queryKey:Pe.unreadCount})}})}function My(){return qt({queryKey:Pe.clients,queryFn:dm,staleTime:6e4})}function zy(){return qt({queryKey:Pe.eapProjects,queryFn:xm,staleTime:3e4})}function Ry(){const e=jt();return Ht({mutationFn:km,onSuccess:()=>e.invalidateQueries({queryKey:Pe.eapProjects})})}function Ly(){return qt({queryKey:Pe.eapTasks,queryFn:Sm,staleTime:15e3})}function $y(){const e=jt();return Ht({mutationFn:Em,onSuccess:()=>e.invalidateQueries({queryKey:Pe.eapTasks})})}function Fy(){const e=jt();return Ht({mutationFn:({id:t,updates:n})=>Tm(t,n),onSuccess:(t,n)=>{n.skipInvalidation||e.invalidateQueries({queryKey:Pe.eapTasks})}})}function Zy(){const e=jt();return Ht({mutationFn:Om,onSuccess:()=>e.invalidateQueries({queryKey:Pe.eapTasks})})}function xo(e,t,n={}){const o=jt(),{enabled:s=!0,onInsert:c,onUpdate:d,onDelete:h}=n;ee.useEffect(()=>{if(!s)return;const g=he.channel(`realtime-${e}`).on("postgres_changes",{event:"*",schema:"public",table:e},v=>{t.forEach(I=>{o.invalidateQueries({queryKey:Array.isArray(I)?I:[I]})}),v.eventType==="INSERT"&&c?c(v.new):v.eventType==="UPDATE"&&d?d(v.new,v.old):v.eventType==="DELETE"&&h&&h(v.old)}).subscribe();return()=>{he.removeChannel(g)}},[e,s,o])}function Ky(e=!0){xo("os_orders",["osOrders"],{enabled:e})}function Uy(e=!0){xo("agenda_events",["agendaEvents"],{enabled:e})}function Rm(e=!0){xo("notifications",["notifications","unreadCount"],{enabled:e,onInsert:t=>{t&&t.title&&om({title:t.title,body:t.message||"",type:t.type||"info",entityType:t.entity_type,entityId:t.entity_id,tag:`fyness-rt-${t.id}`})}})}function By(e=!0){xo("team_members",["teamMembers"],{enabled:e})}const ti={info:{icon:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",color:"text-blue-500",bg:"bg-blue-50 dark:bg-blue-900/20"},success:{icon:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",color:"text-emerald-500",bg:"bg-emerald-50 dark:bg-emerald-900/20"},warning:{icon:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z",color:"text-amber-500",bg:"bg-amber-50 dark:bg-amber-900/20"},error:{icon:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z",color:"text-red-500",bg:"bg-red-50 dark:bg-red-900/20"},assignment:{icon:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z",color:"text-blue-500",bg:"bg-blue-50 dark:bg-blue-900/20"}};function Lm(e){if(!e)return"";const t=new Date,n=new Date(e),o=t-n,s=Math.floor(o/6e4),c=Math.floor(o/36e5),d=Math.floor(o/864e5);return s<1?"Agora":s<60?`${s}m atras`:c<24?`${c}h atras`:d<7?`${d}d atras`:n.toLocaleDateString("pt-BR")}function $m({notifications:e,onMarkRead:t,onMarkAllRead:n,onDelete:o,onClose:s}){const[c,d]=ee.useState("all"),h=c==="all"?e:c==="unread"?e.filter(v=>!v.isRead):e.filter(v=>v.isRead),g=e.filter(v=>!v.isRead).length;return y.jsxs("div",{className:"absolute right-0 top-full mt-2 w-96 max-h-[480px] bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl shadow-xl z-50 flex flex-col overflow-hidden",children:[y.jsxs("div",{className:"px-4 py-3 border-b border-slate-100 dark:border-slate-700 flex items-center justify-between shrink-0",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("h3",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100",children:"Notificacoes"}),g>0&&y.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-bold bg-red-500 text-white rounded-full",children:g})]}),y.jsx("div",{className:"flex items-center gap-2",children:g>0&&y.jsx("button",{onClick:n,className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium",children:"Marcar todas como lidas"})})]}),y.jsx("div",{className:"px-4 py-2 flex gap-1 border-b border-slate-100 dark:border-slate-700 shrink-0",children:[{id:"all",label:"Todas"},{id:"unread",label:"Nao lidas"},{id:"read",label:"Lidas"}].map(v=>y.jsx("button",{onClick:()=>d(v.id),className:`px-3 py-1 text-xs font-medium rounded-full transition-colors ${c===v.id?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700"}`,children:v.label},v.id))}),y.jsx("div",{className:"flex-1 overflow-y-auto",children:h.length===0?y.jsxs("div",{className:"px-4 py-8 text-center",children:[y.jsx("svg",{className:"w-10 h-10 text-slate-300 dark:text-slate-600 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),y.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500",children:"Nenhuma notificacao"})]}):h.map(v=>{const I=ti[v.type]||ti.info;return y.jsxs("div",{className:`px-4 py-3 flex gap-3 border-b border-slate-50 dark:border-slate-700/50 last:border-b-0 transition-colors hover:bg-slate-50 dark:hover:bg-slate-700/50 ${v.isRead?"":"bg-blue-50/50 dark:bg-blue-900/10"}`,children:[y.jsx("div",{className:`w-8 h-8 rounded-full ${I.bg} flex items-center justify-center shrink-0`,children:y.jsx("svg",{className:`w-4 h-4 ${I.color}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:I.icon})})}),y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsxs("div",{className:"flex items-start justify-between gap-2",children:[y.jsx("p",{className:`text-sm leading-tight ${v.isRead?"text-slate-600 dark:text-slate-300":"font-medium text-slate-800 dark:text-slate-100"}`,children:v.title}),!v.isRead&&y.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full shrink-0 mt-1.5"})]}),v.message&&y.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5 line-clamp-2",children:v.message}),y.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[y.jsx("span",{className:"text-[11px] text-slate-400 dark:text-slate-500",children:Lm(v.createdAt)}),!v.isRead&&y.jsx("button",{onClick:P=>{P.stopPropagation(),t(v.id)},className:"text-[11px] text-blue-500 dark:text-blue-400 hover:text-blue-600 dark:hover:text-blue-300",children:"Marcar como lida"}),y.jsx("button",{onClick:P=>{P.stopPropagation(),o(v.id)},className:"text-[11px] text-slate-400 dark:text-slate-500 hover:text-red-500 dark:hover:text-red-400",children:"Remover"})]})]})]},v.id)})})]})}const Fm=()=>y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})});function Zm(){const[e,t]=ee.useState(!1),n=ee.useRef(null),o=jt(),{data:s=[]}=Nm(),{data:c=0}=Pm(),d=Cm(),h=Mm(),g=zm();Rm();const v=()=>{const C=!e;t(C),C&&nm()==="default"&&rm()};ee.useEffect(()=>{const C=Y=>{n.current&&!n.current.contains(Y.target)&&t(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]),ee.useEffect(()=>{const C=()=>{o.invalidateQueries({queryKey:Pe.notifications}),o.invalidateQueries({queryKey:Pe.unreadCount})};return window.addEventListener("notification-created",C),()=>window.removeEventListener("notification-created",C)},[o]);const I=C=>{d.mutate(C)},P=()=>{h.mutate()},$=C=>{g.mutate(C)};return y.jsxs("div",{className:"relative",ref:n,children:[y.jsxs("button",{onClick:v,className:"relative p-2 rounded-lg text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",title:"Notificacoes",children:[y.jsx(Fm,{}),c>0&&y.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-5 h-5 bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center ring-2 ring-white dark:ring-slate-900",children:c>9?"9+":c})]}),e&&y.jsx($m,{notifications:s,onMarkRead:I,onMarkAllRead:P,onDelete:$,onClose:()=>t(!1)})]})}async function Km(e){if(!e||e.length<2)return[];const t=e.toLowerCase(),n=[];try{JSON.parse(localStorage.getItem("os_orders")||"[]").forEach(c=>{(c.title&&c.title.toLowerCase().includes(t)||c.client&&c.client.toLowerCase().includes(t)||c.description&&c.description.toLowerCase().includes(t)||c.number&&String(c.number).includes(t))&&n.push({type:"os",id:c.id,label:`O.S. #${c.number} - ${c.title}`,sub:c.client||c.description||"",route:"/financial",icon:"OS",color:"bg-fyness-primary"})})}catch{}try{JSON.parse(localStorage.getItem("agenda_events")||"[]").forEach(c=>{(c.title&&c.title.toLowerCase().includes(t)||c.description&&c.description.toLowerCase().includes(t))&&n.push({type:"event",id:c.id,label:c.title,sub:c.description||"",route:"/agenda",icon:"AG",color:"bg-amber-500"})})}catch{}try{JSON.parse(localStorage.getItem("os_projects")||"[]").forEach(c=>{c.name&&c.name.toLowerCase().includes(t)&&n.push({type:"project",id:c.id,label:c.name,sub:c.description||"Projeto",route:"/financial",icon:"PJ",color:"bg-blue-500"})})}catch{}try{JSON.parse(localStorage.getItem("team_members")||"[]").forEach(c=>{(c.name&&c.name.toLowerCase().includes(t)||c.role&&c.role.toLowerCase().includes(t))&&n.push({type:"member",id:c.id,label:c.name,sub:c.role||"Membro",route:"/settings",icon:c.name?c.name[0].toUpperCase():"M",color:"bg-purple-500"})})}catch{}return[{label:"Dashboard",route:"/dashboard",keywords:["dashboard","inicio","home","painel"]},{label:"Ordens de Servico",route:"/financial",keywords:["ordens","servico","os","kanban"]},{label:"Agenda",route:"/agenda",keywords:["agenda","calendario","eventos"]},{label:"Minha Rotina",route:"/routine",keywords:["rotina","tarefas","routine"]},{label:"Processos (BPMN)",route:"/sales",keywords:["processos","bpmn","fluxo"]},{label:"Relatorios",route:"/reports",keywords:["relatorios","reports","pdf"]},{label:"Configuracoes",route:"/settings",keywords:["configuracoes","settings","perfil","equipe"]}].forEach(s=>{(s.label.toLowerCase().includes(t)||s.keywords.some(c=>c.includes(t)))&&n.push({type:"page",id:s.route,label:s.label,sub:"Pagina",route:s.route,icon:"",color:"bg-slate-500"})}),n.slice(0,12)}function Um(){const e=ba(),[t,n]=ee.useState(!1),[o,s]=ee.useState(""),[c,d]=ee.useState([]),[h,g]=ee.useState(0),v=ee.useRef(null);ee.useEffect(()=>{const D=Z=>{(Z.metaKey||Z.ctrlKey)&&Z.key==="k"&&(Z.preventDefault(),n(L=>!L)),Z.key==="Escape"&&n(!1)};return document.addEventListener("keydown",D),()=>document.removeEventListener("keydown",D)},[]),ee.useEffect(()=>{t&&(setTimeout(()=>{var D;return(D=v.current)==null?void 0:D.focus()},50),s(""),d([]),g(0))},[t]);const I=ee.useCallback(async D=>{if(s(D),g(0),D.length>=2){const Z=await Km(D);d(Z)}else d([])},[]),P=D=>{n(!1),e(D.route)},$=D=>{D.key==="ArrowDown"?(D.preventDefault(),g(Z=>Math.min(Z+1,c.length-1))):D.key==="ArrowUp"?(D.preventDefault(),g(Z=>Math.max(Z-1,0))):D.key==="Enter"&&c[h]&&P(c[h])};if(!t)return null;const C={};c.forEach(D=>{C[D.type]||(C[D.type]=[]),C[D.type].push(D)});const Y={os:"Ordens de Servico",event:"Eventos",project:"Projetos",member:"Membros",page:"Paginas"};let re=0;return y.jsxs("div",{className:"fixed inset-0 z-[100] flex items-start justify-center pt-[20vh]",children:[y.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>n(!1)}),y.jsxs("div",{className:"relative w-full max-w-lg mx-4 bg-white dark:bg-slate-800 rounded-xl shadow-2xl border border-slate-200 dark:border-slate-700 overflow-hidden",children:[y.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 border-b border-slate-100 dark:border-slate-700",children:[y.jsx("svg",{className:"w-5 h-5 text-slate-400 dark:text-slate-500 shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),y.jsx("input",{ref:v,type:"text",value:o,onChange:D=>I(D.target.value),onKeyDown:$,placeholder:"Buscar O.S., eventos, paginas...",className:"flex-1 bg-transparent text-slate-800 dark:text-slate-200 placeholder-slate-400 dark:placeholder-slate-500 text-sm focus:outline-none"}),y.jsx("kbd",{className:"hidden sm:inline-flex items-center px-2 py-0.5 text-[10px] font-mono text-slate-400 dark:text-slate-500 bg-slate-100 dark:bg-slate-700 rounded",children:"ESC"})]}),y.jsx("div",{className:"max-h-80 overflow-y-auto",children:o.length>=2&&c.length===0?y.jsx("div",{className:"px-4 py-8 text-center",children:y.jsxs("p",{className:"text-sm text-slate-400 dark:text-slate-500",children:["Nenhum resultado para ",o,""]})}):Object.entries(C).map(([D,Z])=>y.jsxs("div",{children:[y.jsx("div",{className:"px-4 py-1.5 text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:Y[D]||D}),Z.map(L=>{const R=re++===h;return y.jsxs("button",{onClick:()=>P(L),className:`w-full px-4 py-2.5 flex items-center gap-3 transition-colors ${R?"bg-blue-50 dark:bg-blue-900/20":"hover:bg-slate-50 dark:hover:bg-slate-700/50"}`,children:[y.jsx("div",{className:`w-7 h-7 rounded-lg ${L.color} flex items-center justify-center text-white text-[10px] font-bold shrink-0`,children:L.icon}),y.jsxs("div",{className:"flex-1 text-left min-w-0",children:[y.jsx("div",{className:"text-sm text-slate-800 dark:text-slate-200 truncate",children:L.label}),y.jsx("div",{className:"text-[11px] text-slate-400 dark:text-slate-500 truncate",children:L.sub})]}),R&&y.jsx("kbd",{className:"text-[10px] font-mono text-slate-400 dark:text-slate-500 bg-slate-100 dark:bg-slate-700 px-1.5 py-0.5 rounded",children:""})]},`${L.type}-${L.id}`)})]},D))}),o.length<2&&y.jsx("div",{className:"px-4 py-3 border-t border-slate-100 dark:border-slate-700",children:y.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500 text-center",children:"Digite pelo menos 2 caracteres para buscar"})})]})]})}const ni={"/dashboard":"Dashboard","/sales":"Processos","/sales/editor":"Editor de Fluxo","/routine":"Minha Rotina","/agenda":"Agenda","/financial":"Ordens de Servico","/eap":"EAP - Grafico de Gantt","/reports":"Relatorios","/my-day":"Meu Dia","/settings":"Configuracoes"},Bm=()=>y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),qm=()=>y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),Hm=()=>y.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})});function Wm(e){if(!e||e.length<2)return[];const t=e.toLowerCase(),n=[];try{JSON.parse(localStorage.getItem("os_orders")||"[]").forEach(s=>{(s.title&&s.title.toLowerCase().includes(t)||s.client&&s.client.toLowerCase().includes(t)||s.description&&s.description.toLowerCase().includes(t)||s.number&&String(s.number).includes(t))&&n.push({type:"os",label:`O.S. #${s.number} - ${s.title}`,sub:s.client||"Sem cliente",route:"/financial",id:s.id})})}catch{}try{JSON.parse(localStorage.getItem("agenda_events")||"[]").forEach(s=>{(s.title&&s.title.toLowerCase().includes(t)||s.description&&s.description.toLowerCase().includes(t))&&n.push({type:"event",label:s.title,sub:s.description||"",route:"/agenda",id:s.id})})}catch{}return n.slice(0,8)}function Vm(){const e=va(),t=ba(),{isDark:n,toggleTheme:o}=vh(),[s,c]=ee.useState(""),[d,h]=ee.useState([]),[g,v]=ee.useState(!1),I=ee.useRef(null),P=ee.useCallback(D=>{c(D),D.length>=2?(h(Wm(D)),v(!0)):(h([]),v(!1))},[]),$=D=>{c(""),v(!1),t(D.route)};ee.useEffect(()=>{const D=Z=>{I.current&&!I.current.contains(Z.target)&&v(!1)};return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[]);const C=()=>{for(const[D,Z]of Object.entries(ni))if(e.pathname===D||e.pathname.startsWith(D+"/"))return Z;return"Dashboard"},re=(()=>{const D=e.pathname.split("/").filter(Boolean);return D.map((Z,L)=>{const W="/"+D.slice(0,L+1).join("/"),R=ni[W]||Z.charAt(0).toUpperCase()+Z.slice(1);return{path:W,title:R}})})();return y.jsxs("header",{className:"h-16 bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-700 px-6 flex items-center justify-between",children:[y.jsxs("div",{children:[y.jsxs("nav",{className:"flex items-center gap-2 text-sm",children:[y.jsx("span",{className:"text-slate-400 dark:text-slate-500",children:"Inicio"}),re.map((D,Z)=>y.jsxs("span",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-slate-300 dark:text-slate-600",children:"/"}),y.jsx("span",{className:Z===re.length-1?"text-slate-800 dark:text-slate-100 font-medium":"text-slate-500 dark:text-slate-400",children:D.title})]},D.path))]}),y.jsx("h1",{className:"text-xl font-semibold text-slate-800 dark:text-slate-100",children:C()})]}),y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsxs("div",{className:"relative hidden md:block",ref:I,children:[y.jsx("input",{type:"search",role:"searchbox","aria-label":"Buscar ordens de servico e eventos",placeholder:"Buscar O.S., eventos...",value:s,onChange:D=>P(D.target.value),onFocus:()=>{s.length>=2&&v(!0)},className:"w-64 pl-10 pr-4 py-2 rounded-lg border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-800 dark:text-slate-200 placeholder-slate-400 dark:placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"}),y.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 dark:text-slate-500",children:y.jsx(Bm,{})}),g&&y.jsx("div",{className:"absolute top-full mt-1 left-0 right-0 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-600 rounded-lg shadow-lg z-50 max-h-80 overflow-y-auto",children:d.length===0?y.jsxs("div",{className:"px-4 py-3 text-sm text-slate-400 dark:text-slate-500 text-center",children:["Nenhum resultado para ",s,""]}):d.map((D,Z)=>y.jsxs("button",{onClick:()=>$(D),className:"w-full px-4 py-2.5 text-left hover:bg-slate-50 dark:hover:bg-slate-700 flex items-center gap-3 transition-colors border-b border-slate-100 dark:border-slate-700 last:border-b-0",children:[y.jsx("div",{className:`w-7 h-7 rounded-lg flex items-center justify-center text-white text-[10px] font-bold shrink-0 ${D.type==="os"?"bg-fyness-primary":"bg-amber-500"}`,children:D.type==="os"?"OS":"AG"}),y.jsxs("div",{className:"min-w-0 flex-1",children:[y.jsx("div",{className:"text-sm font-medium text-slate-800 dark:text-slate-200 truncate",children:D.label}),y.jsx("div",{className:"text-[11px] text-slate-400 dark:text-slate-500 truncate",children:D.sub})]})]},`${D.type}-${D.id}-${Z}`))})]}),y.jsx(Zm,{}),y.jsx("button",{onClick:o,"aria-label":n?"Ativar modo claro":"Ativar modo escuro",className:"p-2 rounded-lg text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",title:n?"Modo claro":"Modo escuro",children:n?y.jsx(qm,{}):y.jsx(Hm,{})})]})]})}function Jm(){return y.jsxs("div",{className:"min-h-screen flex bg-slate-50 dark:bg-slate-950 print:block print:bg-white",children:[y.jsx("div",{className:"print:hidden",children:y.jsx(Rh,{})}),y.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden transition-all duration-300",children:[y.jsx("div",{className:"print:hidden",children:y.jsx(Vm,{})}),y.jsx("main",{role:"main","aria-label":"Conteudo principal",className:"flex-1 overflow-auto p-6 print:p-0 print:overflow-visible",children:y.jsx(oi,{})})]}),y.jsx(Um,{})]})}const Gm=ee.lazy(()=>Vt(()=>import("./LoginPage-C4re7wra.js"),__vite__mapDeps([0,1,2,3]))),Ym=ee.lazy(()=>Vt(()=>import("./Dashboard-BVB1cphW.js"),__vite__mapDeps([4,1,2,5,3]))),ri=ee.lazy(()=>Vt(()=>import("./Editor-DJCf8Zpw.js"),__vite__mapDeps([6,1,2,7,8,5,3]))),Xm=ee.lazy(()=>Vt(()=>import("./DashboardPage-e3Pccgkn.js"),__vite__mapDeps([9,1,2,3]))),Qm=ee.lazy(()=>Vt(()=>import("./RoutinePage-0kBPn-MT.js"),__vite__mapDeps([10,1,2,3]))),eg=ee.lazy(()=>Vt(()=>import("./AgendaPage-BVkwkGnF.js"),__vite__mapDeps([11,1,2,3]))),tg=ee.lazy(()=>Vt(()=>import("./FinancialPage-x939kl2R.js"),__vite__mapDeps([12,1,2,3]))),ng=ee.lazy(()=>Vt(()=>import("./SettingsPage-BL0lOf2O.js"),__vite__mapDeps([13,1,2,3]))),rg=ee.lazy(()=>Vt(()=>import("./ReportPage-Cn02wf3m.js"),__vite__mapDeps([14,1,2,7,15,3]))),og=ee.lazy(()=>Vt(()=>import("./EapPage-DbvRqxL-.js"),__vite__mapDeps([16,1,2,3])));function ag(){return y.jsx("div",{className:"flex items-center justify-center h-screen bg-slate-50 dark:bg-slate-950",children:y.jsx("div",{className:"w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})})}function sg(){return y.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-slate-50 dark:bg-slate-950 gap-4",children:[y.jsx("div",{className:"text-6xl font-bold text-slate-300 dark:text-slate-600",children:"403"}),y.jsx("h1",{className:"text-xl font-semibold text-slate-700 dark:text-slate-200",children:"Acesso Negado"}),y.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Voce nao tem permissao para acessar esta pagina."}),y.jsx("a",{href:"/dashboard",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Voltar ao Dashboard"})]})}function ig(){const{addToast:e}=Rc();return ee.useEffect(()=>(us(e),()=>us(null)),[e]),null}function cg(){return y.jsxs(Mc,{children:[y.jsx(ig,{}),y.jsx(tn,{children:y.jsx(ee.Suspense,{fallback:y.jsx(ag,{}),children:y.jsxs(jc,{children:[y.jsx(rt,{path:"/login",element:y.jsx(Gm,{})}),y.jsx(rt,{path:"/unauthorized",element:y.jsx(sg,{})}),y.jsxs(rt,{element:y.jsx(Ws,{}),children:[y.jsx(rt,{path:"/sales/editor/:id?",element:y.jsx(ri,{})}),y.jsx(rt,{path:"/editor/:id?",element:y.jsx(ri,{})})]}),y.jsx(rt,{element:y.jsx(Ws,{}),children:y.jsxs(rt,{element:y.jsx(Jm,{}),children:[y.jsx(rt,{path:"/",element:y.jsx(xr,{to:"/dashboard",replace:!0})}),y.jsx(rt,{path:"/dashboard",element:y.jsx(tn,{children:y.jsx(Xm,{})})}),y.jsx(rt,{path:"/sales",element:y.jsx(tn,{children:y.jsx(Ym,{})})}),y.jsx(rt,{path:"/routine",element:y.jsx(tn,{children:y.jsx(Qm,{})})}),y.jsx(rt,{path:"/agenda",element:y.jsx(tn,{children:y.jsx(eg,{})})}),y.jsx(rt,{path:"/financial",element:y.jsx(tn,{children:y.jsx(tg,{})})}),y.jsx(rt,{path:"/eap",element:y.jsx(tn,{children:y.jsx(og,{})})}),y.jsx(rt,{path:"/reports",element:y.jsx(tn,{children:y.jsx(rg,{})})}),y.jsx(rt,{path:"/settings",element:y.jsx(tn,{children:y.jsx(ng,{})})})]})})]})})})]})}bh();const ug=new Sc({defaultOptions:{queries:{staleTime:3e4,retry:1,refetchOnWindowFocus:!0}}});oa.createRoot(document.getElementById("root")).render(y.jsx(Ic.StrictMode,{children:y.jsx(Dc,{children:y.jsx(Ec,{client:ug,children:y.jsx(yh,{children:y.jsx(ph,{children:y.jsxs(gh,{children:[y.jsx(cg,{}),y.jsx(Sh,{})]})})})})})}));export{Bg as $,Qg as A,hm as B,ty as C,ey as D,cy as E,ym as F,sy as G,iy as H,ny as I,ly as J,bm as K,dy as L,gn as M,Yn as N,jy as O,Bh as P,Ny as Q,Py as R,Cy as S,Uy as T,Ay as U,My as V,By as W,hh as X,mh as Y,Pe as Z,Vh as _,Ng as a,qg as a0,Kg as a1,Kh as a2,Ug as a3,Hg as a4,Fg as a5,$g as a6,Zg as a7,Wg as a8,Gn as a9,xy as aA,Ty as aB,my as aC,gy as aD,zy as aE,Ly as aF,Ry as aG,$y as aH,Fy as aI,Zy as aJ,hg as aK,he as aa,Jg as ab,Rg as ac,Lg as ad,Tg as ae,Gg as af,Xg as ag,Yg as ah,Og as ai,ay as aj,Gs as ak,Ys as al,bt as am,Rc as an,Vt as ao,Sy as ap,py as aq,yy as ar,hy as as,by as at,_y as au,vy as av,Dm as aw,Ey as ax,ky as ay,wy as az,Ig as b,jg as c,zg as d,Dg as e,Cg as f,Ag as g,Mg as h,Pg as i,fy as j,uy as k,ha as l,Oy as m,Dy as n,Iy as o,Ky as p,Oh as q,Vi as r,oy as s,Vg as t,Aa as u,ry as v,jr as w,mm as x,Vs as y,Js as z};
