import{a as Xt,j as e}from"./query-CQB1N7mz.js";import{r as b}from"./vendor-D5cPNHfC.js";import{m as Zt,O as es,U as ts,o as ss,n as as,V as rs,q as ls,p as ns,W as os,w as Me,X as ds,Y as is,Z as ce,P as We,t as Se,_ as cs,$ as xs,a0 as ms,a1 as us,a2 as hs,a3 as ps,a4 as bs,a5 as gs,a6 as fs,a7 as ks,a8 as js,l as Dt,a9 as vs}from"./index-P8Mr3XGt.js";import"./supabase-Br6iVc9W.js";const He=[{id:"low",label:"Baixa",color:"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300",dot:"bg-slate-400"},{id:"medium",label:"Media",color:"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400",dot:"bg-yellow-400"},{id:"high",label:"Alta",color:"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-400",dot:"bg-orange-500"},{id:"urgent",label:"Urgente",color:"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400",dot:"bg-red-500"}],Je={available:"Disponivel",in_progress:"Em Andamento",done:"Concluida"},st=[{id:"red",title:"Urgente / Alta",color:"from-red-500 to-red-600",priorities:["urgent","high"],emptyText:"Nenhuma O.S. urgente"},{id:"yellow",title:"Media",color:"from-yellow-400 to-amber-500",priorities:["medium"],emptyText:"Nenhuma O.S. media"},{id:"green",title:"Baixa",color:"from-green-500 to-emerald-600",priorities:["low"],emptyText:"Nenhuma O.S. de baixa prioridade"}],Be=[{id:"internal",label:"Interno",color:"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300"},{id:"bug",label:"Bug",color:"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400"},{id:"feature",label:"Feature",color:"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400"},{id:"support",label:"Suporte",color:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400"},{id:"compliance",label:"Compliance",color:"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400"},{id:"campaign",label:"Campanha",color:"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400"}],Ot=[{id:"material",label:"Aguardando Material"},{id:"approval",label:"Aguardando Aprovacao"},{id:"resource",label:"Aguardando Recurso"},{id:"dependency",label:"Dependencia de Outro Time"},{id:"other",label:"Outro"}],Ns=["#2563eb","#3b82f6","#f97316","#10b981","#ec4899","#eab308","#ef4444","#06b6d4","#84cc16","#f43f5e"],ys=["#3b82f6","#3b82f6","#10b981","#f97316","#ec4899","#eab308","#ef4444","#2563eb"],at={title:"",description:"",checklist:[],priority:"medium",category:"internal",client:"",clientId:"",location:"",notes:"",assignedTo:"",estimatedStart:"",estimatedEnd:"",attachments:[],projectId:null,parentOrderId:null,blockReason:null},Nt={name:"",sector:"",color:"#3b82f6",description:""};function Ne(t){return t?new Date(t).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}function yt(t){if(!t)return"-";const l=t.includes("T")&&t.length>10,E=new Date(t+(t.length===10?"T12:00:00":"")),C={day:"2-digit",month:"2-digit",year:"numeric"};return l&&(C.hour="2-digit",C.minute="2-digit"),E.toLocaleDateString("pt-BR",C)}const ws=["janeiro","fevereiro","marco","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"];function rt(t){const l=(t||"").replace(/\D/g,"");return l.length!==11?t||"":`${l.slice(0,3)}.${l.slice(3,6)}.${l.slice(6,9)}-${l.slice(9)}`}function lt(t){if(!t)return"";const l=new Date(t),E=l.getHours(),C=l.getMinutes(),Y=l.getDate(),A=ws[l.getMonth()],_=l.getFullYear();return`${E} horas e ${C} minutos do dia ${Y} do mes de ${A} do ano de ${_}`}const wt={label:"",color:"#3b82f6"};function ye(t){return(t||0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}function Cs(t,l){const A=new Date(t),_=new Date(l);if(_<=A)return 0;if(A.toDateString()===_.toDateString()){const J=A.getDay();if(J===0||J===6)return 0;const xe=Math.max(A.getHours()+A.getMinutes()/60,8),R=Math.min(_.getHours()+_.getMinutes()/60,18);return Math.max(0,R-xe)}let v=0;const k=new Date(A);if(k.getDay()!==0&&k.getDay()!==6){const J=Math.max(k.getHours()+k.getMinutes()/60,8);v+=Math.max(0,18-J)}k.setDate(k.getDate()+1),k.setHours(0,0,0,0);const V=new Date(_);for(V.setHours(0,0,0,0);k<V;){const J=k.getDay();J!==0&&J!==6&&(v+=10),k.setDate(k.getDate()+1)}if(_.getDay()!==0&&_.getDay()!==6){const J=Math.min(_.getHours()+_.getMinutes()/60,18);v+=Math.max(0,J-8)}return v}function Et(t){if(t.actualStart&&t.actualEnd){const C=Cs(t.actualStart,t.actualEnd);if(C>0)return C}const E=(t.checklist||[]).reduce((C,Y)=>C+(Y.durationMin||0),0);return E>0?E/60:0}function nt(t){const l=parseFloat(t.salaryMonth||t.salary_month||0),E=parseFloat(t.hoursMonth||t.hours_month||176);return l<=0||E<=0?0:l/E}function ot(t,l){const E=Et(t),C=l.find(v=>Me(v.name,t.assignee)||Me(v.name,t.assignedTo)),Y=C?nt(C):0,A=E*Y,_=(t.expenses||[]).reduce((v,k)=>v+(k.value||0)*(k.quantity||1),0);return{laborCost:A,materialCost:_,totalCost:A+_,hours:E,hourlyRate:Y,memberFound:!!C}}function Ct({color:t="currentColor",size:l=40}){return e.jsx("svg",{width:l,height:l,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z",fill:t,fillOpacity:.15})})}function Ss({size:t=40}){return e.jsxs("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12"}),e.jsx("path",{d:"M5.45 5.11L2 12v6a2 2 0 002 2h16a2 2 0 002-2v-6l-3.45-6.89A2 2 0 0016.76 4H7.24a2 2 0 00-1.79 1.11z"})]})}function As(){var gt,ft,kt,jt;const t=Xt(),{data:l=[],isLoading:E}=Zt(),{data:C=[],isLoading:Y}=es(),{data:A=[],isLoading:_}=ts(),{data:v=[],isLoading:k}=ss(),{data:V=[],isLoading:J}=as(),{data:xe=[]}=rs(),[R,x]=b.useState({});b.useEffect(()=>{ls().then(s=>x(s||{})).catch(()=>{})},[]),ns(),os();const he=E||Y||_||k||J,[f,K]=b.useState(null),[N,M]=b.useState(null),[X,W]=b.useState(!1),[F,y]=b.useState(null),[w,ae]=b.useState(null),[Q,re]=b.useState("all"),ge=b.useMemo(()=>{if(!R.name)return"";const s=v.find(a=>Me(a.name,R.name));return s?s.name:R.name},[R.name,v]),[H,Z]=b.useState({...at}),[r,L]=b.useState(!1),[le,d]=b.useState(0),p=20,[T,ee]=b.useState({}),[g,P]=b.useState(null),[pe,z]=b.useState(null),[ne,Ee]=b.useState(null),[ze,ve]=b.useState(!1),[fe,Ge]=b.useState(null),[Le,we]=b.useState({...Nt}),[i,h]=b.useState("all"),[D,q]=b.useState(""),[I,G]=b.useState(null),[se,$]=b.useState(!1),[oe,me]=b.useState(null),[de,De]=b.useState({...wt}),[Te,Ae]=b.useState(null),[o,ie]=b.useState(null),[je,Oe]=b.useState(!1),Ve=b.useCallback(s=>K(s),[]),_t=b.useCallback(s=>P(s),[]),Bt=b.useCallback(()=>{P(null),z(null),Ee(null)},[]),At=b.useCallback((s,a)=>Ee({cardId:s,position:a}),[]),Ke=b.useCallback(()=>{},[]),dt=b.useMemo(()=>{const s=(R.role||"").toLowerCase().trim();return s?ds.some(a=>s.includes(a)):!1},[R]),{hasPermission:Pe}=is(),$t=Pe("os.create"),qe=Pe("os.edit"),Qe=Pe("os.delete"),Ce=Pe("os.manage_projects"),Ue=Pe("financial.view_costs"),ue=b.useMemo(()=>!R.name||v.some(a=>Me(a.name,R.name))?v:[{id:"profile_self",name:R.name,role:R.role||"",color:"#3b82f6"},...v],[v,R]),Xe=b.useMemo(()=>l.reduce((s,a)=>Math.max(s,a.number||0),0)+1,[l]),Ze=b.useMemo(()=>l.filter(s=>s.type==="emergency").reduce((s,a)=>Math.max(s,a.emergencyNumber||0),0)+1,[l]),$e=b.useMemo(()=>N?N.id==="__no_project__"?l.filter(s=>!s.projectId):l.filter(s=>s.projectId===N.id):l,[l,N]),Re=b.useMemo(()=>{var a;if(Q==="all")return $e;const s=(a=ue.find(n=>n.id===Q))==null?void 0:a.name;return s?$e.filter(n=>n.assignee===s||n.assignedTo===s||n.status==="available"):$e},[$e,Q,ue]),it=b.useMemo(()=>Re.filter(s=>s.status!=="done"&&s.type!=="emergency"),[Re]),et=b.useMemo(()=>Re.filter(s=>s.type==="emergency"&&s.status!=="done"),[Re]),_e=b.useMemo(()=>Re.filter(s=>s.status==="done"),[Re]),tt=b.useMemo(()=>{const s={};return st.forEach(a=>{s[a.id]=it.filter(n=>a.priorities.includes(n.priority)).sort((n,m)=>(n.sortOrder??0)-(m.sortOrder??0))}),s},[it]),Rt=b.useMemo(()=>{const s={};let a=1;return st.forEach(n=>{(tt[n.id]||[]).forEach(m=>{s[m.id]=a++})}),s},[tt]),ct=b.useMemo(()=>{let s=C;if(i!=="all"&&(s=s.filter(a=>a.sector===i)),D.trim()){const a=D.trim().toLowerCase();s=s.filter(n=>n.name.toLowerCase().includes(a)||(n.description||"").toLowerCase().includes(a))}return s},[C,i,D]),Ye=b.useMemo(()=>l.filter(s=>!s.projectId),[l]),Wt=()=>{y(null),Oe(!1),Z({...at,projectId:(N==null?void 0:N.id)==="__no_project__"?null:(N==null?void 0:N.id)||null}),W(!0)},Tt=()=>{y(null),Oe(!0),Z({...at,priority:"urgent",projectId:(N==null?void 0:N.id)==="__no_project__"?null:(N==null?void 0:N.id)||null}),W(!0)},Pt=s=>{y(s),Z({title:s.title,description:s.description||"",checklist:s.checklist||[],priority:s.priority||"medium",category:s.category||"internal",client:s.client||"",clientId:s.clientId||"",location:s.location||"",notes:s.notes||"",assignedTo:s.assignedTo||"",estimatedStart:s.estimatedStart||"",estimatedEnd:s.estimatedEnd||"",attachments:s.attachments||[],projectId:s.projectId||null,parentOrderId:s.parentOrderId||null,blockReason:s.blockReason||null}),W(!0)},xt=async s=>{const a=s||H;if(a.title.trim())if(F){const n=await We(F.id,a);n&&(t.setQueryData(ce.osOrders,m=>(m||[]).map(c=>c.id===F.id?n:c)),(f==null?void 0:f.id)===F.id&&K(n)),W(!1)}else{let n=a.estimatedStart,m=a.estimatedEnd;if(a.assignedTo&&!a.estimatedStart){const u=new Date;u.setDate(u.getDate()+1),u.setHours(8,0,0,0),n=u.toISOString().slice(0,16);const O=new Date(u);O.setHours(9,0,0,0),m=m||O.toISOString().slice(0,16)}const c={id:`preview_${Date.now()}`,number:je?null:Xe,...a,estimatedStart:n,estimatedEnd:m,type:je?"emergency":"normal",emergencyNumber:je?Ze:null,parentOrderId:a.parentOrderId||null,priority:je?"urgent":a.priority,status:"available",assignee:null,sortOrder:l.length,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};ie(c),W(!1)}},It=async()=>{if(!o)return;const{id:s,...a}=o,n=await cs(a);n&&t.setQueryData(ce.osOrders,m=>[...m||[],n]),ie(null)},Ft=()=>{ie(null)},Ht=()=>{Oe(o.type==="emergency"),Z({title:o.title||"",description:o.description||"",checklist:o.checklist||[],priority:o.priority||"medium",category:o.category||"internal",client:o.client||"",clientId:o.clientId||"",location:o.location||"",notes:o.notes||"",assignedTo:o.assignedTo||"",estimatedStart:o.estimatedStart||"",estimatedEnd:o.estimatedEnd||"",attachments:o.attachments||[],projectId:o.projectId||null,parentOrderId:o.parentOrderId||null,blockReason:o.blockReason||null}),ie(null),W(!0)},mt=async s=>{await xs(s),t.setQueryData(ce.osOrders,a=>(a||[]).filter(n=>n.id!==s)),ae(null),(f==null?void 0:f.id)===s&&K(null)},zt=async s=>{var u;const a=new Date().toISOString(),n=l.find(O=>O.id===s);let m={};if(((u=n==null?void 0:n.checklist)==null?void 0:u.length)>0){const O=n.checklist.findIndex(B=>!B.done);O>=0&&(m={checklist:n.checklist.map((B,S)=>S===O?{...B,startedAt:a}:B)})}const c=await We(s,{assignee:R.name||ge,status:"in_progress",actualStart:a,...m});c&&(t.setQueryData(ce.osOrders,O=>(O||[]).map(B=>B.id===s?c:B)),(f==null?void 0:f.id)===s&&K(c))},Gt=async s=>{const a=await We(s,{assignee:null,status:"available"});a&&(t.setQueryData(ce.osOrders,n=>(n||[]).map(m=>m.id===s?a:m)),(f==null?void 0:f.id)===s&&K(a))},Vt=async s=>{var u;const a=new Date().toISOString(),n=l.find(O=>O.id===s);if(!n)return;let m;if(n.status==="available"){if(m={assignee:ge,status:"in_progress",actualStart:a},((u=n.checklist)==null?void 0:u.length)>0){const O=n.checklist.findIndex(B=>!B.done);O>=0&&(m.checklist=n.checklist.map((B,S)=>S===O?{...B,startedAt:a}:B))}}else if(n.status==="in_progress")m={status:"done",actualEnd:a};else return;const c=await We(s,m);c&&(t.setQueryData(ce.osOrders,O=>(O||[]).map(B=>B.id===s?c:B)),(f==null?void 0:f.id)===s&&K(c))},qt=async s=>{const a=l.find(c=>c.id===s);if(!a)return;let n;if(a.status==="done")n={status:"in_progress",actualEnd:""};else if(a.status==="in_progress")n={assignee:null,status:"available",actualStart:""};else return;const m=await We(s,n);m&&(t.setQueryData(ce.osOrders,c=>(c||[]).map(u=>u.id===s?m:u)),(f==null?void 0:f.id)===s&&K(m))},Qt=async(s,a,n,m)=>{const c=l.find(j=>j.id===s);if(!c)return;const u=a.priorities.includes(c.priority)?c.priority:a.priorities[a.priorities.length-1],O=l.filter(j=>j.id!==s&&a.priorities.includes(j.id===s?u:j.priority)).sort((j,te)=>(j.sortOrder??0)-(te.sortOrder??0));let B=O.length;if(n){const j=O.findIndex(te=>te.id===n);j!==-1&&(B=m==="before"?j:j+1)}O.splice(B,0,{...c,priority:u});const S={};O.forEach((j,te)=>{S[j.id]=te});const ke=l.map(j=>j.id===s?{...j,priority:u,sortOrder:S[j.id]??j.sortOrder}:S[j.id]!==void 0?{...j,sortOrder:S[j.id]}:j);t.setQueryData(ce.osOrders,ke),(f==null?void 0:f.id)===s&&K(ke.find(j=>j.id===s));const U=[];U.push({id:s,priority:u,sortOrder:S[s]??c.sortOrder});for(const[j,te]of Object.entries(S)){if(j===s)continue;const be=l.find(Ie=>Ie.id===j);be&&(be.sortOrder??0)!==te&&U.push({id:j,sortOrder:te})}await ms(U)},ut=()=>{Ge(null),we({...Nt}),ve(!0)},ht=s=>{Ge(s),we({name:s.name,sector:s.sector,color:s.color,description:s.description||""}),ve(!0)},pt=async()=>{if(!Le.name.trim())return;const s={...Le,sector:Le.sector||null};if(fe){const a=await us(fe.id,s);a&&(t.setQueryData(ce.osProjects,n=>(n||[]).map(m=>m.id===fe.id?a:m)),(N==null?void 0:N.id)===fe.id&&M(a))}else{const a=await hs(s);a&&t.setQueryData(ce.osProjects,n=>[...n||[],a])}ve(!1)},bt=async s=>{await ps(s),await bs(s),t.setQueryData(ce.osProjects,a=>(a||[]).filter(n=>n.id!==s)),t.setQueryData(ce.osOrders,a=>(a||[]).map(n=>n.projectId===s?{...n,projectId:null}:n)),G(null),(N==null?void 0:N.id)===s&&M(null)},Ut=()=>{me(null),De({...wt}),$(!0)},Yt=s=>{me(s),De({label:s.label,color:s.color}),$(!0)},Jt=async()=>{if(de.label.trim()){if(oe){const s=await gs(oe.id,{label:de.label.trim(),color:de.color});s&&t.setQueryData(ce.osSectors,a=>(a||[]).map(n=>n.id===oe.id?s:n))}else{const s=await fs({label:de.label.trim(),color:de.color});s&&t.setQueryData(ce.osSectors,a=>[...a||[],s])}$(!1)}},Kt=async s=>{await ks(s),await js(s),t.setQueryData(ce.osSectors,a=>(a||[]).filter(n=>n.id!==s)),t.setQueryData(ce.osProjects,a=>(a||[]).map(n=>n.sector===s?{...n,sector:""}:n)),(N==null?void 0:N.sector)===s&&M({...N,sector:""}),Ae(null),i===s&&h("all")};if(he)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-10 h-10 border-4 border-fyness-primary border-t-transparent rounded-full animate-spin"})});if(o){const s=((gt=C.find(a=>a.id===o.projectId))==null?void 0:gt.name)||null;return e.jsx(Ls,{order:o,projectName:s,profileName:R.name||"",profileCpf:R.cpf||"",teamMembers:ue,allOrders:l,onConfirm:It,onEdit:Ht,onCancel:Ft})}if(f){const s=((ft=C.find(a=>a.id===f.projectId))==null?void 0:ft.name)||null;return e.jsxs(e.Fragment,{children:[e.jsx(Ms,{order:f,currentUser:ge,projectName:s,isManager:dt,canEditOS:qe,canDeleteOS:Qe,canViewCosts:Ue,profileName:R.name||"",profileCpf:R.cpf||"",teamMembers:ue,allOrders:l,onBack:()=>K(null),onEdit:qe?()=>Pt(f):null,onClaim:()=>zt(f.id),onRelease:()=>Gt(f.id),onMoveForward:qe?()=>Vt(f.id):null,onMoveBack:qe?()=>qt(f.id):null,onDelete:Qe?()=>ae(f.id):null,onViewOrder:a=>K(a),onUpdateOrder:async(a,n)=>{K(c=>c&&{...c,...n,updatedAt:new Date().toISOString()}),t.setQueryData(ce.osOrders,c=>(c||[]).map(u=>u.id===a?{...u,...n,updatedAt:new Date().toISOString()}:u));const m=await We(a,n);m?(t.setQueryData(ce.osOrders,c=>(c||[]).map(u=>u.id===a?m:u)),K(c=>c&&c.id===a?m:c)):(vs("Erro ao salvar alteracao","error"),t.invalidateQueries({queryKey:ce.osOrders}))}}),X&&e.jsx(Mt,{form:H,setForm:Z,editing:!!F,number:(F==null?void 0:F.number)||Xe,projects:C,teamMembers:ue,clients:xe,onSave:xt,onClose:()=>{W(!1),y(null),Oe(!1)},onDelete:Qe&&F?()=>{ae(F.id),W(!1)}:null,isEmergency:je,emergencyNumber:Ze,allOrders:l}),w&&e.jsx(Fe,{title:"Excluir O.S.?",message:"Esta acao nao pode ser desfeita.",onCancel:()=>ae(null),onConfirm:()=>mt(w)})]})}if(N){const s=A.find(a=>a.id===N.sector);return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>{M(null),re("all"),L(!1)},className:"flex items-center gap-2 text-sm text-slate-600 dark:text-slate-300 hover:text-slate-800 dark:hover:text-slate-100 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Projetos"]}),e.jsx("div",{className:"w-px h-6 bg-slate-200 dark:bg-slate-700"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:N.color}}),e.jsx("h2",{className:"text-lg font-bold text-slate-800 dark:text-slate-100",children:N.name}),s&&e.jsx("span",{className:"text-[10px] font-semibold px-2 py-0.5 rounded-full text-white",style:{backgroundColor:s.color},children:s.label})]}),$t&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:Wt,className:"flex items-center gap-2 px-4 py-2 bg-fyness-primary text-white rounded-lg hover:bg-fyness-secondary transition-colors text-sm font-medium shadow-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Nova O.S."]}),e.jsxs("button",{onClick:Tt,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium shadow-sm animate-pulse hover:animate-none",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})}),"Emergencial"]})]}),e.jsxs("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:[$e.length," ordem",$e.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[Ce&&N.id!=="__no_project__"&&e.jsx("button",{onClick:()=>ht(N),className:"p-1.5 text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",title:"Editar projeto",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("label",{htmlFor:"filter-member",className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:"Filtrar:"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{id:"filter-member",value:Q,onChange:a=>re(a.target.value),className:"appearance-none pl-3 pr-8 py-1.5 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent cursor-pointer",children:[e.jsx("option",{value:"all",children:"Todos"}),ue.map(a=>e.jsx("option",{value:a.id,children:Se(a.name)},a.id))]}),e.jsx("svg",{className:"w-4 h-4 text-slate-400 dark:text-slate-500 absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),Q!=="all"&&e.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 text-xs rounded-full font-medium text-white shadow-sm",style:{backgroundColor:((kt=ue.find(a=>a.id===Q))==null?void 0:kt.color)||"#3b82f6"},children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-white/70"}),Se((jt=ue.find(a=>a.id===Q))==null?void 0:jt.name),e.jsx("button",{onClick:()=>re("all"),className:"ml-1 hover:bg-white/20 rounded-full p-0.5 transition-colors",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})]})]})]}),et.length>0&&e.jsxs("div",{className:"mb-4 rounded-xl border-2 border-red-500 dark:border-red-600 bg-red-50 dark:bg-red-950/30 overflow-hidden animate-pulse-subtle",children:[e.jsxs("div",{className:"bg-gradient-to-r from-red-600 to-red-700 px-4 py-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("h3",{className:"text-sm font-bold text-white uppercase tracking-wider",children:"Emergenciais"}),e.jsx("span",{className:"bg-white/20 text-white text-xs px-2 py-0.5 rounded-full font-medium",children:et.length})]}),e.jsx("div",{className:"p-3 flex flex-wrap gap-3",children:et.map(a=>e.jsx(St,{order:a,teamMembers:ue,seqNumber:null,onClick:()=>Ve(a),isDragging:!1,dropPosition:null,onDragStart:Ke,onDragEnd:Ke,onCardDragOver:Ke,allOrders:l},a.id))})]}),e.jsx("div",{className:"flex-1 grid grid-cols-3 gap-4 min-h-0",children:st.map(a=>{const n=tt[a.id]||[],m=pe===a.id&&!ne;return e.jsxs("div",{className:`flex flex-col rounded-xl border-2 overflow-hidden transition-all duration-200 ${m?"border-fyness-primary bg-fyness-primary/5 shadow-lg":"border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50"}`,onDragOver:c=>{c.preventDefault(),z(a.id)},onDragEnter:c=>{c.preventDefault(),z(a.id)},onDragLeave:c=>{c.currentTarget.contains(c.relatedTarget)||(z(null),Ee(null))},onDrop:c=>{c.preventDefault();const u=c.dataTransfer.getData("text/plain");u&&Qt(u,a,ne==null?void 0:ne.cardId,ne==null?void 0:ne.position),z(null),Ee(null),P(null)},children:[e.jsxs("div",{className:`bg-gradient-to-r ${a.color} px-4 py-3 flex items-center gap-2`,children:[e.jsx("h3",{className:"text-sm font-semibold text-white",children:a.title}),e.jsx("span",{className:"bg-white/20 text-white text-xs px-2 py-0.5 rounded-full font-medium",children:n.length})]}),e.jsx("div",{className:`flex-1 overflow-y-auto p-3 space-y-0 min-h-[100px] ${m?"bg-fyness-primary/5":""}`,children:n.length===0?e.jsx("div",{className:`text-center py-8 text-sm ${m?"text-fyness-primary font-medium":"text-slate-400 dark:text-slate-500"}`,children:m?"Soltar aqui":a.emptyText}):e.jsxs(e.Fragment,{children:[(T[a.id]?n:n.slice(0,p)).map(c=>e.jsx(St,{order:c,teamMembers:ue,seqNumber:Rt[c.id],onClick:()=>Ve(c),isDragging:g===c.id,dropPosition:(ne==null?void 0:ne.cardId)===c.id?ne.position:null,onDragStart:()=>_t(c.id),onDragEnd:Bt,onCardDragOver:u=>At(c.id,u),allOrders:l},c.id)),n.length>p&&!T[a.id]&&e.jsxs("button",{onClick:()=>ee(c=>({...c,[a.id]:!0})),className:"w-full mt-2 py-2 text-xs font-medium text-fyness-primary hover:bg-fyness-primary/5 rounded-lg transition-colors",children:["Ver mais ",n.length-p," O.S."]})]})})]},a.id)})}),_e.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("button",{onClick:()=>L(!r),className:"flex items-center gap-2 text-sm font-medium text-slate-600 dark:text-slate-300 hover:text-slate-800 dark:hover:text-slate-100 transition-colors",children:[e.jsx("svg",{className:`w-4 h-4 transition-transform ${r?"rotate-90":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),e.jsxs("span",{className:"flex items-center gap-2",children:["Concluidas",e.jsx("span",{className:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 text-xs px-2 py-0.5 rounded-full font-medium",children:_e.length})]})]}),r&&(()=>{const n=Math.ceil(_e.length/15),m=Math.min(le,n-1),c=_e.slice(m*15,(m+1)*15);return e.jsxs("div",{className:"mt-3 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 overflow-hidden",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 dark:bg-slate-800/50 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("th",{className:"text-left px-4 py-2.5 text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"O.S."}),e.jsx("th",{className:"text-left px-4 py-2.5 text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Titulo"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Cliente"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Responsavel"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-[10px] font-semibold text-green-500 uppercase tracking-wider",children:"Inicio Real"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-[10px] font-semibold text-green-500 uppercase tracking-wider",children:"Fim Real"}),e.jsx("th",{className:"text-center px-4 py-2.5 text-[10px] font-semibold text-blue-400 uppercase tracking-wider",children:"Previsto vs Real"}),Ue&&e.jsx("th",{className:"text-right px-4 py-2.5 text-[10px] font-semibold text-amber-500 uppercase tracking-wider",children:"Custo"})]})}),e.jsx("tbody",{children:c.map(u=>{const B=ue.find(S=>S.id===u.assignee||Me(S.name,u.assignee))||(u.assignee?{id:u.assignee,name:u.assignee,color:"#3b82f6"}:null);return e.jsxs("tr",{onClick:()=>K(u),className:"border-b border-slate-100 dark:border-slate-700 last:border-b-0 hover:bg-slate-50 dark:hover:bg-slate-700/50 cursor-pointer transition-colors",children:[e.jsx("td",{className:`px-4 py-2.5 font-bold ${u.type==="emergency"?"text-red-500 dark:text-red-400":"text-slate-400 dark:text-slate-500"}`,children:u.type==="emergency"?`EMG-${String(u.emergencyNumber||0).padStart(3,"0")}`:`#${u.number}`}),e.jsx("td",{className:"px-4 py-2.5 font-medium text-slate-800 dark:text-slate-100",children:u.title}),e.jsx("td",{className:"px-4 py-2.5 text-slate-500 dark:text-slate-400",children:u.client||"-"}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsxs("div",{className:"flex flex-col gap-0.5",children:[u.assignedTo&&e.jsxs("span",{className:"text-[10px] text-blue-600 font-medium",children:["Para: ",Se(u.assignedTo)]}),B?e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-5 h-5 rounded-full flex items-center justify-center text-white text-[9px] font-bold",style:{backgroundColor:B.color},children:B.name.charAt(0)}),e.jsx("span",{className:"text-slate-600 dark:text-slate-300",children:Se(B.name)})]}):u.assignedTo?null:e.jsx("span",{className:"text-slate-400 dark:text-slate-500 italic",children:"-"})]})}),e.jsx("td",{className:"px-4 py-2.5 text-slate-600 dark:text-slate-300",children:Ne(u.actualStart)}),e.jsx("td",{className:"px-4 py-2.5 text-slate-600 dark:text-slate-300",children:Ne(u.actualEnd)}),e.jsx("td",{className:"px-4 py-2.5 text-center",children:(()=>{const S=be=>{if(!be||be<=0)return"-";if(be<1)return`${Math.round(be*60)}min`;const Ie=Math.floor(be),vt=Math.round((be-Ie)*60);return vt>0?`${Ie}h${vt}m`:`${Ie}h`},ke=Et(u);let U=0;if(u.estimatedStart&&u.estimatedEnd){const be=new Date(u.estimatedEnd)-new Date(u.estimatedStart);be>0&&(U=be/(1e3*60*60))}if(!U&&u.leadTimeHours&&(U=u.leadTimeHours),!U&&!ke)return e.jsx("span",{className:"text-slate-400",children:"-"});if(!U)return e.jsxs("span",{className:"text-slate-400 text-[10px]",children:["Real: ",S(ke)]});const j=ke-U,te=j<0;return e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px]",children:[e.jsx("span",{className:"text-slate-400",children:S(U)}),e.jsx("span",{className:"text-slate-500",children:"→"}),e.jsx("span",{className:"text-slate-300 font-medium",children:S(ke)})]}),j!==0&&e.jsxs("span",{className:`text-[9px] font-bold ${te?"text-emerald-500":"text-red-400"}`,children:[te?"▼":"▲"," ",S(Math.abs(j))," ",te?"antes":"a mais"]}),j===0&&e.jsx("span",{className:"text-[9px] font-bold text-blue-400",children:"= no prazo"})]})})()}),Ue&&e.jsx("td",{className:"px-4 py-2.5 text-right",children:(()=>{const S=ot(u,ue),ke=U=>{if(!U||U<=0)return"";if(U<1)return`${Math.round(U*60)}min`;const j=Math.floor(U),te=Math.round((U-j)*60);return te>0?`${j}h${te}m`:`${j}h`};return e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-slate-800 dark:text-slate-100",children:ye(S.totalCost)}),S.hours>0&&e.jsx("p",{className:"text-[9px] text-slate-400",children:ke(S.hours)}),S.materialCost>0&&e.jsxs("p",{className:"text-[9px] text-amber-600",children:["Mat: ",ye(S.materialCost)]})]})})()})]},u.id)})}),Ue&&e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-slate-50 dark:bg-slate-800/50 border-t-2 border-slate-300 dark:border-slate-600",children:[e.jsx("td",{colSpan:"7",className:"px-4 py-2.5 text-right text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase",children:"Total"}),e.jsx("td",{className:"px-4 py-2.5 text-right",children:e.jsx("span",{className:"text-sm font-bold text-blue-600",children:ye(_e.reduce((u,O)=>u+ot(O,ue).totalCost,0))})})]})})]}),n>1&&e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50",children:[e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:[m*15+1,"-",Math.min((m+1)*15,_e.length)," de ",_e.length]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>d(Math.max(0,m-1)),disabled:m===0,className:"px-2.5 py-1 text-xs rounded-lg border border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-300 hover:bg-white dark:hover:bg-slate-700 transition-colors disabled:opacity-40 disabled:cursor-not-allowed",children:"Anterior"}),Array.from({length:n},(u,O)=>e.jsx("button",{onClick:()=>d(O),className:`w-7 h-7 text-xs rounded-lg transition-colors ${O===m?"bg-fyness-primary text-white":"border border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-300 hover:bg-white dark:hover:bg-slate-700"}`,children:O+1},O)),e.jsx("button",{onClick:()=>d(Math.min(n-1,m+1)),disabled:m===n-1,className:"px-2.5 py-1 text-xs rounded-lg border border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-300 hover:bg-white dark:hover:bg-slate-700 transition-colors disabled:opacity-40 disabled:cursor-not-allowed",children:"Proximo"})]})]})]})})()]}),dt&&(()=>{const a=new Date,n=V.filter(m=>{if(m.type!=="meeting")return!1;const c=new Date(m.startDate);return c.getMonth()===a.getMonth()&&c.getFullYear()===a.getFullYear()});return n.length===0?null:e.jsxs("div",{className:"mt-6 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-slate-100 dark:border-slate-700 flex items-center justify-between",children:e.jsxs("h3",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-purple-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),"Reunioes do Mes (",n.length,")"]})}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 dark:bg-slate-800/50 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("th",{className:"text-left px-4 py-2.5 text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Data"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Titulo"}),e.jsx("th",{className:"text-left px-4 py-2.5 text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Participantes"}),e.jsx("th",{className:"text-right px-4 py-2.5 text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Duracao"}),e.jsx("th",{className:"text-right px-4 py-2.5 text-[10px] font-semibold text-purple-500 uppercase tracking-wider",children:"Custo"})]})}),e.jsx("tbody",{children:n.map(m=>{const c=new Date(m.startDate),u=new Date(m.endDate),O=Math.max((u-c)/36e5,0),B=m.attendees&&m.attendees.length>0?m.attendees:m.assignee?[m.assignee]:[],S=B.reduce((U,j)=>{const te=ue.find(be=>be.id===j);return U+(te?nt(te):0)},0),ke=O*S;return e.jsxs("tr",{className:"border-b border-slate-100 dark:border-slate-700 last:border-b-0 hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[e.jsx("td",{className:"px-4 py-2.5 text-sm text-slate-600 dark:text-slate-300",children:c.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})}),e.jsx("td",{className:"px-4 py-2.5 text-sm font-medium text-slate-800 dark:text-slate-100",children:m.title}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[B.map(U=>{const j=ue.find(te=>te.id===U);return j?e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded-full text-white font-medium",style:{backgroundColor:j.color},children:Se(j.name)},U):null}),B.length===0&&e.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500 italic",children:"-"})]})}),e.jsxs("td",{className:"px-4 py-2.5 text-right text-sm text-slate-600 dark:text-slate-300",children:[O.toFixed(1),"h"]}),e.jsx("td",{className:"px-4 py-2.5 text-right",children:e.jsx("span",{className:"font-bold text-slate-800 dark:text-slate-100",children:ye(ke)})})]},m.id)})}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"bg-slate-50 dark:bg-slate-800/50 border-t-2 border-slate-300 dark:border-slate-600",children:[e.jsx("td",{colSpan:"4",className:"px-4 py-2.5 text-right text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase",children:"Total"}),e.jsx("td",{className:"px-4 py-2.5 text-right",children:e.jsx("span",{className:"text-sm font-bold text-purple-600",children:ye(n.reduce((m,c)=>{const u=new Date(c.startDate),O=new Date(c.endDate),B=Math.max((O-u)/36e5,0),ke=(c.attendees&&c.attendees.length>0?c.attendees:c.assignee?[c.assignee]:[]).reduce((U,j)=>{const te=ue.find(be=>be.id===j);return U+(te?nt(te):0)},0);return m+B*ke},0))})})]})})]})]})})(),X&&e.jsx(Mt,{form:H,setForm:Z,editing:!!F,number:(F==null?void 0:F.number)||Xe,projects:C,teamMembers:ue,clients:xe,onSave:xt,onClose:()=>{W(!1),Oe(!1)},onDelete:Qe&&F?()=>{ae(F.id),W(!1)}:null,isEmergency:je,emergencyNumber:Ze,allOrders:l}),w&&e.jsx(Fe,{title:"Excluir O.S.?",message:"Esta acao nao pode ser desfeita.",onCancel:()=>ae(null),onConfirm:()=>mt(w)}),ze&&e.jsx(Lt,{form:Le,setForm:we,editing:!!fe,sectors:A,onSave:pt,onClose:()=>ve(!1),onDelete:Ce&&fe?()=>{G(fe.id),ve(!1)}:null}),I&&e.jsx(Fe,{title:"Excluir projeto?",message:"As O.S. deste projeto ficaram sem projeto atribuido.",onCancel:()=>G(null),onConfirm:()=>bt(I)})]})}return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:"Projetos"}),e.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400 bg-slate-100 dark:bg-slate-700 px-2.5 py-0.5 rounded-full font-medium",children:C.length})]}),Ce&&e.jsxs("button",{onClick:ut,className:"flex items-center gap-2 px-4 py-2 bg-fyness-primary text-white rounded-lg hover:bg-fyness-secondary transition-colors text-sm font-medium shadow-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Novo Projeto"]})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-xs",children:[e.jsx("svg",{className:"w-4 h-4 text-slate-400 dark:text-slate-500 absolute left-3 top-1/2 -translate-y-1/2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",value:D,onChange:s=>q(s.target.value),placeholder:"Buscar projeto...",className:"w-full pl-9 pr-3 py-2 text-sm border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:()=>h("all"),className:`px-3 py-1.5 text-xs font-medium rounded-full transition-colors ${i==="all"?"bg-slate-800 dark:bg-slate-200 text-white dark:text-slate-800":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:"Todos"}),A.map(s=>e.jsxs("div",{className:"relative group/sector",children:[e.jsx("button",{onClick:()=>h(i===s.id?"all":s.id),className:`px-3 py-1.5 text-xs font-medium rounded-full transition-colors ${i===s.id?"text-white pr-7":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,style:i===s.id?{backgroundColor:s.color}:void 0,children:s.label}),Ce&&i===s.id&&e.jsx("button",{onClick:a=>{a.stopPropagation(),Yt(s)},className:"absolute right-1 top-1/2 -translate-y-1/2 w-4 h-4 flex items-center justify-center text-white/70 hover:text-white transition-colors",title:"Editar setor",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]},s.id)),Ce&&e.jsx("button",{onClick:Ut,className:"px-2 py-1.5 text-xs font-medium rounded-full bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-600 hover:text-slate-700 dark:hover:text-slate-200 transition-colors",title:"Novo setor",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[ct.map(s=>{const a=l.filter(S=>S.projectId===s.id),n=a.length,m=a.filter(S=>S.status==="in_progress").length,c=a.filter(S=>S.status==="done").length,u=a.filter(S=>S.status==="available").length,O=n>0?Math.round(c/n*100):0,B=A.find(S=>S.id===s.sector);return e.jsxs("div",{onClick:()=>M(s),className:"group bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 p-5 cursor-pointer hover:shadow-lg hover:border-slate-300 dark:hover:border-slate-600 transition-all duration-200 hover:-translate-y-0.5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx(Ct,{color:s.color,size:40}),Ce&&e.jsx("button",{onClick:S=>{S.stopPropagation(),ht(s)},className:"p-1 text-slate-300 dark:text-slate-600 hover:text-slate-500 dark:hover:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 rounded transition-colors opacity-0 group-hover:opacity-100",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})]}),e.jsx("h3",{className:"text-sm font-bold text-slate-800 dark:text-slate-100 mb-1 group-hover:text-fyness-primary transition-colors",children:s.name}),B&&e.jsx("span",{className:"inline-block text-[10px] font-semibold px-2 py-0.5 rounded-full text-white mb-2",style:{backgroundColor:B.color},children:B.label}),s.description&&e.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-400 mb-3 line-clamp-1",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500 dark:text-slate-400 mb-2",children:[e.jsxs("span",{className:"font-medium",children:[n," O.S."]}),e.jsx("span",{className:"text-slate-300 dark:text-slate-600",children:"|"}),m>0&&e.jsxs("span",{className:"text-blue-600",children:[m," andamento"]}),m>0&&u>0&&e.jsx("span",{className:"text-slate-300 dark:text-slate-600",children:"|"}),u>0&&e.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:[u," disponiv."]})]}),n>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-1.5 bg-slate-100 dark:bg-slate-600 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-500",style:{width:`${O}%`,backgroundColor:s.color}})}),e.jsxs("span",{className:"text-[10px] font-medium text-slate-400 dark:text-slate-500",children:[O,"%"]})]})]},s.id)}),Ye.length>0&&i==="all"&&!D.trim()&&e.jsxs("div",{onClick:()=>M({id:"__no_project__",name:"Sem Projeto",color:"#94a3b8",sector:null}),className:"group bg-white dark:bg-slate-800 rounded-xl border-2 border-dashed border-slate-300 dark:border-slate-600 p-5 cursor-pointer hover:shadow-lg hover:border-slate-400 dark:hover:border-slate-500 transition-all duration-200 hover:-translate-y-0.5",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsx("div",{className:"text-slate-400 dark:text-slate-500",children:e.jsx(Ss,{size:40})})}),e.jsx("h3",{className:"text-sm font-bold text-slate-600 dark:text-slate-300 mb-1",children:"Sem Projeto"}),e.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500 mb-3",children:"Ordens de servico nao atribuidas a nenhum projeto"}),e.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-slate-500 dark:text-slate-400",children:[e.jsxs("span",{className:"font-medium",children:[Ye.length," O.S."]}),e.jsx("span",{className:"text-slate-300 dark:text-slate-600",children:"|"}),e.jsxs("span",{className:"text-blue-600",children:[Ye.filter(s=>s.status==="in_progress").length," andamento"]})]})]})]}),ct.length===0&&Ye.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[e.jsx("div",{className:"text-slate-300 dark:text-slate-600 mb-4",children:e.jsx(Ct,{color:"#cbd5e1",size:64})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-600 dark:text-slate-300 mb-1",children:"Nenhum projeto encontrado"}),e.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500 mb-4",children:D.trim()||i!=="all"?"Tente ajustar os filtros de busca":"Crie seu primeiro projeto para organizar as O.S."}),Ce&&!D.trim()&&i==="all"&&e.jsx("button",{onClick:ut,className:"px-4 py-2 bg-fyness-primary text-white rounded-lg hover:bg-fyness-secondary transition-colors text-sm font-medium",children:"Criar Projeto"})]})]}),ze&&e.jsx(Lt,{form:Le,setForm:we,editing:!!fe,sectors:A,onSave:pt,onClose:()=>ve(!1),onDelete:Ce&&fe?()=>{G(fe.id),ve(!1)}:null}),I&&e.jsx(Fe,{title:"Excluir projeto?",message:"As O.S. deste projeto ficaram sem projeto atribuido.",onCancel:()=>G(null),onConfirm:()=>bt(I)}),se&&e.jsx(Ds,{form:de,setForm:De,editing:!!oe,onSave:Jt,onClose:()=>$(!1),onDelete:Ce&&oe?()=>{Ae(oe.id),$(!1)}:null}),Te&&e.jsx(Fe,{title:"Excluir setor?",message:"Projetos deste setor ficaram sem setor atribuido.",onCancel:()=>Ae(null),onConfirm:()=>Kt(Te)})]})}const St=b.memo(function({order:l,onClick:E,isDragging:C,dropPosition:Y,onDragStart:A,onDragEnd:_,onCardDragOver:v,teamMembers:k,seqNumber:V,allOrders:J=[]}){const R=k.find(M=>M.id===l.assignee||Me(M.name,l.assignee))||(l.assignee?{id:l.assignee,name:l.assignee,color:"#3b82f6"}:null),x=l.type==="emergency",he=x&&l.parentOrderId?J.find(M=>M.id===l.parentOrderId):null,f=l.status==="available"?"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300":l.status==="in_progress"?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400",K=l.status==="available"?"bg-slate-400":l.status==="in_progress"?"bg-blue-500":"bg-green-500",N=M=>{M.preventDefault(),M.stopPropagation();const X=M.currentTarget.getBoundingClientRect(),F=M.clientY-X.top<X.height/2?"before":"after";v(F)};return e.jsxs("div",{className:"py-1",children:[Y==="before"&&e.jsx("div",{className:"h-1 bg-fyness-primary rounded-full mx-1 mb-1 animate-pulse"}),e.jsxs("div",{draggable:!x,onDragStart:x?void 0:M=>{M.dataTransfer.setData("text/plain",l.id),M.dataTransfer.effectAllowed="move",A()},onDragEnd:x?void 0:_,onDragOver:x?void 0:N,onClick:E,className:`rounded-lg p-3 transition-all group ${x?"bg-white dark:bg-slate-800 border-l-4 border-red-500 border-t border-r border-b border-t-red-200 dark:border-t-red-800/50 border-r-red-200 dark:border-r-red-800/50 border-b-red-200 dark:border-b-red-800/50 cursor-pointer hover:shadow-md hover:shadow-red-100 dark:hover:shadow-red-900/20 w-72":`bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 cursor-grab active:cursor-grabbing ${C?"opacity-40 scale-95 shadow-none":"hover:shadow-md hover:border-fyness-primary/30"}`}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[x?e.jsx("span",{className:"inline-flex items-center justify-center px-1.5 py-0.5 rounded bg-red-600 text-white text-[9px] font-bold shrink-0 uppercase tracking-wider",children:"EMG"}):V?e.jsx("span",{className:"inline-flex items-center justify-center w-5 h-5 rounded-full bg-fyness-primary text-white text-[10px] font-bold shrink-0",children:V}):null,e.jsx("span",{className:`text-xs font-bold ${x?"text-red-500 dark:text-red-400":"text-slate-400 dark:text-slate-500"}`,children:x?`EMG-${String(l.emergencyNumber||0).padStart(3,"0")}`:`O.S. #${l.number}`})]}),e.jsxs("span",{className:`inline-flex items-center gap-1 text-[10px] font-medium px-1.5 py-0.5 rounded-full ${f}`,children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${K}`}),Je[l.status]]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[x&&e.jsx("svg",{className:"w-3.5 h-3.5 text-red-500 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("h4",{className:`text-sm font-semibold mb-0 ${x?"text-red-700 dark:text-red-300":"text-slate-800 dark:text-slate-100 group-hover:text-fyness-primary"} transition-colors`,children:l.title})]}),x&&he&&e.jsxs("p",{className:"text-[10px] text-red-400 dark:text-red-500 mb-1",children:["Vinculada a O.S. #",he.number," — ",he.title]}),l.client&&e.jsx("p",{className:"text-[11px] text-slate-400 dark:text-slate-500 mb-1",children:l.client}),e.jsxs("div",{className:"flex items-center gap-1.5 mb-1 flex-wrap",children:[l.category&&l.category!=="internal"&&e.jsx("span",{className:`text-[9px] font-medium px-1.5 py-0.5 rounded ${(Be.find(M=>M.id===l.category)||{}).color||"bg-slate-100 text-slate-500"}`,children:(Be.find(M=>M.id===l.category)||{}).label||l.category}),l.status==="blocked"&&l.blockReason&&e.jsx("span",{className:"text-[9px] font-medium px-1.5 py-0.5 rounded bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400",children:(Ot.find(M=>M.id===l.blockReason)||{}).label||l.blockReason})]}),(l.estimatedStart||l.estimatedEnd)&&e.jsxs("div",{className:"flex items-center gap-2 mb-1 text-[10px] text-slate-400 dark:text-slate-500",children:[l.estimatedStart&&e.jsxs("span",{title:"Inicio previsto",children:[e.jsx("svg",{className:"w-3 h-3 inline mr-0.5 -mt-px",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),yt(l.estimatedStart)]}),l.estimatedStart&&l.estimatedEnd&&e.jsx("span",{children:"→"}),l.estimatedEnd&&e.jsx("span",{title:"Entrega prevista",className:"font-medium text-slate-500 dark:text-slate-400",children:yt(l.estimatedEnd)})]}),(l.checklist||[]).length>0&&(()=>{const M=(l.checklist||[]).filter(F=>F.done).length,X=(l.checklist||[]).length,W=X>0?M/X*100:0;return e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"flex-1 h-1.5 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all ${W===100?"bg-emerald-500":"bg-blue-500"}`,style:{width:`${W}%`}})}),e.jsxs("span",{className:`text-[10px] font-medium ${W===100?"text-emerald-600 dark:text-emerald-400":"text-slate-400 dark:text-slate-500"}`,children:[M,"/",X]})]})})(),e.jsxs("div",{className:"flex items-center justify-between mt-2 pt-2 border-t border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[l.assignedTo&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-[9px] text-slate-400 dark:text-slate-500",children:"Para:"}),e.jsx("span",{className:"text-[11px] font-medium text-blue-600",children:Se(l.assignedTo)})]}),R?e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-5 h-5 rounded-full flex items-center justify-center text-white text-[9px] font-bold",style:{backgroundColor:R.color},children:R.name.charAt(0)}),e.jsx("span",{className:"text-xs text-slate-600 dark:text-slate-300",children:Se(R.name)})]}):l.assignedTo?null:e.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500 italic",children:"Sem responsavel"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[l.attachments&&l.attachments.length>0&&e.jsxs("span",{className:"flex items-center gap-0.5 text-[10px] text-slate-400 dark:text-slate-500",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),l.attachments.length]}),e.jsx("svg",{className:"w-4 h-4 text-slate-300 dark:text-slate-600 group-hover:text-fyness-primary transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})]})]})]}),Y==="after"&&e.jsx("div",{className:"h-1 bg-fyness-primary rounded-full mx-1 mt-1 animate-pulse"})]})});function Ms({order:t,currentUser:l,projectName:E,onBack:C,onEdit:Y,onClaim:A,onRelease:_,onMoveForward:v,onMoveBack:k,onDelete:V,isManager:J,canEditOS:xe,canDeleteOS:R,canViewCosts:x,profileName:he,profileCpf:f,teamMembers:K,allOrders:N=[],onViewOrder:M,onUpdateOrder:X}){const W=b.useRef(t.checklist||[]);W.current=t.checklist||[];const[F,y]=b.useState(new Set),w=d=>y(p=>{const T=new Set(p);return T.has(d)?T.delete(d):T.add(d),T}),Q=K.find(d=>d.id===t.assignee||Me(d.name,t.assignee))||(t.assignee?{id:t.assignee,name:t.assignee,color:"#3b82f6"}:null),re=He.find(d=>d.id===t.priority)||He[1],ge=Me(t.assignee,l)||Me(t.assignee,he),H=t.attachments||[],Z=t.type==="emergency",r=Z&&t.parentOrderId?N.find(d=>d.id===t.parentOrderId):null,L=N.filter(d=>d.type==="emergency"&&d.parentOrderId===t.id),le=()=>{window.print()};return e.jsxs("div",{className:"h-full flex flex-col print:block print:h-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 print:hidden",children:[e.jsxs("button",{onClick:C,className:"flex items-center gap-2 text-sm text-slate-600 dark:text-slate-300 hover:text-slate-800 dark:hover:text-slate-100 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Voltar ao Kanban"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.status==="available"&&e.jsx("button",{onClick:A,className:"px-3 py-1.5 bg-fyness-primary text-white text-sm rounded-lg hover:bg-fyness-secondary transition-colors font-medium",children:"Pegar O.S."}),t.status==="in_progress"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:v,className:"px-3 py-1.5 bg-green-500 text-white text-sm rounded-lg hover:bg-green-600 transition-colors font-medium",children:"Concluir"}),ge&&e.jsx("button",{onClick:_,className:"px-3 py-1.5 border border-orange-300 dark:border-orange-600/50 text-orange-600 dark:text-orange-400 text-sm rounded-lg hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors",children:"Devolver"})]}),t.status==="done"&&e.jsx("button",{onClick:k,className:"px-3 py-1.5 border border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-300 text-sm rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:"Reabrir"}),Y&&e.jsx("button",{onClick:Y,className:"px-3 py-1.5 border border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-300 text-sm rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:"Editar"}),e.jsxs("button",{onClick:le,className:"px-3 py-1.5 border border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-300 text-sm rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors flex items-center gap-1.5",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),"Imprimir"]}),V&&e.jsx("button",{onClick:V,className:"px-3 py-1.5 border border-red-200 dark:border-red-600/50 text-red-500 dark:text-red-400 text-sm rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:"Excluir"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto print:overflow-visible",children:e.jsxs("div",{className:"max-w-3xl mx-auto bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm print:shadow-none print:border-none print:max-w-none print:rounded-none",children:[e.jsx("div",{className:"border-b-2 border-slate-800 dark:border-slate-400 p-8 pb-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:Dt,alt:"Fyness",className:"w-12 h-12 object-contain"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:"FYNESS"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Gestao de Processos"})]})]}),e.jsxs("div",{className:"text-right",children:[Z?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600 dark:text-red-400 print:text-red-600 uppercase",children:"Emergencial"}),e.jsxs("p",{className:"text-3xl font-black text-red-600 dark:text-red-400 mt-1 print:text-red-600",children:["EMG-",String(t.emergencyNumber||0).padStart(3,"0")]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 print:text-slate-800",children:"ORDEM DE SERVICO"}),e.jsxs("p",{className:"text-3xl font-black text-fyness-primary mt-1 print:text-slate-800",children:["#",String(t.number).padStart(3,"0")]})]}),E&&e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["Projeto: ",E]})]})]})}),Z&&r&&e.jsxs("div",{className:"bg-red-50 dark:bg-red-950/30 border-b border-red-200 dark:border-red-800/50 px-6 py-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-red-500 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),e.jsx("span",{className:"text-sm text-red-600 dark:text-red-400",children:"Originada da"}),e.jsxs("button",{onClick:()=>M&&M(r),className:"text-sm font-bold text-red-700 dark:text-red-300 hover:underline",children:["O.S. #",r.number," — ",r.title]})]}),L.length>0&&e.jsxs("div",{className:"bg-red-50 dark:bg-red-950/30 border-b border-red-200 dark:border-red-800/50 px-6 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("svg",{className:"w-4 h-4 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsxs("span",{className:"text-sm font-semibold text-red-600 dark:text-red-400",children:[L.length," emergencia",L.length>1?"s":""," vinculada",L.length>1?"s":""]})]}),e.jsx("div",{className:"space-y-1",children:L.map(d=>e.jsxs("button",{onClick:()=>M&&M(d),className:"flex items-center gap-2 text-sm text-red-700 dark:text-red-300 hover:underline",children:[e.jsxs("span",{className:"font-bold",children:["EMG-",String(d.emergencyNumber||0).padStart(3,"0")]}),e.jsxs("span",{children:["— ",d.title]}),e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded-full ${d.status==="done"?"bg-green-100 dark:bg-green-900/30 text-green-600":"bg-red-100 dark:bg-red-900/30 text-red-600"}`,children:Je[d.status]})]},d.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-4 border-r border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("div",{className:"mt-1",children:e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-semibold ${t.status==="available"?"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300":t.status==="in_progress"?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400"}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${t.status==="available"?"bg-slate-400":t.status==="in_progress"?"bg-blue-500":"bg-green-500"}`}),Je[t.status]]})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Prioridade"}),e.jsx("div",{className:"mt-1",children:e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-semibold ${re.color}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${re.dot}`}),re.label]})})]})]}),(t.estimatedStart||t.estimatedEnd)&&e.jsxs("div",{className:"grid grid-cols-2 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-4 border-r border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-[10px] font-semibold text-blue-500 uppercase tracking-wider",children:"Previsao de Inicio"}),e.jsx("p",{className:"text-sm text-slate-800 dark:text-slate-100 mt-1 font-medium",children:t.estimatedStart?Ne(t.estimatedStart):"-"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("label",{className:"text-[10px] font-semibold text-blue-500 uppercase tracking-wider",children:"Previsao de Entrega"}),e.jsx("p",{className:"text-sm text-slate-800 dark:text-slate-100 mt-1 font-medium",children:t.estimatedEnd?Ne(t.estimatedEnd):"-"})]})]}),t.status==="blocked"&&t.blockReason&&e.jsxs("div",{className:"grid grid-cols-2 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-4 border-r border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-[10px] font-semibold text-orange-500 uppercase tracking-wider",children:"Motivo do Bloqueio"}),e.jsx("p",{className:"text-sm text-orange-600 dark:text-orange-400 mt-1 font-medium",children:(Ot.find(d=>d.id===t.blockReason)||{}).label||t.blockReason})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Categoria"}),e.jsx("div",{className:"mt-1",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-semibold ${(Be.find(d=>d.id===t.category)||Be[0]).color}`,children:(Be.find(d=>d.id===t.category)||Be[0]).label})})]})]}),(t.actualStart||t.actualEnd)&&e.jsxs("div",{className:"grid grid-cols-2 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-4 border-r border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-[10px] font-semibold text-green-500 uppercase tracking-wider",children:"Inicio Real"}),e.jsx("p",{className:"text-sm text-slate-800 dark:text-slate-100 mt-1 font-medium",children:Ne(t.actualStart)})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("label",{className:"text-[10px] font-semibold text-green-500 uppercase tracking-wider",children:"Fim Real"}),e.jsx("p",{className:"text-sm text-slate-800 dark:text-slate-100 mt-1 font-medium",children:Ne(t.actualEnd)||"-"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-4 border-r border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Cliente / Solicitante"}),e.jsx("p",{className:"text-sm text-slate-800 dark:text-slate-100 mt-1 font-medium",children:t.client||"-"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Local / Ambiente"}),e.jsx("p",{className:"text-sm text-slate-800 dark:text-slate-100 mt-1 font-medium",children:t.location||"-"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-4 border-r border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Atribuido a"}),t.assignedTo?e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center text-white text-xs font-bold bg-blue-500",children:t.assignedTo.charAt(0)}),e.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-100",children:t.assignedTo})]}):e.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500 mt-1 italic",children:"Ninguem"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Pego por"}),Q?e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center text-white text-xs font-bold",style:{backgroundColor:Q.color},children:Q.name.charAt(0)}),e.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-100",children:Se(Q.name)})]}):e.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500 mt-1 italic",children:"Ninguem"})]})]}),e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Titulo do Servico"}),e.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-100 mt-1",children:t.title})]}),t.description&&e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Descricao do Servico"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-200 mt-2 leading-relaxed whitespace-pre-wrap",children:t.description})]}),(t.checklist||[]).length>0&&(()=>{const d=t.checklist||[],p=d.filter(i=>i.done).length,T=i=>{if(i.startedAt&&i.completedAt){const h=(new Date(i.completedAt)-new Date(i.startedAt))/6e4;if(h>0&&h<1440)return Math.round(h)}return i.durationMin||0},ee=d.reduce((i,h)=>i+T(h),0),g=i=>{if(!i||i<=0)return"";if(i<60)return`${Math.round(i)}min`;const h=Math.floor(i/60),D=Math.round(i%60);return D>0?`${h}h ${D}min`:`${h}h`},P=i=>i?new Date(i).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}):"",pe=i=>{const h=W.current,D=h.find(oe=>(oe.group||"__ungrouped__")===i),q=h.filter(oe=>(oe.group||"__ungrouped__")===i),I=(D==null?void 0:D.groupOutput)||{text:"",links:[],files:[]},G=q.flatMap(oe=>{var me;return((me=oe.output)==null?void 0:me.links)||[]}),se=q.flatMap(oe=>{var me;return((me=oe.output)==null?void 0:me.files)||[]}),$=q.map(oe=>{var me;return((me=oe.output)==null?void 0:me.text)||""}).filter(Boolean).join(`
`);return{text:I.text||$,links:[...I.links||[],...G],files:[...I.files||[],...se]}},z=(i,h)=>{if(!X)return;const D=W.current;let q=!1;const I=D.map(G=>{if((G.group||"__ungrouped__")!==i)return G;const $={...G};return delete $.output,q?(delete $.groupOutput,$):(q=!0,{...$,groupOutput:h})});X(t.id,{checklist:I})},ne=(i,h)=>{const D=pe(i);z(i,{...D,...h})},Ee=(i,h,D)=>{if(!h.trim())return;const q=pe(i),I=h.trim().startsWith("http")?h.trim():`https://${h.trim()}`,G=[...q.links||[],{id:Date.now(),url:I,label:D.trim()||I}];z(i,{...q,links:G})},ze=(i,h)=>{const D=pe(i);z(i,{...D,links:(D.links||[]).filter(q=>q.id!==h)})},ve=(i,h)=>{if(!h)return;if(h.size>3*1024*1024){alert("Arquivo muito grande! Maximo: 3MB.");return}const D=new FileReader;D.onload=q=>{const I=pe(i),G=h.type.startsWith("image/"),se={id:Date.now(),type:G?"image":"document",data:q.target.result,label:h.name,mimeType:h.type};z(i,{...I,files:[...I.files||[],se]})},D.readAsDataURL(h)},fe=(i,h)=>{const D=pe(i);z(i,{...D,files:(D.files||[]).filter(q=>q.id!==h)})},Ge=i=>{if(!X)return;const h=W.current,D=new Date().toISOString(),q=h.findIndex(G=>G.id===i.id);if(q===-1)return;let I;if(i.done){let G=-1;for(let se=q+1;se<h.length;se++)if(!h[se].done){G=se;break}I=h.map((se,$)=>se.id===i.id?{...se,done:!1,completedAt:null,durationMin:null}:$===G?{...se,startedAt:null}:se)}else{const G=q>0?h[q-1]:null,se=i.startedAt||(G==null?void 0:G.completedAt)||t.actualStart||D,$=new Date(D)-new Date(se),oe=Math.max(0,Math.round($/6e4));let me=-1;for(let de=q+1;de<h.length;de++)if(!h[de].done){me=de;break}I=h.map((de,De)=>de.id===i.id?{...de,done:!0,startedAt:se,completedAt:D,durationMin:oe}:De===me?{...de,startedAt:D}:de)}X(t.id,{checklist:I})},Le=[],we=new Map;return d.forEach(i=>{const h=i.group||"__ungrouped__";we.has(h)||(we.set(h,[]),Le.push(h)),we.get(h).push(i)}),e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Bloco de Tarefas"}),e.jsxs("div",{className:"flex items-center gap-3",children:[ee>0&&e.jsxs("span",{className:"text-[10px] text-slate-400 dark:text-slate-500",children:["Total: ",g(ee)]}),e.jsxs("span",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:[p,"/",d.length]})]})]}),e.jsx("div",{className:"w-full h-1.5 bg-slate-100 dark:bg-slate-700 rounded-full mb-3 overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500 rounded-full transition-all duration-300",style:{width:`${p/d.length*100}%`}})}),e.jsx("div",{className:"space-y-2",children:Le.map(i=>{var me,de,De,Te,Ae;const h=we.get(i),D=i!=="__ungrouped__",q=h.filter(o=>o.done).length,I=q===h.length,G=h.reduce((o,ie)=>o+T(ie),0),se=F.has(i),$=pe(i),oe=((me=$.links)==null?void 0:me.length)>0||((de=$.files)==null?void 0:de.length)>0||$.text;return e.jsxs("div",{className:`rounded-xl overflow-hidden border transition-all ${I?"border-emerald-200 dark:border-emerald-800/50 bg-emerald-50/30 dark:bg-emerald-900/10":D?"border-slate-200 dark:border-slate-700/60 bg-slate-50/50 dark:bg-slate-800/30":"border-slate-100 dark:border-slate-700/40"}`,children:[e.jsxs("button",{onClick:()=>w(i),className:"w-full flex items-center gap-2.5 px-3 py-2.5 hover:bg-slate-100/50 dark:hover:bg-slate-700/30 transition-colors text-left",children:[e.jsx("svg",{className:`w-4 h-4 shrink-0 transition-transform duration-200 ${se?"":"rotate-90"} ${I?"text-emerald-500 dark:text-emerald-400":"text-indigo-500 dark:text-indigo-400"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),D?e.jsx("svg",{className:`w-4 h-4 shrink-0 ${I?"text-emerald-500 dark:text-emerald-400":"text-indigo-500 dark:text-indigo-400"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}):e.jsx("svg",{className:"w-4 h-4 text-slate-400 dark:text-slate-500 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("span",{className:`text-xs font-semibold flex-1 ${I?"text-emerald-700 dark:text-emerald-300":"text-indigo-700 dark:text-indigo-300"}`,children:D?i:"Tarefas"}),G>0&&e.jsx("span",{className:"text-[10px] text-slate-400 dark:text-slate-500",children:g(G)}),oe&&e.jsxs("span",{className:"flex items-center gap-0.5 text-[10px] text-violet-500 dark:text-violet-400",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),(((De=$.links)==null?void 0:De.length)||0)+(((Te=$.files)==null?void 0:Te.length)||0)]}),e.jsxs("span",{className:`text-[10px] font-medium px-1.5 py-0.5 rounded ${I?"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400":"bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400"}`,children:[q,"/",h.length]}),I&&e.jsx("svg",{className:"w-4 h-4 text-emerald-500 dark:text-emerald-400 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})})]}),!se&&e.jsxs("div",{className:"border-t border-slate-200/60 dark:border-slate-700/40",children:[e.jsx("div",{className:"px-2 py-1.5 space-y-1",children:h.map(o=>{var Oe;const ie=d.findIndex(Ve=>Ve.id===o.id),je=!o.done&&(ie===0||((Oe=d[ie-1])==null?void 0:Oe.done));return e.jsxs("button",{onClick:()=>Ge(o),disabled:!o.done&&!je,className:`w-full flex items-center gap-3 px-2.5 py-2 rounded-lg transition-colors text-left ${je?"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800":o.done?"hover:bg-slate-50 dark:hover:bg-slate-700/50":"opacity-50 cursor-not-allowed"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center shrink-0 transition-colors ${o.done?"bg-emerald-500 border-emerald-500":je?"border-blue-400 dark:border-blue-500 animate-pulse":"border-slate-300 dark:border-slate-600"}`,children:o.done&&e.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.jsxs("span",{className:"text-xs text-slate-400 dark:text-slate-500 font-mono w-5 shrink-0",children:[ie+1,"."]}),e.jsx("span",{className:`text-sm flex-1 ${o.done?"line-through text-slate-400 dark:text-slate-500":je?"text-blue-700 dark:text-blue-300 font-medium":"text-slate-700 dark:text-slate-200"}`,children:o.text}),o.done&&T(o)>0&&e.jsx("span",{className:"text-[10px] font-medium text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-900/20 px-1.5 py-0.5 rounded shrink-0",children:g(T(o))}),o.done&&o.completedAt&&e.jsx("span",{className:"text-[10px] text-slate-400 dark:text-slate-500 shrink-0",children:P(o.completedAt)}),je&&!o.done&&e.jsx("span",{className:"text-[10px] text-blue-500 dark:text-blue-400 font-medium shrink-0",children:"Em andamento"})]},o.id)})}),I&&e.jsxs("div",{className:"px-3 pb-3 pt-1 border-t border-emerald-200/50 dark:border-emerald-800/30",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[e.jsx("svg",{className:"w-3.5 h-3.5 text-violet-500 dark:text-violet-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),e.jsx("span",{className:"text-[10px] font-semibold text-violet-600 dark:text-violet-400 uppercase tracking-wider",children:"Entregaveis do Bloco"})]}),e.jsxs("div",{className:"space-y-2",children:[$.text&&e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-300 whitespace-pre-wrap leading-relaxed bg-violet-50/50 dark:bg-violet-900/10 rounded-lg px-3 py-2",children:$.text}),($.links||[]).length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5",children:$.links.map(o=>e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-violet-50 dark:bg-violet-900/20 rounded-lg group/link",children:[e.jsxs("svg",{className:"w-3 h-3 text-violet-500 dark:text-violet-400 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.172 13.828a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.102 1.101"})]}),e.jsx("a",{href:o.url,target:"_blank",rel:"noopener noreferrer",className:"text-[11px] text-violet-600 dark:text-violet-400 hover:underline font-medium max-w-[200px] truncate",children:o.label}),e.jsx("button",{onClick:()=>ze(i,o.id),className:"p-0.5 text-violet-300 dark:text-violet-600 hover:text-red-500 dark:hover:text-red-400 opacity-0 group-hover/link:opacity-100 transition-all",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},o.id))}),($.files||[]).length>0&&e.jsxs("div",{className:"space-y-1.5",children:[$.files.filter(o=>o.type==="image").length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:$.files.filter(o=>o.type==="image").map(o=>e.jsxs("div",{className:"relative group/file",children:[e.jsx("img",{src:o.data,alt:o.label,className:"w-full h-20 object-cover rounded-lg border border-violet-200 dark:border-violet-800/50"}),e.jsx("button",{onClick:()=>fe(i,o.id),className:"absolute top-1 right-1 p-0.5 bg-red-500 text-white rounded-full opacity-0 group-hover/file:opacity-100 transition-all shadow",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("p",{className:"text-[9px] text-slate-400 dark:text-slate-500 mt-0.5 truncate",children:o.label})]},o.id))}),$.files.filter(o=>o.type==="document").map(o=>e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 bg-violet-50 dark:bg-violet-900/20 rounded-lg group/file",children:[e.jsx("svg",{className:"w-3.5 h-3.5 text-violet-500 dark:text-violet-400 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsx("a",{href:o.data,download:o.label,className:"text-[11px] text-violet-600 dark:text-violet-400 hover:underline font-medium flex-1 truncate",children:o.label}),e.jsx("button",{onClick:()=>fe(i,o.id),className:"p-0.5 text-violet-300 dark:text-violet-600 hover:text-red-500 dark:hover:text-red-400 opacity-0 group-hover/file:opacity-100 transition-all",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},o.id))]}),e.jsxs("div",{className:"space-y-1.5 mt-1",children:[e.jsx("textarea",{placeholder:"Descreva o que foi entregue neste bloco...",rows:1,defaultValue:$.text||"",onBlur:o=>ne(i,{text:o.target.value}),className:"w-full px-2.5 py-1.5 text-xs border border-slate-200 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-1 focus:ring-violet-400 focus:border-transparent resize-none placeholder:text-slate-300 dark:placeholder:text-slate-600"},`grp_text_${i}_${((Ae=$.text)==null?void 0:Ae.length)||0}`),e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx("input",{type:"text",placeholder:"Link de entrega...",className:"flex-1 px-2.5 py-1.5 text-xs border border-slate-200 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-1 focus:ring-violet-400 focus:border-transparent placeholder:text-slate-300 dark:placeholder:text-slate-600",onKeyDown:o=>{o.key==="Enter"&&o.target.value.trim()&&(o.preventDefault(),Ee(i,o.target.value,""),o.target.value="")}}),e.jsx("button",{onClick:o=>{const ie=o.target.closest("div").querySelector('input[type="text"]');ie&&ie.value.trim()&&(Ee(i,ie.value,""),ie.value="")},className:"px-2 py-1.5 bg-violet-500 text-white rounded-lg hover:bg-violet-600 transition-colors text-xs font-medium shrink-0",title:"Adicionar link",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})})]}),e.jsxs("label",{className:"flex flex-col items-center justify-center gap-1 px-3 py-3 border-2 border-dashed border-violet-300 dark:border-violet-700 rounded-xl text-violet-400 dark:text-violet-500 hover:border-violet-400 hover:bg-violet-50/50 dark:hover:bg-violet-900/10 cursor-pointer transition-all data-[dragging=true]:border-violet-500 data-[dragging=true]:bg-violet-50 dark:data-[dragging=true]:bg-violet-900/20 data-[dragging=true]:scale-[1.02]",onDragOver:o=>{o.preventDefault(),o.stopPropagation(),o.currentTarget.dataset.dragging="true"},onDragLeave:o=>{o.preventDefault(),o.stopPropagation(),o.currentTarget.dataset.dragging="false"},onDrop:o=>{o.preventDefault(),o.stopPropagation(),o.currentTarget.dataset.dragging="false",Array.from(o.dataTransfer.files).forEach(ie=>ve(i,ie))},children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("span",{className:"text-[11px] font-medium",children:"Arraste arquivos ou clique aqui"}),e.jsx("span",{className:"text-[9px] text-violet-300 dark:text-violet-600",children:"Fotos e documentos (max 3MB)"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx,.csv,.txt,.ppt,.pptx,.zip,.rar",className:"hidden",onChange:o=>{Array.from(o.target.files||[]).forEach(ie=>ve(i,ie)),o.target.value=""}})]})]})]})]})]})]},i)})})]})})(),t.notes&&e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700 bg-amber-50/50 dark:bg-amber-900/10",children:[e.jsx("label",{className:"text-[10px] font-semibold text-amber-600 uppercase tracking-wider",children:"Observacoes"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-200 mt-2 leading-relaxed whitespace-pre-wrap",children:t.notes})]}),x&&t.status==="done"&&(()=>{const d=ot(t,K),p=t.expenses||[],T=ee=>{if(!ee||ee<=0)return"0min";if(ee<1)return`${Math.round(ee*60)}min`;const g=Math.floor(ee),P=Math.round((ee-g)*60);return P>0?`${g}h ${P}min`:`${g}h`};return e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700 bg-amber-50/30 dark:bg-amber-900/10",children:[e.jsx("label",{className:"text-[10px] font-semibold text-amber-600 uppercase tracking-wider",children:"Custo da Ordem de Servico"}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:"Mao de Obra"}),e.jsxs("p",{className:"text-[10px] text-slate-400 dark:text-slate-500",children:[d.hours>0?`${T(d.hours)} trabalhadas`:"Sem tempo registrado",d.hourlyRate>0&&` x ${ye(d.hourlyRate)}/h`]}),!d.memberFound&&t.assignee&&e.jsxs("p",{className:"text-[10px] text-red-400",children:['Membro "',t.assignee,'" nao encontrado na equipe']}),d.memberFound&&d.hourlyRate<=0&&e.jsx("p",{className:"text-[10px] text-red-400",children:"Salario nao configurado para este membro"})]}),e.jsx("span",{className:"text-sm font-bold text-slate-800 dark:text-slate-100",children:ye(d.laborCost)})]}),p.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-200 mb-1.5",children:"Materiais e Ferramentas"}),e.jsx("div",{className:"space-y-1",children:p.map((ee,g)=>e.jsxs("div",{className:"flex items-center justify-between text-xs bg-white dark:bg-slate-800 rounded px-3 py-1.5 border border-amber-100 dark:border-amber-800/30",children:[e.jsxs("span",{className:"text-slate-600 dark:text-slate-300",children:[ee.quantity>1&&e.jsxs("span",{className:"font-medium",children:[ee.quantity,"x "]}),ee.name]}),e.jsx("span",{className:"font-medium text-slate-800 dark:text-slate-100",children:ye((ee.value||0)*(ee.quantity||1))})]},g))}),e.jsx("div",{className:"flex justify-end mt-1",children:e.jsxs("span",{className:"text-xs text-amber-600 font-medium",children:["Subtotal materiais: ",ye(d.materialCost)]})})]}),e.jsxs("div",{className:"border-t border-amber-200 dark:border-amber-700/30 pt-2 flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-bold text-slate-800 dark:text-slate-100",children:"Custo Total"}),e.jsx("span",{className:"text-lg font-bold text-amber-600",children:ye(d.totalCost)})]})]})]})})(),e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Anexos"}),H.length===0?e.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500 italic mt-2",children:"Sem anexos."}):e.jsxs("div",{className:"mt-3 space-y-3",children:[H.filter(d=>d.type==="link").length>0&&e.jsx("div",{className:"space-y-1.5",children:H.filter(d=>d.type==="link").map(d=>e.jsxs("a",{href:d.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors group",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-500 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),e.jsx("span",{className:"text-sm text-blue-600 font-medium group-hover:underline truncate print:text-slate-800",children:d.label}),e.jsxs("span",{className:"hidden print:inline text-xs text-slate-500 ml-1 truncate",children:["(",d.url,")"]}),e.jsx("svg",{className:"w-3.5 h-3.5 text-blue-400 shrink-0 ml-auto print:hidden",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]},d.id))}),H.filter(d=>d.type==="image").length>0&&e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3 print:grid-cols-2 print:gap-4",children:H.filter(d=>d.type==="image").map(d=>e.jsxs("div",{className:"print:break-inside-avoid",children:[e.jsx("a",{href:d.data,target:"_blank",rel:"noopener noreferrer",children:e.jsx("img",{src:d.data,alt:d.label,className:"w-full h-32 object-cover rounded-lg border border-slate-200 dark:border-slate-700 hover:border-fyness-primary transition-colors cursor-pointer print:h-auto print:max-h-48 print:object-contain print:rounded-none"})}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400 mt-1 truncate",children:d.label})]},d.id))})]})]}),e.jsxs("div",{className:"p-8 pt-12 grid grid-cols-2 gap-16",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"border-b-2 border-slate-400 dark:border-slate-500 pb-1 mb-2 h-20 flex items-end justify-center",children:he&&e.jsx("span",{className:"text-white",style:{fontFamily:"'Milton One', cursive",fontSize:"1.75rem",lineHeight:"1.2"},children:he})}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-semibold uppercase tracking-wider mt-1",children:"Solicitante"})]}),he&&e.jsxs("p",{className:"text-[9px] text-slate-400 dark:text-slate-500 leading-relaxed mt-3 text-justify",children:["Documento assinado por ",e.jsx("strong",{className:"text-slate-500",children:he}),f&&e.jsxs(e.Fragment,{children:[", portador do CPF ",e.jsx("strong",{className:"text-slate-500",children:rt(f)})]}),". Assinou e esta de acordo com este documento as"," ",e.jsx("strong",{className:"text-slate-500",children:lt(t.createdAt)}),"."]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"border-b-2 border-slate-400 dark:border-slate-500 pb-1 mb-2 h-20 flex items-end justify-center",children:Q&&e.jsx("span",{className:"text-white",style:{fontFamily:"'Milton One', cursive",fontSize:"1.75rem",lineHeight:"1.2"},children:Q.name})}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-semibold uppercase tracking-wider mt-1",children:"Responsavel pela Execucao"})]}),Q&&t.actualStart&&e.jsxs("p",{className:"text-[9px] text-slate-400 dark:text-slate-500 leading-relaxed mt-3 text-justify",children:["Documento assinado por ",e.jsx("strong",{className:"text-slate-500",children:Q.name}),f&&e.jsxs(e.Fragment,{children:[", portador do CPF ",e.jsx("strong",{className:"text-slate-500",children:rt(f)})]}),". Assinou e esta de acordo com este documento as"," ",e.jsx("strong",{className:"text-slate-500",children:lt(t.actualStart)}),"."]})]})]}),e.jsx("div",{className:"bg-slate-50 dark:bg-slate-800/50 px-8 py-3 text-center border-t border-slate-200 dark:border-slate-700 rounded-b-xl",children:e.jsxs("p",{className:"text-[10px] text-slate-400 dark:text-slate-500",children:["Fyness - Gestao de Processos Empresariais | Documento gerado em ",Ne(new Date().toISOString())]})})]})})]})}function Ls({order:t,projectName:l,profileName:E,profileCpf:C,teamMembers:Y,allOrders:A=[],onConfirm:_,onEdit:v,onCancel:k}){const V=He.find(x=>x.id===t.priority)||He[1],J=t.attachments||[],xe=t.type==="emergency",R=xe&&t.parentOrderId?A.find(x=>x.id===t.parentOrderId):null;return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("button",{onClick:k,className:"flex items-center gap-2 text-sm text-slate-600 dark:text-slate-300 hover:text-slate-800 dark:hover:text-slate-100 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Cancelar"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 text-xs font-semibold rounded-full",children:[e.jsxs("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Pre-visualizacao"]}),e.jsx("button",{onClick:v,className:"px-3 py-1.5 border border-slate-300 dark:border-slate-600 text-slate-600 dark:text-slate-300 text-sm rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors font-medium",children:"Editar"}),e.jsxs("button",{onClick:_,className:`px-4 py-1.5 ${xe?"bg-red-600 hover:bg-red-700":"bg-green-500 hover:bg-green-600"} text-white text-sm rounded-lg transition-colors font-semibold shadow-sm flex items-center gap-2`,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),xe?"Confirmar Emergencial":"Confirmar Ordem"]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"max-w-3xl mx-auto bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm",children:[e.jsxs("div",{className:`${xe?"bg-gradient-to-r from-red-600 to-red-700":"bg-gradient-to-r from-amber-400 to-amber-500"} px-6 py-2 rounded-t-xl flex items-center gap-2`,children:[e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("span",{className:"text-white text-xs font-bold",children:xe?"EMERGENCIAL — Revise os dados antes de confirmar":"RASCUNHO — Revise os dados antes de confirmar"})]}),e.jsx("div",{className:"border-b-2 border-slate-800 dark:border-slate-400 p-8 pb-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:Dt,alt:"Fyness",className:"w-12 h-12 object-contain"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:"FYNESS"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Gestao de Processos"})]})]}),e.jsxs("div",{className:"text-right",children:[xe?e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600 dark:text-red-400 uppercase",children:"Emergencial"}),e.jsxs("p",{className:"text-3xl font-black text-red-600 dark:text-red-400 mt-1",children:["EMG-",String(t.emergencyNumber||0).padStart(3,"0")]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 print:text-slate-800",children:"ORDEM DE SERVICO"}),e.jsxs("p",{className:"text-3xl font-black text-fyness-primary mt-1",children:["#",String(t.number).padStart(3,"0")]})]}),l&&e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:["Projeto: ",l]})]})]})}),xe&&R&&e.jsxs("div",{className:"bg-red-50 dark:bg-red-950/30 border-b border-red-200 dark:border-red-800/50 px-6 py-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-red-500 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),e.jsx("span",{className:"text-sm text-red-600 dark:text-red-400",children:"Originada da"}),e.jsxs("span",{className:"text-sm font-bold text-red-700 dark:text-red-300",children:["O.S. #",R.number," — ",R.title]})]}),e.jsxs("div",{className:"grid grid-cols-2 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-4 border-r border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("div",{className:"mt-1",children:e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-semibold bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-slate-400"}),Je[t.status]]})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Prioridade"}),e.jsx("div",{className:"mt-1",children:e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-semibold ${V.color}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${V.dot}`}),V.label]})})]})]}),(t.estimatedStart||t.estimatedEnd)&&e.jsxs("div",{className:"grid grid-cols-2 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-4 border-r border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-[10px] font-semibold text-blue-500 uppercase tracking-wider",children:"Previsao de Inicio"}),e.jsx("p",{className:"text-sm text-slate-800 dark:text-slate-100 mt-1 font-medium",children:t.estimatedStart?Ne(t.estimatedStart):"-"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("label",{className:"text-[10px] font-semibold text-blue-500 uppercase tracking-wider",children:"Previsao de Entrega"}),e.jsx("p",{className:"text-sm text-slate-800 dark:text-slate-100 mt-1 font-medium",children:t.estimatedEnd?Ne(t.estimatedEnd):"-"})]})]}),(t.client||t.location)&&e.jsxs("div",{className:"grid grid-cols-2 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-4 border-r border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Cliente / Solicitante"}),e.jsx("p",{className:"text-sm text-slate-800 dark:text-slate-100 mt-1 font-medium",children:t.client||"-"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Local / Ambiente"}),e.jsx("p",{className:"text-sm text-slate-800 dark:text-slate-100 mt-1 font-medium",children:t.location||"-"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"p-4 border-r border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Atribuido a"}),t.assignedTo?e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center text-white text-xs font-bold bg-blue-500",children:t.assignedTo.charAt(0)}),e.jsx("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-100",children:t.assignedTo})]}):e.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500 mt-1 italic",children:"Ninguem"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Pego por"}),e.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500 mt-1 italic",children:"Aguardando confirmacao"})]})]}),e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Titulo do Servico"}),e.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-100 mt-1",children:t.title})]}),t.description&&e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Descricao do Servico"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-200 mt-2 leading-relaxed whitespace-pre-wrap",children:t.description})]}),(t.checklist||[]).length>0&&(()=>{const x=t.checklist||[],he=x.filter(y=>y.done).length,f=y=>{if(y.startedAt&&y.completedAt){const w=(new Date(y.completedAt)-new Date(y.startedAt))/6e4;if(w>0&&w<1440)return Math.round(w)}return y.durationMin||0},K=x.reduce((y,w)=>y+f(w),0),N=y=>{if(!y||y<=0)return"";if(y<60)return`${Math.round(y)}min`;const w=Math.floor(y/60),ae=Math.round(y%60);return ae>0?`${w}h ${ae}min`:`${w}h`},M=y=>y?new Date(y).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}):"",X=[],W=new Map;x.forEach(y=>{const w=y.group||"__ungrouped__";W.has(w)||(W.set(w,[]),X.push(w)),W.get(w).push(y)});const F=y=>{const w=x.filter(Z=>(Z.group||"__ungrouped__")===y),ae=w[0],Q=(ae==null?void 0:ae.groupOutput)||{text:"",links:[],files:[]},re=w.flatMap(Z=>{var r;return((r=Z.output)==null?void 0:r.links)||[]}),ge=w.flatMap(Z=>{var r;return((r=Z.output)==null?void 0:r.files)||[]}),H=w.map(Z=>{var r;return((r=Z.output)==null?void 0:r.text)||""}).filter(Boolean).join(`
`);return{text:Q.text||H,links:[...Q.links||[],...re],files:[...Q.files||[],...ge]}};return e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Bloco de Tarefas"}),e.jsxs("div",{className:"flex items-center gap-3",children:[K>0&&e.jsxs("span",{className:"text-[10px] text-slate-400 dark:text-slate-500",children:["Total: ",N(K)]}),e.jsxs("span",{className:"text-xs font-medium text-slate-500 dark:text-slate-400",children:[he,"/",x.length]})]})]}),e.jsx("div",{className:"w-full h-1.5 bg-slate-100 dark:bg-slate-700 rounded-full mb-3 overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500 rounded-full transition-all duration-300",style:{width:`${he/x.length*100}%`}})}),e.jsx("div",{className:"space-y-2",children:X.map(y=>{var r,L,le,d;const w=W.get(y),ae=y!=="__ungrouped__",Q=w.filter(p=>p.done).length,re=Q===w.length,ge=w.reduce((p,T)=>p+f(T),0),H=F(y),Z=((r=H.links)==null?void 0:r.length)>0||((L=H.files)==null?void 0:L.length)>0||H.text;return e.jsxs("div",{className:`rounded-xl overflow-hidden border ${re?"border-emerald-200 dark:border-emerald-800/50 bg-emerald-50/30 dark:bg-emerald-900/10":"border-slate-200 dark:border-slate-700/60 bg-slate-50/50 dark:bg-slate-800/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2.5",children:[ae?e.jsx("svg",{className:`w-4 h-4 shrink-0 ${re?"text-emerald-500":"text-indigo-500 dark:text-indigo-400"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}):e.jsx("svg",{className:"w-4 h-4 text-slate-400 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("span",{className:`text-xs font-semibold flex-1 ${re?"text-emerald-700 dark:text-emerald-300":"text-indigo-700 dark:text-indigo-300"}`,children:ae?y:"Tarefas"}),ge>0&&e.jsx("span",{className:"text-[10px] text-slate-400 dark:text-slate-500",children:N(ge)}),Z&&e.jsxs("span",{className:"flex items-center gap-0.5 text-[10px] text-violet-500 dark:text-violet-400",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),(((le=H.links)==null?void 0:le.length)||0)+(((d=H.files)==null?void 0:d.length)||0)]}),e.jsxs("span",{className:`text-[10px] font-medium px-1.5 py-0.5 rounded ${re?"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400":"bg-slate-100 dark:bg-slate-700 text-slate-500"}`,children:[Q,"/",w.length]}),re&&e.jsx("svg",{className:"w-4 h-4 text-emerald-500 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})})]}),e.jsx("div",{className:"border-t border-slate-200/60 dark:border-slate-700/40 px-2 py-1.5 space-y-1",children:w.map((p,T)=>{const ee=x.findIndex(g=>g.id===p.id);return e.jsxs("div",{className:"flex items-center gap-3 px-2.5 py-2",children:[e.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center shrink-0 ${p.done?"bg-emerald-500 border-emerald-500":"border-slate-300 dark:border-slate-600"}`,children:p.done&&e.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.jsxs("span",{className:"text-xs text-slate-400 font-mono w-5 shrink-0",children:[ee+1,"."]}),e.jsx("span",{className:`text-sm flex-1 ${p.done?"line-through text-slate-400":"text-slate-700 dark:text-slate-200"}`,children:p.text}),p.done&&f(p)>0&&e.jsx("span",{className:"text-[10px] font-medium text-emerald-600 bg-emerald-50 dark:bg-emerald-900/20 px-1.5 py-0.5 rounded shrink-0",children:N(f(p))}),p.done&&p.completedAt&&e.jsx("span",{className:"text-[10px] text-slate-400 shrink-0",children:M(p.completedAt)})]},p.id)})}),Z&&e.jsxs("div",{className:"px-3 pb-3 pt-1 border-t border-violet-200/30 dark:border-violet-800/20",children:[e.jsx("span",{className:"text-[10px] font-semibold text-violet-600 dark:text-violet-400 uppercase tracking-wider",children:"Entregaveis do Bloco"}),e.jsxs("div",{className:"mt-1.5 space-y-1.5",children:[H.text&&e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-300 whitespace-pre-wrap leading-relaxed",children:H.text}),(H.links||[]).length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5",children:H.links.map(p=>e.jsxs("a",{href:p.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 px-2 py-1 bg-violet-50 dark:bg-violet-900/20 rounded-lg text-[11px] text-violet-600 dark:text-violet-400 hover:underline font-medium",children:[e.jsxs("svg",{className:"w-3 h-3 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.172 13.828a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.102 1.101"})]}),e.jsx("span",{className:"max-w-[200px] truncate",children:p.label})]},p.id))}),(H.files||[]).length>0&&e.jsxs("div",{className:"space-y-1.5",children:[H.files.filter(p=>p.type==="image").length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:H.files.filter(p=>p.type==="image").map(p=>e.jsxs("div",{children:[e.jsx("img",{src:p.data,alt:p.label,className:"w-full h-20 object-cover rounded-lg border border-violet-200 dark:border-violet-800/50"}),e.jsx("p",{className:"text-[9px] text-slate-400 mt-0.5 truncate",children:p.label})]},p.id))}),H.files.filter(p=>p.type==="document").map(p=>e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 bg-violet-50 dark:bg-violet-900/20 rounded-lg",children:[e.jsx("svg",{className:"w-3.5 h-3.5 text-violet-500 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsx("a",{href:p.data,download:p.label,className:"text-[11px] text-violet-600 dark:text-violet-400 hover:underline font-medium flex-1 truncate",children:p.label})]},p.id))]})]})]})]},y)})})]})})(),t.notes&&e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700 bg-amber-50/50 dark:bg-amber-900/10",children:[e.jsx("label",{className:"text-[10px] font-semibold text-amber-600 uppercase tracking-wider",children:"Observacoes"}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-200 mt-2 leading-relaxed whitespace-pre-wrap",children:t.notes})]}),e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"text-[10px] font-semibold text-slate-400 dark:text-slate-500 uppercase tracking-wider",children:"Anexos"}),J.length===0?e.jsx("p",{className:"text-sm text-slate-400 dark:text-slate-500 italic mt-2",children:"Sem anexos."}):e.jsxs("div",{className:"mt-3 space-y-3",children:[J.filter(x=>x.type==="link").length>0&&e.jsx("div",{className:"space-y-1.5",children:J.filter(x=>x.type==="link").map(x=>e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-500 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),e.jsx("span",{className:"text-sm text-blue-600 font-medium truncate",children:x.label})]},x.id))}),J.filter(x=>x.type==="image").length>0&&e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:J.filter(x=>x.type==="image").map(x=>e.jsxs("div",{children:[e.jsx("img",{src:x.data,alt:x.label,className:"w-full h-32 object-cover rounded-lg border border-slate-200 dark:border-slate-700"}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400 mt-1 truncate",children:x.label})]},x.id))})]})]}),e.jsxs("div",{className:"p-8 pt-12 grid grid-cols-2 gap-16",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"border-b-2 border-slate-400 dark:border-slate-500 pb-1 mb-2 h-20 flex items-end justify-center",children:E&&e.jsx("span",{className:"text-white",style:{fontFamily:"'Milton One', cursive",fontSize:"1.75rem",lineHeight:"1.2"},children:E})}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-semibold uppercase tracking-wider mt-1",children:"Solicitante"})]}),E&&e.jsxs("p",{className:"text-[9px] text-slate-400 dark:text-slate-500 leading-relaxed mt-3 text-justify",children:["Documento assinado por ",e.jsx("strong",{className:"text-slate-500",children:E}),C&&e.jsxs(e.Fragment,{children:[", portador do CPF ",e.jsx("strong",{className:"text-slate-500",children:rt(C)})]}),". Assinou e esta de acordo com este documento as"," ",e.jsx("strong",{className:"text-slate-500",children:lt(t.createdAt)}),"."]})]}),e.jsx("div",{children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"border-b-2 border-dashed border-slate-300 dark:border-slate-600 pb-1 mb-2 h-20 flex items-end justify-center",children:e.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500 italic",children:"Aguardando execucao"})}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-semibold uppercase tracking-wider mt-1",children:"Responsavel pela Execucao"})]})})]}),e.jsx("div",{className:"bg-slate-50 dark:bg-slate-800/50 px-8 py-3 text-center border-t border-slate-200 dark:border-slate-700 rounded-b-xl",children:e.jsxs("p",{className:"text-[10px] text-slate-400 dark:text-slate-500",children:["Fyness - Gestao de Processos Empresariais | Rascunho gerado em ",Ne(new Date().toISOString())]})})]})}),e.jsxs("div",{className:"mt-4 flex items-center justify-center gap-3",children:[e.jsx("button",{onClick:k,className:"px-5 py-2.5 border border-slate-300 text-slate-600 rounded-lg hover:bg-slate-50 transition-colors text-sm font-medium",children:"Cancelar"}),e.jsx("button",{onClick:v,className:"px-5 py-2.5 border border-slate-300 text-slate-600 rounded-lg hover:bg-slate-50 transition-colors text-sm font-medium",children:"Editar Dados"}),e.jsxs("button",{onClick:_,className:`px-6 py-2.5 ${xe?"bg-red-600 hover:bg-red-700":"bg-green-500 hover:bg-green-600"} text-white rounded-lg transition-colors text-sm font-bold shadow-md flex items-center gap-2`,children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),xe?"Confirmar Emergencial":"Confirmar Ordem"]})]})]})}function Mt({form:t,setForm:l,editing:E,number:C,projects:Y,onSave:A,onClose:_,onDelete:v,teamMembers:k,isEmergency:V=!1,emergencyNumber:J=1,allOrders:xe=[],clients:R=[]}){const x=(r,L)=>l(le=>({...le,[r]:L})),he=xe.filter(r=>r.type!=="emergency"&&(r.status==="in_progress"||r.status==="available")),[f,K]=b.useState(""),[N,M]=b.useState(""),[X,W]=b.useState(""),[F,y]=b.useState(!1),w=b.useRef(null),ae=r=>{const L=r.split(`
`).map(T=>T.trim()).filter(Boolean);if(L.length===0)return[];const le=L.some(T=>T.startsWith("-")||T.startsWith("*"));let d=null;const p=[];return L.forEach((T,ee)=>{if(le&&!T.startsWith("-")&&!T.startsWith("*"))d=T;else{const g=T.replace(/^[-*]\s*/,"");g&&p.push({id:Date.now()+ee,text:g,group:d||null,done:!1,startedAt:null,completedAt:null,durationMin:null})}}),p},Q=()=>{let r=[...t.checklist||[]];if(w.current&&w.current.value.trim()){const le=ae(w.current.value);le.length>0&&(r=[...r,...le],w.current.value="")}const L={...t,checklist:r};l(L),A(L)},re=t.attachments||[],ge=()=>{if(!f.trim())return;const r=f.trim().startsWith("http")?f.trim():`https://${f.trim()}`,L={id:`att_${Date.now()}`,type:"link",url:r,label:N.trim()||r,createdAt:new Date().toISOString()};x("attachments",[...re,L]),K(""),M("")},H=r=>{var d;const L=(d=r.target.files)==null?void 0:d[0];if(!L)return;if(L.size>2*1024*1024){alert("Imagem muito grande! Maximo: 2MB.");return}const le=new FileReader;le.onload=p=>{const T={id:`att_${Date.now()}`,type:"image",data:p.target.result,label:L.name,createdAt:new Date().toISOString()};x("attachments",[...re,T])},le.readAsDataURL(L),r.target.value=""},Z=r=>{x("attachments",re.filter(L=>L.id!==r))};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-xl max-w-lg w-full mx-4 overflow-hidden max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:`p-6 border-b ${V?"border-red-200 dark:border-red-800/50 bg-red-50 dark:bg-red-950/20":"border-slate-200 dark:border-slate-700"} flex items-center justify-between shrink-0`,children:[e.jsx("h3",{className:`text-lg font-semibold ${V?"text-red-700 dark:text-red-300":"text-slate-800 dark:text-slate-100"}`,children:V?`Nova Emergencial EMG-${String(J).padStart(3,"0")}`:E?`Editar O.S. #${C}`:`Nova O.S. #${C}`}),e.jsx("button",{onClick:_,className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400 dark:text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:"Titulo do Servico *"}),e.jsx("input",{type:"text",value:t.title,onChange:r=>x("title",r.target.value),className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent text-sm",placeholder:"Ex: Manutencao do servidor principal",autoFocus:!0,onKeyDown:r=>{r.key==="Escape"&&_()}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:"Projeto"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:t.projectId||"",onChange:r=>x("projectId",r.target.value||null),className:"w-full appearance-none px-4 py-2.5 pr-8 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"Sem projeto"}),Y.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),e.jsx("svg",{className:"w-4 h-4 text-slate-400 dark:text-slate-500 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),V&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-red-600 dark:text-red-400 mb-1",children:"Vincular a O.S. (origem da emergencia)"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:t.parentOrderId||"",onChange:r=>x("parentOrderId",r.target.value||null),className:"w-full appearance-none px-4 py-2.5 pr-8 border border-red-300 dark:border-red-700/50 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"Sem vinculo (emergencia avulsa)"}),he.map(r=>e.jsxs("option",{value:r.id,children:["O.S. #",r.number," — ",r.title]},r.id))]}),e.jsx("svg",{className:"w-4 h-4 text-red-400 dark:text-red-500 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:"Local / Ambiente"}),e.jsx("input",{type:"text",value:t.location,onChange:r=>x("location",r.target.value),className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent text-sm",placeholder:"Ex: Servidor AWS, Producao, etc."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:"Atribuir a"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:t.assignedTo||"",onChange:r=>x("assignedTo",r.target.value||null),className:"w-full appearance-none px-4 py-2.5 pr-8 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"Ninguem (disponivel para todos)"}),k.map(r=>e.jsx("option",{value:r.name,children:Se(r.name)},r.id))]}),e.jsx("svg",{className:"w-4 h-4 text-slate-400 dark:text-slate-500 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:"Prioridade"}),V?e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-red-100 dark:bg-red-900/30 rounded-lg border border-red-200 dark:border-red-700/50",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500"}),e.jsx("span",{className:"text-sm font-medium text-red-700 dark:text-red-400",children:"Urgente (fixa para emergenciais)"})]}):e.jsx("div",{className:"flex gap-2",children:He.map(r=>e.jsxs("button",{onClick:()=>x("priority",r.id),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg border text-sm transition-all ${t.priority===r.id?`${r.color} border-transparent font-medium`:"border-slate-200 dark:border-slate-600 text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-700/50"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${r.dot}`}),r.label]},r.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:"Categoria"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Be.map(r=>e.jsx("button",{onClick:()=>x("category",r.id),className:`px-3 py-1.5 rounded-lg border text-sm transition-all ${t.category===r.id?`${r.color} border-transparent font-medium`:"border-slate-200 dark:border-slate-600 text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-700/50"}`,children:r.label},r.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:"Cliente"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:t.clientId||"",onChange:r=>{const L=R.find(le=>le.id===r.target.value);x("clientId",r.target.value||""),L&&x("client",L.name)},className:"w-full appearance-none px-4 py-2.5 pr-8 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"Sem cliente vinculado"}),R.map(r=>e.jsxs("option",{value:r.id,children:[r.name,r.company?` (${r.company})`:""]},r.id))]}),e.jsx("svg",{className:"w-4 h-4 text-slate-400 dark:text-slate-500 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),!t.clientId&&e.jsx("input",{type:"text",value:t.client,onChange:r=>x("client",r.target.value),className:"w-full mt-2 px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent text-sm",placeholder:"Ou digite o nome do cliente..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:"Previsao de Inicio"}),e.jsx("input",{type:"datetime-local",value:t.estimatedStart,onChange:r=>x("estimatedStart",r.target.value),className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:"Previsao de Entrega"}),e.jsx("input",{type:"datetime-local",value:t.estimatedEnd,onChange:r=>x("estimatedEnd",r.target.value),className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:"Descricao do Servico"}),e.jsx("textarea",{value:t.description,onChange:r=>x("description",r.target.value),rows:3,className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent text-sm resize-none",placeholder:"Descreva o servico a ser executado..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-2",children:"Bloco de Tarefas"}),(()=>{const r=t.checklist||[],L=new Map;r.forEach(g=>{const P=g.group||"__sem_grupo__";L.has(P)||L.set(P,[]),L.get(P).push(g)});const le=[...L.keys()],d=(g,P)=>{if(!P.trim())return;const pe={id:Date.now()+Math.random(),text:P.trim(),group:g==="__sem_grupo__"?null:g,done:!1,startedAt:null,completedAt:null,durationMin:null};x("checklist",[...r,pe])},p=g=>{x("checklist",r.filter(P=>P.id!==g))},T=g=>{x("checklist",r.filter(P=>(P.group||"__sem_grupo__")!==g))},ee=(g,P)=>{!P.trim()||P.trim()===g||x("checklist",r.map(pe=>(pe.group||"__sem_grupo__")===g?{...pe,group:P.trim()}:pe))};return e.jsxs("div",{className:"space-y-3",children:[le.map(g=>{const P=L.get(g),pe=g==="__sem_grupo__";return e.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-700 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2.5 bg-slate-50 dark:bg-slate-800/80 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("svg",{className:"w-4 h-4 text-fyness-primary shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),pe?e.jsx("span",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400",children:"Tarefas gerais"}):e.jsx("input",{type:"text",defaultValue:g,onBlur:z=>ee(g,z.target.value),onKeyDown:z=>{z.key==="Enter"&&z.target.blur()},className:"text-xs font-semibold text-fyness-primary dark:text-blue-400 bg-transparent border-none outline-none focus:ring-0 p-0 flex-1 min-w-0"}),e.jsxs("span",{className:"text-[10px] text-slate-400 dark:text-slate-500 ml-auto mr-1",children:[P.length," ",P.length===1?"tarefa":"tarefas"]}),e.jsx("button",{type:"button",onClick:()=>T(g),className:"p-1 text-slate-300 dark:text-slate-600 hover:text-red-500 dark:hover:text-red-400 transition-colors",title:"Remover grupo",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsx("div",{className:"divide-y divide-slate-100 dark:divide-slate-700/50",children:P.map((z,ne)=>e.jsxs("div",{className:"flex items-center gap-2.5 px-4 py-2 group hover:bg-slate-50 dark:hover:bg-slate-800/30 transition-colors",children:[e.jsx("span",{className:"w-5 h-5 rounded-md bg-fyness-primary/10 dark:bg-fyness-primary/20 text-fyness-primary text-[10px] font-bold flex items-center justify-center shrink-0",children:ne+1}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-200 flex-1",children:z.text}),e.jsx("button",{type:"button",onClick:()=>p(z.id),className:"p-0.5 text-slate-300 dark:text-slate-600 hover:text-red-500 dark:hover:text-red-400 opacity-0 group-hover:opacity-100 transition-all",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},z.id))}),e.jsx("div",{className:"px-3 py-2 bg-slate-50/50 dark:bg-slate-800/40 border-t border-slate-100 dark:border-slate-700/50",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",placeholder:"Adicionar tarefa...",className:"flex-1 px-3 py-1.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent",onKeyDown:z=>{z.key==="Enter"&&z.target.value.trim()&&(d(g,z.target.value),z.target.value="")}}),e.jsx("button",{type:"button",onClick:z=>{const ne=z.currentTarget.previousElementSibling;ne.value.trim()&&(d(g,ne.value),ne.value="",ne.focus())},className:"p-1.5 bg-fyness-primary text-white rounded-lg hover:bg-fyness-primary/90 transition-colors",title:"Adicionar tarefa",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})})]},g)}),F&&e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-xl border-2 border-fyness-primary/30 dark:border-blue-500/30 bg-fyness-primary/5 dark:bg-blue-900/10",children:[e.jsx("svg",{className:"w-4 h-4 text-fyness-primary dark:text-blue-400 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),e.jsx("input",{type:"text",autoFocus:!0,value:X,onChange:g=>W(g.target.value),placeholder:"Nome do grupo...",className:"flex-1 px-3 py-1.5 border border-slate-200 dark:border-slate-600 rounded-lg text-sm bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent",onKeyDown:g=>{g.key==="Enter"&&X.trim()&&(d(X.trim(),"Nova tarefa"),W(""),y(!1)),g.key==="Escape"&&(W(""),y(!1))}}),e.jsx("button",{type:"button",onClick:()=>{X.trim()&&d(X.trim(),"Nova tarefa"),W(""),y(!1)},className:"px-3 py-1.5 bg-fyness-primary text-white rounded-lg hover:bg-fyness-primary/90 transition-colors text-xs font-medium",children:"Criar"}),e.jsx("button",{type:"button",onClick:()=>{W(""),y(!1)},className:"p-1.5 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!le.includes("__sem_grupo__")&&e.jsxs("button",{type:"button",onClick:()=>{x("checklist",[...r,{id:Date.now()+Math.random(),text:"Nova tarefa",group:null,done:!1,startedAt:null,completedAt:null,durationMin:null}])},className:"flex items-center gap-1.5 px-3 py-2 border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl text-xs font-medium text-slate-500 dark:text-slate-400 hover:border-fyness-primary hover:text-fyness-primary dark:hover:border-blue-400 dark:hover:text-blue-400 transition-colors",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Tarefa"]}),!F&&e.jsxs("button",{type:"button",onClick:()=>y(!0),className:"flex items-center gap-1.5 px-3 py-2 border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-xl text-xs font-medium text-slate-500 dark:text-slate-400 hover:border-fyness-primary hover:text-fyness-primary dark:hover:border-blue-400 dark:hover:text-blue-400 transition-colors",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),"Novo Grupo"]}),r.length>0&&e.jsxs("button",{type:"button",onClick:()=>{confirm(`Remover todas as ${r.length} tarefas?`)&&x("checklist",[])},className:"flex items-center gap-1 px-3 py-2 text-[11px] text-red-400 hover:text-red-500 dark:text-red-500 dark:hover:text-red-400 font-medium transition-colors ml-auto",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Limpar tudo"]})]}),e.jsxs("details",{className:"group",children:[e.jsxs("summary",{className:"flex items-center gap-1.5 text-[11px] text-slate-400 dark:text-slate-500 cursor-pointer hover:text-slate-600 dark:hover:text-slate-300 transition-colors select-none",children:[e.jsx("svg",{className:"w-3 h-3 transition-transform group-open:rotate-90",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),"Colar varias tarefas de uma vez"]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("textarea",{ref:w,placeholder:`Preparacao
- Separar materiais
- Verificar estoque

Execucao
- Instalar equipamento
- Testar funcionamento`,rows:5,className:"w-full px-4 py-3 border border-slate-300 dark:border-slate-600 rounded-xl bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent text-sm resize-none leading-relaxed font-mono",onKeyDown:g=>{if(g.key==="Enter"&&(g.ctrlKey||g.metaKey)){g.preventDefault();const P=ae(g.target.value);P.length>0&&x("checklist",[...r,...P]),g.target.value=""}}}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("p",{className:"text-[11px] text-slate-400 dark:text-slate-500",children:["Linha sem ",e.jsx("code",{className:"bg-slate-100 dark:bg-slate-700 px-1 rounded",children:"-"})," = nome do grupo · com ",e.jsx("code",{className:"bg-slate-100 dark:bg-slate-700 px-1 rounded",children:"-"})," = tarefa"]}),e.jsxs("button",{type:"button",onClick:()=>{if(!w.current)return;const g=ae(w.current.value);g.length>0&&x("checklist",[...r,...g]),w.current.value="",w.current.focus()},className:"flex items-center gap-1.5 px-3 py-1.5 bg-fyness-primary text-white rounded-lg hover:bg-fyness-primary/90 transition-colors text-xs font-medium",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Adicionar"]})]})]})]})]})})()]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:"Observacoes"}),e.jsx("textarea",{value:t.notes,onChange:r=>x("notes",r.target.value),rows:2,className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent text-sm resize-none",placeholder:"Observacoes adicionais..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-2",children:"Anexos"}),re.length>0&&e.jsx("div",{className:"space-y-2 mb-3",children:re.map(r=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-200 dark:border-slate-700 group",children:[r.type==="link"?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 text-blue-500 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 truncate",children:r.label}),e.jsx("p",{className:"text-[10px] text-slate-400 dark:text-slate-500 truncate",children:r.url})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:r.data,alt:r.label,className:"w-10 h-10 rounded object-cover shrink-0 border border-slate-200 dark:border-slate-700"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-slate-200 truncate",children:r.label}),e.jsx("p",{className:"text-[10px] text-slate-400 dark:text-slate-500",children:"Imagem"})]})]}),e.jsx("button",{onClick:()=>Z(r.id),className:"p-1 text-slate-400 dark:text-slate-500 hover:text-red-500 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors opacity-0 group-hover:opacity-100",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},r.id))}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:N,onChange:r=>M(r.target.value),placeholder:"Nome do link",className:"flex-1 px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 text-sm focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent"}),e.jsx("input",{type:"text",value:f,onChange:r=>K(r.target.value),onKeyDown:r=>{r.key==="Enter"&&(r.preventDefault(),ge())},placeholder:"https://...",className:"flex-1 px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 text-sm focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent"}),e.jsx("button",{onClick:ge,disabled:!f.trim(),className:"px-3 py-2 bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors text-sm font-medium disabled:opacity-40 disabled:cursor-not-allowed shrink-0",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})})]}),e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 border border-dashed border-slate-300 dark:border-slate-600 rounded-lg text-sm text-slate-500 dark:text-slate-400 hover:border-fyness-primary hover:text-fyness-primary cursor-pointer transition-colors",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Adicionar imagem (PNG, JPG ate 2MB)",e.jsx("input",{type:"file",accept:"image/*",onChange:H,className:"hidden"})]})]})]}),e.jsxs("div",{className:"p-6 bg-slate-50 dark:bg-slate-900 flex items-center justify-between shrink-0",children:[e.jsx("div",{children:v&&e.jsx("button",{onClick:v,className:"px-3 py-2 text-red-500 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors text-sm font-medium",children:"Excluir"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:_,className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors text-sm",children:"Cancelar"}),e.jsx("button",{onClick:Q,disabled:!t.title.trim(),className:`px-4 py-2 ${V?"bg-red-600 hover:bg-red-700":"bg-fyness-primary hover:bg-fyness-secondary"} text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed`,children:V?"Gerar Emergencial":E?"Salvar":"Gerar O.S."})]})]})]})})}function Lt({form:t,setForm:l,editing:E,sectors:C,onSave:Y,onClose:A,onDelete:_}){const v=(k,V)=>l(J=>({...J,[k]:V}));return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-xl max-w-md w-full mx-4 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-100",children:E?"Editar Projeto":"Novo Projeto"}),e.jsx("button",{onClick:A,className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400 dark:text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:"Nome do Projeto *"}),e.jsx("input",{type:"text",value:t.name,onChange:k=>v("name",k.target.value),className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent text-sm",placeholder:"Ex: Landing Page Institucional",autoFocus:!0,onKeyDown:k=>{k.key==="Escape"&&A()}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:"Setor"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:t.sector,onChange:k=>v("sector",k.target.value),className:"w-full appearance-none px-4 py-2.5 pr-8 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent text-sm",children:[e.jsx("option",{value:"",children:"Sem setor"}),C.map(k=>e.jsx("option",{value:k.id,children:k.label},k.id))]}),e.jsx("svg",{className:"w-4 h-4 text-slate-400 dark:text-slate-500 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-2",children:"Cor"}),e.jsx("div",{className:"flex gap-2",children:ys.map(k=>e.jsx("button",{onClick:()=>v("color",k),className:`w-8 h-8 rounded-lg transition-all ${t.color===k?"ring-2 ring-offset-2 ring-slate-400 scale-110":"hover:scale-105"}`,style:{backgroundColor:k}},k))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:"Descricao"}),e.jsx("textarea",{value:t.description,onChange:k=>v("description",k.target.value),rows:3,className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent text-sm resize-none",placeholder:"Descricao breve do projeto..."})]})]}),e.jsxs("div",{className:"p-6 bg-slate-50 dark:bg-slate-900 flex items-center justify-between",children:[e.jsx("div",{children:_&&e.jsx("button",{onClick:_,className:"px-3 py-2 text-red-500 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors text-sm font-medium",children:"Excluir"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:A,className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors text-sm",children:"Cancelar"}),e.jsx("button",{onClick:Y,disabled:!t.name.trim(),className:"px-4 py-2 bg-fyness-primary text-white rounded-lg hover:bg-fyness-secondary transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:E?"Salvar":"Criar Projeto"})]})]})]})})}function Ds({form:t,setForm:l,editing:E,onSave:C,onClose:Y,onDelete:A}){const _=(v,k)=>l(V=>({...V,[v]:k}));return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-xl max-w-sm w-full mx-4 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-100",children:E?"Editar Setor":"Novo Setor"}),e.jsx("button",{onClick:Y,className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-5 h-5 text-slate-400 dark:text-slate-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:"Nome do Setor *"}),e.jsx("input",{type:"text",value:t.label,onChange:v=>_("label",v.target.value),className:"w-full px-4 py-2.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 dark:text-slate-200 focus:outline-none focus:ring-2 focus:ring-fyness-primary focus:border-transparent text-sm",placeholder:"Ex: Juridico",autoFocus:!0,onKeyDown:v=>{v.key==="Escape"&&Y(),v.key==="Enter"&&t.label.trim()&&C()}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-2",children:"Cor"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Ns.map(v=>e.jsx("button",{onClick:()=>_("color",v),className:`w-8 h-8 rounded-full transition-all ${t.color===v?"ring-2 ring-offset-2 ring-slate-400 scale-110":"hover:scale-105"}`,style:{backgroundColor:v}},v))})]}),t.label.trim()&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200 mb-1",children:"Preview"}),e.jsx("span",{className:"inline-block text-xs font-semibold px-3 py-1 rounded-full text-white",style:{backgroundColor:t.color},children:t.label.trim()})]})]}),e.jsxs("div",{className:"p-6 bg-slate-50 dark:bg-slate-900 flex items-center justify-between",children:[e.jsx("div",{children:A&&e.jsx("button",{onClick:A,className:"px-3 py-2 text-red-500 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors text-sm font-medium",children:"Excluir"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:Y,className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors text-sm",children:"Cancelar"}),e.jsx("button",{onClick:C,disabled:!t.label.trim(),className:"px-4 py-2 bg-fyness-primary text-white rounded-lg hover:bg-fyness-secondary transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:E?"Salvar":"Criar Setor"})]})]})]})})}function Fe({title:t,message:l,onCancel:E,onConfirm:C}){return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-xl max-w-sm w-full mx-4 overflow-hidden",children:[e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-800 dark:text-slate-100 text-center mb-2",children:t}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 text-center",children:l})]}),e.jsxs("div",{className:"p-6 bg-slate-50 dark:bg-slate-900 flex gap-3 justify-center",children:[e.jsx("button",{onClick:E,className:"px-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-700 dark:text-slate-200 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:C,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"Excluir"})]})]})})}export{As as default};
